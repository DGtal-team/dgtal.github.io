<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DGtal: testRealFFT.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DGtal<span id="projectnumber">&#160;2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('testRealFFT_8cpp.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">testRealFFT.cpp File Reference<div class="ingroups"><a class="el" href="group__Tests.html">DGtal Test Files</a></div></div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;cstddef&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;complex&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
<code>#include &lt;boost/math/constants/constants.hpp&gt;</code><br />
<code>#include &quot;DGtalCatch.h&quot;</code><br />
<code>#include &quot;ConfigTest.h&quot;</code><br />
<code>#include &quot;DGtal/math/RealFFT.h&quot;</code><br />
<code>#include &quot;DGtal/images/ImageContainerBySTLVector.h&quot;</code><br />
<code>#include &quot;DGtal/io/readers/PGMReader.h&quot;</code><br />
<code>#include &quot;DGtal/io/writers/PGMWriter.h&quot;</code><br />
<code>#include &quot;DGtal/base/BasicFunctors.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for testRealFFT.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" loading="lazy" frameborder="0" src="testRealFFT_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="testRealFFT_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a122ab038d9e5639ca2433cfc230a8d09" id="r_a122ab038d9e5639ca2433cfc230a8d09"><td class="memTemplParams" colspan="2">template&lt;typename TDomain, typename TValue&gt; </td></tr>
<tr class="memitem:a122ab038d9e5639ca2433cfc230a8d09 template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a122ab038d9e5639ca2433cfc230a8d09">testForwardBackwardFFT</a> (<a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector</a>&lt; TDomain, TValue &gt; const &amp;anImage)</td></tr>
<tr class="memitem:a4106a34e7d57e8a11093bdfdbc82516c" id="r_a4106a34e7d57e8a11093bdfdbc82516c"><td class="memTemplParams" colspan="2">template&lt;typename TIterator&gt; </td></tr>
<tr class="memitem:a4106a34e7d57e8a11093bdfdbc82516c template"><td class="memItemLeft" align="right" valign="top">TIterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4106a34e7d57e8a11093bdfdbc82516c">findMaxNorm</a> (TIterator it, TIterator const &amp;it_end)</td></tr>
<tr class="memitem:af8c38cd9872296ee76f4a9ac8fb83fff" id="r_af8c38cd9872296ee76f4a9ac8fb83fff"><td class="memTemplParams" colspan="2">template&lt;typename TDomain, typename TValue&gt; </td></tr>
<tr class="memitem:af8c38cd9872296ee76f4a9ac8fb83fff template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af8c38cd9872296ee76f4a9ac8fb83fff">testFFTScaling</a> (<a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector</a>&lt; TDomain, TValue &gt; const &amp;anImage)</td></tr>
<tr class="memitem:aa14713e2ee8074c494c47a073b2d77cd" id="r_aa14713e2ee8074c494c47a073b2d77cd"><td class="memTemplParams" colspan="2">template&lt;typename TDomain, typename TValue&gt; </td></tr>
<tr class="memitem:aa14713e2ee8074c494c47a073b2d77cd template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa14713e2ee8074c494c47a073b2d77cd">cmpTranslatedFFT</a> (<a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector</a>&lt; TDomain, TValue &gt; const &amp;anImage)</td></tr>
<tr class="memitem:af9fb89f756c294253ea5df338527c963" id="r_af9fb89f756c294253ea5df338527c963"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9fb89f756c294253ea5df338527c963">TEST_CASE</a> (&quot;Checking RealFFT on a 2D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in float precision.&quot;, &quot;[2D][float]&quot;)</td></tr>
<tr class="memitem:ac5e99fb39503450caedc683f30e38978" id="r_ac5e99fb39503450caedc683f30e38978"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5e99fb39503450caedc683f30e38978">TEST_CASE</a> (&quot;Checking RealFFT on a 2D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in double precision.&quot;, &quot;[2D][double]&quot;)</td></tr>
<tr class="memitem:a7980595c6d34bed97c553e2357988656" id="r_a7980595c6d34bed97c553e2357988656"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7980595c6d34bed97c553e2357988656">TEST_CASE</a> (&quot;Checking RealFFT on a 2D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in long double precision.&quot;, &quot;[2D][long double]&quot;)</td></tr>
<tr class="memitem:a698cf1e8ef200553d798e233699cb35a" id="r_a698cf1e8ef200553d798e233699cb35a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a698cf1e8ef200553d798e233699cb35a">TEST_CASE</a> (&quot;Checking RealFFT on a 3D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in double precision.&quot;, &quot;[3D][double]&quot;)</td></tr>
<tr class="memitem:a93f45f1fabc6ac8739fddf4faab7e196" id="r_a93f45f1fabc6ac8739fddf4faab7e196"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93f45f1fabc6ac8739fddf4faab7e196">TEST_CASE</a> (&quot;Checking RealFFT on a 4D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in double precision.&quot;, &quot;[4D][double]&quot;)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR <a class="el" href="structA.html">A</a> PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<dl class="section author"><dt>Author</dt><dd>Roland Denis (<code><a href="#" onclick="location.href='mai'+'lto:'+'rol'+'an'+'d.d'+'en'+'is@'+'un'+'iv-'+'sm'+'b.f'+'r'; return false;">rolan<span class="obfuscator">.nosp@m.</span>d.de<span class="obfuscator">.nosp@m.</span>nis@u<span class="obfuscator">.nosp@m.</span>niv-<span class="obfuscator">.nosp@m.</span>smb.f<span class="obfuscator">.nosp@m.</span>r</a></code> )</dd></dl>
<dl class="section date"><dt>Date</dt><dd>2016/06/02</dd></dl>
<p>This file is part of the <a class="el" href="namespaceDGtal.html" title="DGtal is the top-level namespace which contains all DGtal functions and types.">DGtal</a> library </p>

<p class="definition">Definition in file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="aa14713e2ee8074c494c47a073b2d77cd" name="aa14713e2ee8074c494c47a073b2d77cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa14713e2ee8074c494c47a073b2d77cd">&#9670;&#160;</a></span>cmpTranslatedFFT()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TDomain, typename TValue&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void cmpTranslatedFFT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector</a>&lt; TDomain, TValue &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>anImage</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compares the FFT of an image with the FFT of its translation. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDomain</td><td><a class="el" href="classDGtal_1_1VoronoiMap.html">Domain</a> type. </td></tr>
    <tr><td class="paramname">TValue</td><td><a class="el" href="structDGtal_1_1IteratorCirculatorTraits.html">Value</a> type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">anImage</td><td>The image from which to take the domain. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00245">245</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  246</span>{</div>
<div class="line"><span class="lineno">  247</span>  <span class="keyword">using </span>FFT = RealFFT&lt; TDomain, TValue &gt;;</div>
<div class="line"><span class="lineno">  248</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a> = <span class="keyword">typename</span> TDomain::Point;</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>  <span class="keyword">const</span> <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a> shift = anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">extent</a>() / 3;</div>
<div class="line"><span class="lineno">  251</span>  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a> = anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">domain</a>();</div>
<div class="line"><span class="lineno">  252</span>  <span class="keyword">const</span> TDomain shifted_domain = TDomain( <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>.lowerBound() + shift, <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>.upperBound() + shift );</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  INFO( <span class="stringliteral">&quot;Initializing RealFFT.&quot;</span> );</div>
<div class="line"><span class="lineno">  255</span>  FFT fft( <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a> );</div>
<div class="line"><span class="lineno">  256</span>  <span class="comment">//FFT shifted_fft( domain, domain.lowerBound() + shift, anImage.extent() );</span></div>
<div class="line"><span class="lineno">  257</span>  FFT shifted_fft( shifted_domain );</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>  INFO( <span class="stringliteral">&quot;Pre-creating plan.&quot;</span> );</div>
<div class="line"><span class="lineno">  260</span>  fft.createPlan( FFTW_MEASURE, FFTW_FORWARD );</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>  INFO( <span class="stringliteral">&quot;Copying data from the image.&quot;</span> );</div>
<div class="line"><span class="lineno">  263</span>  <span class="keyword">auto</span> spatial_image = fft.getSpatialImage();</div>
<div class="line"><span class="lineno">  264</span>  std::copy( anImage.cbegin(), anImage.cend(), spatial_image.begin() );</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>  <span class="keyword">auto</span> shifted_spatial_image = shifted_fft.getSpatialImage();</div>
<div class="line"><span class="lineno">  267</span>  <span class="keyword">const</span> <span class="keyword">auto</span> spatial_extent  = shifted_fft.getSpatialExtent();</div>
<div class="line"><span class="lineno">  268</span>  <span class="keywordflow">for</span> ( <span class="keyword">auto</span> it = shifted_spatial_image.begin(); it != shifted_spatial_image.end(); ++it )</div>
<div class="line"><span class="lineno">  269</span>    {</div>
<div class="line"><span class="lineno">  270</span>      <span class="comment">// Calculating shifted coordinates with periodicity.</span></div>
<div class="line"><span class="lineno">  271</span>      <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a> pt = it.getPoint();</div>
<div class="line"><span class="lineno">  272</span>      <span class="keywordflow">for</span> ( <span class="keyword">typename</span> Point::Dimension i = 0; i &lt; Point::dimension; ++i )</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">if</span> ( pt[ i ] &gt; <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>.upperBound()[ i ] )</div>
<div class="line"><span class="lineno">  274</span>          pt[ i ] -= anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">extent</a>()[ i ];</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>      *it = anImage( pt );</div>
<div class="line"><span class="lineno">  277</span>    }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  INFO( <span class="stringliteral">&quot;Forward transformation (forcing plan re-use).&quot;</span> );</div>
<div class="line"><span class="lineno">  280</span>  fft.forwardFFT( FFTW_MEASURE | FFTW_WISDOM_ONLY );</div>
<div class="line"><span class="lineno">  281</span>  shifted_fft.forwardFFT( FFTW_MEASURE | FFTW_WISDOM_ONLY );</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>  INFO( <span class="stringliteral">&quot;Comparing results.&quot;</span> );</div>
<div class="line"><span class="lineno">  284</span>  <span class="keyword">auto</span> freq_image = fft.getFreqImage();</div>
<div class="line"><span class="lineno">  285</span>  <span class="keyword">auto</span> shifted_freq_image = shifted_fft.getFreqImage();</div>
<div class="line"><span class="lineno">  286</span>  <span class="keyword">const</span> TValue eps = 100 * std::numeric_limits&lt;TValue&gt;::epsilon();</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>  <span class="keywordflow">for</span> ( <span class="keyword">auto</span> it = freq_image.cbegin(), shifted_it = shifted_freq_image.cbegin(); it != freq_image.cend(); ++it, ++shifted_it )</div>
<div class="line"><span class="lineno">  289</span>    {</div>
<div class="line"><span class="lineno">  290</span>      <span class="keywordflow">if</span> ( std::norm(</div>
<div class="line"><span class="lineno">  291</span>                        fft.calcScaledFreqValue( fft.calcScaledFreqCoords( it.getPoint() ), *it )</div>
<div class="line"><span class="lineno">  292</span>                      - shifted_fft.calcScaledFreqValue( shifted_fft.calcScaledFreqCoords( shifted_it.getPoint() ), *shifted_it ) )</div>
<div class="line"><span class="lineno">  293</span>                &gt; eps * std::max( std::norm(*it), TValue(1) ) )</div>
<div class="line"><span class="lineno">  294</span>        FAIL( <span class="stringliteral">&quot;Approximation failed at point &quot;</span> &lt;&lt; it.getPoint()</div>
<div class="line"><span class="lineno">  295</span>              &lt;&lt; <span class="stringliteral">&quot; between &quot;</span> &lt;&lt; *it</div>
<div class="line"><span class="lineno">  296</span>              &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; shifted_fft.calcScaledFreqValue( shifted_fft.calcScaledFreqCoords( shifted_it.getPoint() ), *shifted_it )</div>
<div class="line"><span class="lineno">  297</span>              &lt;&lt; <span class="stringliteral">&quot; (scaled from &quot;</span> &lt;&lt; *shifted_it &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> );</div>
<div class="line"><span class="lineno">  298</span>    }</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>}</div>
<div class="ttc" id="aclassDGtal_1_1ImageContainerBySTLVector_html_a3fee1f50962fc0bdc2c059e0a41c8b6d"><div class="ttname"><a href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">DGtal::ImageContainerBySTLVector::extent</a></div><div class="ttdeci">const Vector &amp; extent() const</div></div>
<div class="ttc" id="aclassDGtal_1_1ImageContainerBySTLVector_html_a5101c25a228c9c4ce8c94a043cbfe63c"><div class="ttname"><a href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">DGtal::ImageContainerBySTLVector::domain</a></div><div class="ttdeci">const Domain &amp; domain() const</div></div>
<div class="ttc" id="aclassDGtal_1_1SpaceND_html"><div class="ttname"><a href="classDGtal_1_1SpaceND.html">DGtal::Point</a></div></div>
<div class="ttc" id="atestProjection_8cpp_html_a1f1a69f8d8b037b72c2160ed12b3ef51"><div class="ttname"><a href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a></div><div class="ttdeci">Domain domain</div><div class="ttdef"><b>Definition</b> <a href="testProjection_8cpp_source.html#l00088">testProjection.cpp:88</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">DGtal::ImageContainerBySTLVector&lt; TDomain, TValue &gt;::domain()</a>, <a class="el" href="testProjection_8cpp_source.html#l00088">domain</a>, and <a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">DGtal::ImageContainerBySTLVector&lt; TDomain, TValue &gt;::extent()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testRealFFT_8cpp_source.html#l00330">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00305">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00355">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00382">TEST_CASE()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00422">TEST_CASE()</a>.</p>

</div>
</div>
<a id="a4106a34e7d57e8a11093bdfdbc82516c" name="a4106a34e7d57e8a11093bdfdbc82516c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4106a34e7d57e8a11093bdfdbc82516c">&#9670;&#160;</a></span>findMaxNorm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TIterator&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">TIterator findMaxNorm </td>
          <td>(</td>
          <td class="paramtype">TIterator</td>          <td class="paramname"><span class="paramname"><em>it</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TIterator const &amp;</td>          <td class="paramname"><span class="paramname"><em>it_end</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find element with maximal norm in a range. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TIterator</td><td><a class="el" href="classDGtal_1_1IteratorCompletionTraits.html">Iterator</a> type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">it</td><td><a class="el" href="classDGtal_1_1IteratorCompletionTraits.html">Iterator</a> to the range begin. </td></tr>
    <tr><td class="paramname">it_end</td><td><a class="el" href="classDGtal_1_1IteratorCompletionTraits.html">Iterator</a> the the range end. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the iterator to the maximal element. </dd></dl>

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00105">105</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>{</div>
<div class="line"><span class="lineno">  107</span>  <span class="keyword">auto</span> norm_max = std::norm(*it);</div>
<div class="line"><span class="lineno">  108</span>  <span class="keyword">auto</span> it_max   = it;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">for</span> ( ; it != it_end; ++it )</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">if</span> ( std::norm(*it) &gt; norm_max )</div>
<div class="line"><span class="lineno">  112</span>      {</div>
<div class="line"><span class="lineno">  113</span>        norm_max = std::norm(*it);</div>
<div class="line"><span class="lineno">  114</span>        it_max   = it;</div>
<div class="line"><span class="lineno">  115</span>      }</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  <span class="keywordflow">return</span> it_max;</div>
<div class="line"><span class="lineno">  118</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="testRealFFT_8cpp_source.html#l00129">testFFTScaling()</a>.</p>

</div>
</div>
<a id="ac5e99fb39503450caedc683f30e38978" name="ac5e99fb39503450caedc683f30e38978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5e99fb39503450caedc683f30e38978">&#9670;&#160;</a></span>TEST_CASE() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;Checking RealFFT on a 2D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in double precision.&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>[2D][double]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00330">330</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  331</span>{</div>
<div class="line"><span class="lineno">  332</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a> N = 2;</div>
<div class="line"><span class="lineno">  333</span>  <span class="keyword">const</span> std::string file_name = testPath + <span class="stringliteral">&quot;/samples/church-small.pgm&quot;</span>;</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>  <span class="keyword">using </span>real    = double;</div>
<div class="line"><span class="lineno">  336</span>  <span class="keyword">using </span><a class="code hl_class" href="structDGtal_1_1ArithmeticalDSLKernel.html">Space</a>   = <a class="code hl_class" href="classDGtal_1_1SpaceND.html">SpaceND&lt;N&gt;</a>;</div>
<div class="line"><span class="lineno">  337</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1VoronoiMap.html">Domain</a>  = <a class="code hl_class" href="classDGtal_1_1HyperRectDomain.html">HyperRectDomain&lt;Space&gt;</a>;</div>
<div class="line"><span class="lineno">  338</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1Image.html">Image</a>   = <a class="code hl_class" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector&lt;Domain, real&gt;</a>;</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>  INFO( <span class="stringliteral">&quot;Importing image &quot;</span> );</div>
<div class="line"><span class="lineno">  341</span>  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> = <a class="code hl_struct" href="structDGtal_1_1PGMReader.html">PGMReader&lt; Image, functors::Cast&lt;real&gt;</a> &gt;::importPGM( file_name );</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  INFO( <span class="stringliteral">&quot;Testing forward and backward FFT.&quot;</span> );</div>
<div class="line"><span class="lineno">  344</span>  <a class="code hl_function" href="#a122ab038d9e5639ca2433cfc230a8d09">testForwardBackwardFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  INFO( <span class="stringliteral">&quot;Testing spatial domain scaling.&quot;</span> );</div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_function" href="#af8c38cd9872296ee76f4a9ac8fb83fff">testFFTScaling</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>  INFO( <span class="stringliteral">&quot;Testing FFT on translated image.&quot;</span> );</div>
<div class="line"><span class="lineno">  350</span>  <a class="code hl_function" href="#aa14713e2ee8074c494c47a073b2d77cd">cmpTranslatedFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  351</span>}</div>
<div class="ttc" id="aclassDGtal_1_1HyperRectDomain_html"><div class="ttname"><a href="classDGtal_1_1HyperRectDomain.html">DGtal::HyperRectDomain</a></div><div class="ttdoc">Aim: Parallelepidec region of a digital space, model of a &#39;CDomain&#39;.</div><div class="ttdef"><b>Definition</b> <a href="HyperRectDomain_8h_source.html#l00099">HyperRectDomain.h:100</a></div></div>
<div class="ttc" id="aclassDGtal_1_1ImageContainerBySTLVector_html"><div class="ttname"><a href="classDGtal_1_1ImageContainerBySTLVector.html">DGtal::ImageContainerBySTLVector</a></div><div class="ttdef"><b>Definition</b> <a href="ImageContainerBySTLVector_8h_source.html#l00126">ImageContainerBySTLVector.h:127</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Image_html"><div class="ttname"><a href="classDGtal_1_1Image.html">DGtal::Image</a></div><div class="ttdoc">Aim: implements association bewteen points lying in a digital domain and values.</div><div class="ttdef"><b>Definition</b> <a href="Image_8h_source.html#l00069">Image.h:70</a></div></div>
<div class="ttc" id="aclassDGtal_1_1VoronoiMap_html"><div class="ttname"><a href="classDGtal_1_1VoronoiMap.html">DGtal::Domain</a></div></div>
<div class="ttc" id="anamespaceDGtal_html_a8fbe8c8d47ca5c36ced14284ac62613d"><div class="ttname"><a href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a></div><div class="ttdeci">DGtal::uint32_t Dimension</div><div class="ttdef"><b>Definition</b> <a href="Common_8h_source.html#l00119">Common.h:119</a></div></div>
<div class="ttc" id="astructDGtal_1_1ArithmeticalDSLKernel_html"><div class="ttname"><a href="structDGtal_1_1ArithmeticalDSLKernel.html">DGtal::Space</a></div></div>
<div class="ttc" id="astructDGtal_1_1PGMReader_html"><div class="ttname"><a href="structDGtal_1_1PGMReader.html">DGtal::PGMReader</a></div><div class="ttdoc">Aim: Import a 2D or 3D using the Netpbm formats (ASCII mode).</div><div class="ttdef"><b>Definition</b> <a href="PGMReader_8h_source.html#l00097">PGMReader.h:98</a></div></div>
<div class="ttc" id="atestRealFFT_8cpp_html_a122ab038d9e5639ca2433cfc230a8d09"><div class="ttname"><a href="#a122ab038d9e5639ca2433cfc230a8d09">testForwardBackwardFFT</a></div><div class="ttdeci">void testForwardBackwardFFT(ImageContainerBySTLVector&lt; TDomain, TValue &gt; const &amp;anImage)</div><div class="ttdef"><b>Definition</b> <a href="testRealFFT_8cpp_source.html#l00067">testRealFFT.cpp:67</a></div></div>
<div class="ttc" id="atestRealFFT_8cpp_html_aa14713e2ee8074c494c47a073b2d77cd"><div class="ttname"><a href="#aa14713e2ee8074c494c47a073b2d77cd">cmpTranslatedFFT</a></div><div class="ttdeci">void cmpTranslatedFFT(ImageContainerBySTLVector&lt; TDomain, TValue &gt; const &amp;anImage)</div><div class="ttdef"><b>Definition</b> <a href="testRealFFT_8cpp_source.html#l00245">testRealFFT.cpp:245</a></div></div>
<div class="ttc" id="atestRealFFT_8cpp_html_af8c38cd9872296ee76f4a9ac8fb83fff"><div class="ttname"><a href="#af8c38cd9872296ee76f4a9ac8fb83fff">testFFTScaling</a></div><div class="ttdeci">void testFFTScaling(ImageContainerBySTLVector&lt; TDomain, TValue &gt; const &amp;anImage)</div><div class="ttdef"><b>Definition</b> <a href="testRealFFT_8cpp_source.html#l00129">testRealFFT.cpp:129</a></div></div>
<div class="ttc" id="atestSimpleRandomAccessRangeFromPoint_8cpp_html_a614d1b1c043b31763c1eb50f64666737"><div class="ttname"><a href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a></div><div class="ttdeci">Image image(domain)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testRealFFT_8cpp_source.html#l00245">cmpTranslatedFFT()</a>, <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00129">testFFTScaling()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00067">testForwardBackwardFFT()</a>.</p>

</div>
</div>
<a id="af9fb89f756c294253ea5df338527c963" name="af9fb89f756c294253ea5df338527c963"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9fb89f756c294253ea5df338527c963">&#9670;&#160;</a></span>TEST_CASE() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;Checking RealFFT on a 2D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in float precision.&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>[2D][float]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00305">305</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  306</span>{</div>
<div class="line"><span class="lineno">  307</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a> N = 2;</div>
<div class="line"><span class="lineno">  308</span>  <span class="keyword">const</span> std::string file_name = testPath + <span class="stringliteral">&quot;/samples/church-small.pgm&quot;</span>;</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>  <span class="keyword">using </span>real = float;</div>
<div class="line"><span class="lineno">  311</span>  <span class="keyword">using </span><a class="code hl_class" href="structDGtal_1_1ArithmeticalDSLKernel.html">Space</a> = <a class="code hl_class" href="classDGtal_1_1SpaceND.html">SpaceND&lt;N&gt;</a>;</div>
<div class="line"><span class="lineno">  312</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1VoronoiMap.html">Domain</a> = <a class="code hl_class" href="classDGtal_1_1HyperRectDomain.html">HyperRectDomain&lt;Space&gt;</a>;</div>
<div class="line"><span class="lineno">  313</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1Image.html">Image</a> = <a class="code hl_class" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector&lt;Domain, real&gt;</a>;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>  INFO( <span class="stringliteral">&quot;Importing image &quot;</span> );</div>
<div class="line"><span class="lineno">  316</span>  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> = <a class="code hl_struct" href="structDGtal_1_1PGMReader.html">PGMReader&lt; Image, functors::Cast&lt;real&gt;</a> &gt;::importPGM( file_name );</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>  INFO( <span class="stringliteral">&quot;Testing forward and backward FFT.&quot;</span> );</div>
<div class="line"><span class="lineno">  319</span>  <a class="code hl_function" href="#a122ab038d9e5639ca2433cfc230a8d09">testForwardBackwardFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>  INFO( <span class="stringliteral">&quot;Testing spatial domain scaling.&quot;</span> );</div>
<div class="line"><span class="lineno">  322</span>  <a class="code hl_function" href="#af8c38cd9872296ee76f4a9ac8fb83fff">testFFTScaling</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  INFO( <span class="stringliteral">&quot;Testing FFT on translated image.&quot;</span> );</div>
<div class="line"><span class="lineno">  325</span>  <a class="code hl_function" href="#aa14713e2ee8074c494c47a073b2d77cd">cmpTranslatedFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  326</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testRealFFT_8cpp_source.html#l00245">cmpTranslatedFFT()</a>, <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00129">testFFTScaling()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00067">testForwardBackwardFFT()</a>.</p>

</div>
</div>
<a id="a7980595c6d34bed97c553e2357988656" name="a7980595c6d34bed97c553e2357988656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7980595c6d34bed97c553e2357988656">&#9670;&#160;</a></span>TEST_CASE() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;Checking RealFFT on a 2D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in long double precision.&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>[2D][long double]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00355">355</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  356</span>{</div>
<div class="line"><span class="lineno">  357</span>  <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceDGtal.html">DGtal</a>;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a> N = 2;</div>
<div class="line"><span class="lineno">  360</span>  <span class="keyword">const</span> std::string file_name = testPath + <span class="stringliteral">&quot;/samples/church-small.pgm&quot;</span>;</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>  <span class="keyword">using </span>real    = <span class="keywordtype">long</span> double;</div>
<div class="line"><span class="lineno">  363</span>  <span class="keyword">using </span><a class="code hl_class" href="structDGtal_1_1ArithmeticalDSLKernel.html">Space</a>   = <a class="code hl_class" href="classDGtal_1_1SpaceND.html">SpaceND&lt;N&gt;</a>;</div>
<div class="line"><span class="lineno">  364</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1VoronoiMap.html">Domain</a>  = <a class="code hl_class" href="classDGtal_1_1HyperRectDomain.html">HyperRectDomain&lt;Space&gt;</a>;</div>
<div class="line"><span class="lineno">  365</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1Image.html">Image</a>   = <a class="code hl_class" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector&lt;Domain, real&gt;</a>;</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>  INFO( <span class="stringliteral">&quot;Importing image &quot;</span> );</div>
<div class="line"><span class="lineno">  368</span>  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> = <a class="code hl_struct" href="structDGtal_1_1PGMReader.html">PGMReader&lt; Image, functors::Cast&lt;real&gt;</a> &gt;::importPGM( file_name );</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>  INFO( <span class="stringliteral">&quot;Testing forward and backward FFT.&quot;</span> );</div>
<div class="line"><span class="lineno">  371</span>  <a class="code hl_function" href="#a122ab038d9e5639ca2433cfc230a8d09">testForwardBackwardFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>  INFO( <span class="stringliteral">&quot;Testing spatial domain scaling.&quot;</span> );</div>
<div class="line"><span class="lineno">  374</span>  <a class="code hl_function" href="#af8c38cd9872296ee76f4a9ac8fb83fff">testFFTScaling</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>  INFO( <span class="stringliteral">&quot;Testing FFT on translated image.&quot;</span> );</div>
<div class="line"><span class="lineno">  377</span>  <a class="code hl_function" href="#aa14713e2ee8074c494c47a073b2d77cd">cmpTranslatedFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  378</span>}</div>
<div class="ttc" id="anamespaceDGtal_html"><div class="ttname"><a href="namespaceDGtal.html">DGtal</a></div><div class="ttdoc">DGtal is the top-level namespace which contains all DGtal functions and types.</div><div class="ttdef"><b>Definition</b> <a href="ClosedIntegerHalfPlane_8h_source.html#l00048">ClosedIntegerHalfPlane.h:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testRealFFT_8cpp_source.html#l00245">cmpTranslatedFFT()</a>, <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00129">testFFTScaling()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00067">testForwardBackwardFFT()</a>.</p>

</div>
</div>
<a id="a698cf1e8ef200553d798e233699cb35a" name="a698cf1e8ef200553d798e233699cb35a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a698cf1e8ef200553d798e233699cb35a">&#9670;&#160;</a></span>TEST_CASE() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;Checking RealFFT on a 3D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in double precision.&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>[3D][double]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00382">382</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  383</span>{</div>
<div class="line"><span class="lineno">  384</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a> N = 3;</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>  <span class="keyword">using </span>real  = double;</div>
<div class="line"><span class="lineno">  387</span>  <span class="keyword">using </span><a class="code hl_class" href="structDGtal_1_1ArithmeticalDSLKernel.html">Space</a> = <a class="code hl_class" href="classDGtal_1_1SpaceND.html">SpaceND&lt;N&gt;</a>;</div>
<div class="line"><span class="lineno">  388</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a> = <a class="code hl_typedef" href="classDGtal_1_1SpaceND.html#a34beb5f81d0848e8ae393f39a1422ebc">Space::Point</a>;</div>
<div class="line"><span class="lineno">  389</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1VoronoiMap.html">Domain</a> = <a class="code hl_class" href="classDGtal_1_1HyperRectDomain.html">HyperRectDomain&lt;Space&gt;</a>;</div>
<div class="line"><span class="lineno">  390</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1Image.html">Image</a> = <a class="code hl_class" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector&lt;Domain, real&gt;</a>;</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>  <span class="keyword">const</span> <a class="code hl_class" href="classDGtal_1_1VoronoiMap.html">Domain</a> <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>( <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a>{0, 10, 13}, <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a>{31, 28, 45} );</div>
<div class="line"><span class="lineno">  393</span>  <a class="code hl_class" href="classDGtal_1_1Image.html">Image</a> <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>( <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a> );</div>
<div class="line"><span class="lineno">  394</span>  <span class="keyword">auto</span> <span class="keyword">const</span> extent = <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>.extent();</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>  INFO( <span class="stringliteral">&quot;Filling the image randomly.&quot;</span> );</div>
<div class="line"><span class="lineno">  397</span>  <span class="keyword">const</span> std::size_t CNT = <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>.size() / 100;</div>
<div class="line"><span class="lineno">  398</span>  std::random_device rd;</div>
<div class="line"><span class="lineno">  399</span>  std::mt19937 gen( rd() );</div>
<div class="line"><span class="lineno">  400</span>  std::uniform_real_distribution&lt;&gt; dis{};</div>
<div class="line"><span class="lineno">  401</span>  <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a> pt;</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>  <span class="keywordflow">for</span> ( std::size_t i = 0; i &lt; CNT; ++i )</div>
<div class="line"><span class="lineno">  404</span>    {</div>
<div class="line"><span class="lineno">  405</span>      <span class="keywordflow">for</span> ( <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> d = 0; d &lt; N; ++d )</div>
<div class="line"><span class="lineno">  406</span>        pt[ d ] = <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>.lowerBound()[ d ] + std::floor( extent[ d ] * dis(gen) );</div>
<div class="line"><span class="lineno">  407</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>.setValue( pt, 1. );</div>
<div class="line"><span class="lineno">  408</span>    }</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>  INFO( <span class="stringliteral">&quot;Testing forward and backward FFT.&quot;</span> );</div>
<div class="line"><span class="lineno">  411</span>  <a class="code hl_function" href="#a122ab038d9e5639ca2433cfc230a8d09">testForwardBackwardFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>  INFO( <span class="stringliteral">&quot;Testing spatial domain scaling.&quot;</span> );</div>
<div class="line"><span class="lineno">  414</span>  <a class="code hl_function" href="#af8c38cd9872296ee76f4a9ac8fb83fff">testFFTScaling</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>  INFO( <span class="stringliteral">&quot;Testing FFT on translated image.&quot;</span> );</div>
<div class="line"><span class="lineno">  417</span>  <a class="code hl_function" href="#aa14713e2ee8074c494c47a073b2d77cd">cmpTranslatedFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  418</span>}</div>
<div class="ttc" id="aclassDGtal_1_1SpaceND_html_a34beb5f81d0848e8ae393f39a1422ebc"><div class="ttname"><a href="classDGtal_1_1SpaceND.html#a34beb5f81d0848e8ae393f39a1422ebc">DGtal::SpaceND&lt; 3, Integer &gt;::Point</a></div><div class="ttdeci">PointVector&lt; dim, Integer &gt; Point</div><div class="ttdef"><b>Definition</b> <a href="SpaceND_8h_source.html#l00110">SpaceND.h:110</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testRealFFT_8cpp_source.html#l00245">cmpTranslatedFFT()</a>, <a class="el" href="testProjection_8cpp_source.html#l00088">domain</a>, <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00129">testFFTScaling()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00067">testForwardBackwardFFT()</a>.</p>

</div>
</div>
<a id="a93f45f1fabc6ac8739fddf4faab7e196" name="a93f45f1fabc6ac8739fddf4faab7e196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93f45f1fabc6ac8739fddf4faab7e196">&#9670;&#160;</a></span>TEST_CASE() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;Checking RealFFT on a 4D <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> in double precision.&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>[4D][double]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00422">422</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  423</span>{</div>
<div class="line"><span class="lineno">  424</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a> N = 4;</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  <span class="keyword">using </span>real  = double;</div>
<div class="line"><span class="lineno">  427</span>  <span class="keyword">using </span><a class="code hl_class" href="structDGtal_1_1ArithmeticalDSLKernel.html">Space</a> = <a class="code hl_class" href="classDGtal_1_1SpaceND.html">SpaceND&lt;N&gt;</a>;</div>
<div class="line"><span class="lineno">  428</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a> = <a class="code hl_typedef" href="classDGtal_1_1SpaceND.html#a34beb5f81d0848e8ae393f39a1422ebc">Space::Point</a>;</div>
<div class="line"><span class="lineno">  429</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1VoronoiMap.html">Domain</a> = <a class="code hl_class" href="classDGtal_1_1HyperRectDomain.html">HyperRectDomain&lt;Space&gt;</a>;</div>
<div class="line"><span class="lineno">  430</span>  <span class="keyword">using </span><a class="code hl_class" href="classDGtal_1_1Image.html">Image</a> = <a class="code hl_class" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector&lt;Domain, real&gt;</a>;</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>  <span class="keyword">const</span> <a class="code hl_class" href="classDGtal_1_1VoronoiMap.html">Domain</a> <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>( <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a>{0, 10, 13, 5}, <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a>{11, 28, 25, 17} );</div>
<div class="line"><span class="lineno">  433</span>  <a class="code hl_class" href="classDGtal_1_1Image.html">Image</a> <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>( <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a> );</div>
<div class="line"><span class="lineno">  434</span>  <span class="keyword">auto</span> <span class="keyword">const</span> extent = <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>.extent();</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>  INFO( <span class="stringliteral">&quot;Filling the image randomly.&quot;</span> );</div>
<div class="line"><span class="lineno">  437</span>  <span class="keyword">const</span> std::size_t CNT = <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>.size() / 100;</div>
<div class="line"><span class="lineno">  438</span>  std::random_device rd;</div>
<div class="line"><span class="lineno">  439</span>  std::mt19937 gen( rd() );</div>
<div class="line"><span class="lineno">  440</span>  std::uniform_real_distribution&lt;&gt; dis{};</div>
<div class="line"><span class="lineno">  441</span>  <a class="code hl_class" href="classDGtal_1_1SpaceND.html">Point</a> pt;</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>  <span class="keywordflow">for</span> ( std::size_t i = 0; i &lt; CNT; ++i )</div>
<div class="line"><span class="lineno">  444</span>    {</div>
<div class="line"><span class="lineno">  445</span>      <span class="keywordflow">for</span> ( <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> d = 0; d &lt; N; ++d )</div>
<div class="line"><span class="lineno">  446</span>        pt[ d ] = <a class="code hl_variable" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>.lowerBound()[ d ] + std::floor( extent[ d ] * dis(gen) );</div>
<div class="line"><span class="lineno">  447</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a>.setValue( pt, 1. );</div>
<div class="line"><span class="lineno">  448</span>    }</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>  INFO( <span class="stringliteral">&quot;Testing forward and backward FFT.&quot;</span> );</div>
<div class="line"><span class="lineno">  451</span>  <a class="code hl_function" href="#a122ab038d9e5639ca2433cfc230a8d09">testForwardBackwardFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  INFO( <span class="stringliteral">&quot;Testing spatial domain scaling.&quot;</span> );</div>
<div class="line"><span class="lineno">  454</span>  <a class="code hl_function" href="#af8c38cd9872296ee76f4a9ac8fb83fff">testFFTScaling</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>  INFO( <span class="stringliteral">&quot;Testing FFT on translated image.&quot;</span> );</div>
<div class="line"><span class="lineno">  457</span>  <a class="code hl_function" href="#aa14713e2ee8074c494c47a073b2d77cd">cmpTranslatedFFT</a>( <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image</a> );</div>
<div class="line"><span class="lineno">  458</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testRealFFT_8cpp_source.html#l00245">cmpTranslatedFFT()</a>, <a class="el" href="testProjection_8cpp_source.html#l00088">domain</a>, <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#a614d1b1c043b31763c1eb50f64666737">image()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00129">testFFTScaling()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00067">testForwardBackwardFFT()</a>.</p>

</div>
</div>
<a id="af8c38cd9872296ee76f4a9ac8fb83fff" name="af8c38cd9872296ee76f4a9ac8fb83fff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8c38cd9872296ee76f4a9ac8fb83fff">&#9670;&#160;</a></span>testFFTScaling()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TDomain, typename TValue&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void testFFTScaling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector</a>&lt; TDomain, TValue &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>anImage</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tests spatial domain scaling. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDomain</td><td><a class="el" href="classDGtal_1_1VoronoiMap.html">Domain</a> type. </td></tr>
    <tr><td class="paramname">TValue</td><td><a class="el" href="structDGtal_1_1IteratorCirculatorTraits.html">Value</a> type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">anImage</td><td>The image from which to take the domain. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00129">129</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>{</div>
<div class="line"><span class="lineno">  131</span>  <span class="keyword">typedef</span> RealFFT&lt; TDomain, TValue &gt; FFT; <span class="comment">// &quot;typedef&quot; instead of &quot;using&quot; because of g++ 4.7.4 bug.</span></div>
<div class="line"><span class="lineno">  132</span>  <span class="keyword">using </span><a class="code hl_typedef" href="testTriangulatedSurface_8cpp.html#abb3595c097987c9d2c4f0cc1902df316">RealPoint</a> = <span class="keyword">typename</span> FFT::RealPoint;</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  <span class="keyword">const</span> TValue pi = boost::math::constants::pi&lt;TValue&gt;();</div>
<div class="line"><span class="lineno">  135</span>  <span class="keyword">const</span> TValue freq = 5;</div>
<div class="line"><span class="lineno">  136</span>  <span class="keyword">const</span> TValue phase = pi/4;</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  INFO( <span class="stringliteral">&quot;Checking image size.&quot;</span> );</div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">extent</a>()[ TDomain::dimension-1 ] &gt;= 2*std::abs(freq) );</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  INFO( <span class="stringliteral">&quot;Initializing RealFFT.&quot;</span> );</div>
<div class="line"><span class="lineno">  142</span>  FFT fft( anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">domain</a>(), <a class="code hl_variable" href="classDGtal_1_1PointVector.html#a33e90a4cb6e11f968088b6895492e956">RealPoint::zero</a>, <a class="code hl_function" href="classDGtal_1_1PointVector.html#aba9def1d899ca259f6fa532a6eb9a8b5">RealPoint::diagonal</a>(1) );</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  INFO( <span class="stringliteral">&quot;Initializing spatial data.&quot;</span> );</div>
<div class="line"><span class="lineno">  145</span>  <span class="keyword">auto</span> spatial_image = fft.getSpatialImage();</div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">for</span> ( <span class="keyword">auto</span> it = spatial_image.begin(); it != spatial_image.end(); ++it )</div>
<div class="line"><span class="lineno">  147</span>    {</div>
<div class="line"><span class="lineno">  148</span>      <span class="keyword">const</span> <span class="keyword">auto</span> pt = fft.calcScaledSpatialCoords( it.getPoint() );</div>
<div class="line"><span class="lineno">  149</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( fft.calcNativeSpatialCoords( pt ) == it.getPoint() );</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>      *it = std::cos( 2*pi * freq * pt[ TDomain::dimension - 1 ] + phase );</div>
<div class="line"><span class="lineno">  152</span>    }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  INFO( <span class="stringliteral">&quot;Forward transformation.&quot;</span> );</div>
<div class="line"><span class="lineno">  155</span>  fft.forwardFFT( FFTW_ESTIMATE );</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  INFO( <span class="stringliteral">&quot;Finding maximal frequency...&quot;</span> );</div>
<div class="line"><span class="lineno">  158</span>  <span class="keyword">const</span> <span class="keyword">auto</span> freq_image = fft.getFreqImage();</div>
<div class="line"><span class="lineno">  159</span>  <span class="keyword">const</span> <span class="keyword">auto</span> it_max = <a class="code hl_function" href="#a4106a34e7d57e8a11093bdfdbc82516c">findMaxNorm</a>( freq_image.cbegin(), freq_image.cend() );</div>
<div class="line"><span class="lineno">  160</span>  <span class="keyword">const</span> <span class="keyword">auto</span> pt_max = it_max.getPoint();</div>
<div class="line"><span class="lineno">  161</span>  INFO( <span class="stringliteral">&quot;\tat &quot;</span> &lt;&lt; pt_max &lt;&lt; <span class="stringliteral">&quot; with value &quot;</span> &lt;&lt; *it_max );</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  INFO( <span class="stringliteral">&quot;Checks maximal frequency on unit domain.&quot;</span> );</div>
<div class="line"><span class="lineno">  164</span>    {</div>
<div class="line"><span class="lineno">  165</span>      <span class="keyword">auto</span> freq_pt  = fft.calcScaledFreqCoords( it_max.getPoint() );</div>
<div class="line"><span class="lineno">  166</span>      <span class="keyword">auto</span> freq_val = fft.calcScaledFreqValue( freq_pt, *it_max );</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>      <span class="keywordtype">bool</span> applyConj;</div>
<div class="line"><span class="lineno">  169</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( fft.calcNativeFreqCoords( freq_pt, applyConj ) == it_max.getPoint() );</div>
<div class="line"><span class="lineno">  170</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ! applyConj );</div>
<div class="line"><span class="lineno">  171</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( std::norm( fft.calcNativeFreqValue( freq_pt, freq_val ) - *it_max ) == Approx(0.).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(std::norm(*it_max)) );</div>
<div class="line"><span class="lineno">  172</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( std::norm( fft.getScaledFreqValue( freq_pt ) - freq_val ) == Approx(0.).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(std::norm(freq_val)) );</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>      <span class="keywordflow">if</span> ( freq_pt[ TDomain::dimension-1 ] * freq &lt; 0 )</div>
<div class="line"><span class="lineno">  175</span>        {</div>
<div class="line"><span class="lineno">  176</span>          freq_pt  = -freq_pt;</div>
<div class="line"><span class="lineno">  177</span>          freq_val = std::conj( freq_val );</div>
<div class="line"><span class="lineno">  178</span>        }</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ( freq_pt - <a class="code hl_function" href="classDGtal_1_1PointVector.html#a20694701864ca3edbcbe8cf0fe706814">RealPoint::base</a>( TDomain::dimension-1, freq ) ).norm() == Approx( 0 ).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(freq_pt.norm()) );</div>
<div class="line"><span class="lineno">  181</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ( std::fmod( std::fmod( std::arg( freq_val ) - phase, 2*pi ) + 3*pi, 2*pi ) - pi ) == Approx( 0 ).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(pi) );</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    }</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>  INFO( <span class="stringliteral">&quot;Checks maximal frequency on translated unit domain.&quot;</span> );</div>
<div class="line"><span class="lineno">  186</span>    {</div>
<div class="line"><span class="lineno">  187</span>      fft.setScaledSpatialLowerBound( <a class="code hl_function" href="classDGtal_1_1PointVector.html#aba9def1d899ca259f6fa532a6eb9a8b5">RealPoint::diagonal</a>( 1. / (4*freq) ) );</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>      <span class="keyword">auto</span> freq_pt  = fft.calcScaledFreqCoords( it_max.getPoint() );</div>
<div class="line"><span class="lineno">  190</span>      <span class="keyword">auto</span> freq_val = fft.calcScaledFreqValue( freq_pt, *it_max );</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>      <span class="keywordtype">bool</span> applyConj;</div>
<div class="line"><span class="lineno">  193</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( fft.calcNativeFreqCoords( freq_pt, applyConj ) == it_max.getPoint() );</div>
<div class="line"><span class="lineno">  194</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ! applyConj );</div>
<div class="line"><span class="lineno">  195</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( std::norm( fft.calcNativeFreqValue( freq_pt, freq_val ) - *it_max ) == Approx(0.).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(std::norm(*it_max)) );</div>
<div class="line"><span class="lineno">  196</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( std::norm( fft.getScaledFreqValue( freq_pt ) - freq_val ) == Approx(0.).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(std::norm(freq_val)) );</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>      <span class="keywordflow">if</span> ( freq_pt[ TDomain::dimension-1 ] * freq &lt; 0 )</div>
<div class="line"><span class="lineno">  199</span>        {</div>
<div class="line"><span class="lineno">  200</span>          freq_pt  = -freq_pt;</div>
<div class="line"><span class="lineno">  201</span>          freq_val = std::conj( freq_val );</div>
<div class="line"><span class="lineno">  202</span>        }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ( freq_pt - <a class="code hl_function" href="classDGtal_1_1PointVector.html#a20694701864ca3edbcbe8cf0fe706814">RealPoint::base</a>( TDomain::dimension-1, freq ) ).norm() == Approx( 0 ).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(freq_pt.norm()) );</div>
<div class="line"><span class="lineno">  205</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ( std::fmod( std::fmod( std::arg( freq_val ) - phase + pi/2, 2*pi) + 3*pi, 2*pi ) - pi ) == Approx( 0 ).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(pi) );</div>
<div class="line"><span class="lineno">  206</span>    }</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>  INFO( <span class="stringliteral">&quot;Checks maximal frequency on translated initial domain.&quot;</span> );</div>
<div class="line"><span class="lineno">  209</span>    {</div>
<div class="line"><span class="lineno">  210</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="testTriangulatedSurface_8cpp.html#abb3595c097987c9d2c4f0cc1902df316">RealPoint</a> shift = <a class="code hl_function" href="classDGtal_1_1PointVector.html#aba9def1d899ca259f6fa532a6eb9a8b5">RealPoint::diagonal</a>( 3. );</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>      fft.setScaledSpatialExtent( anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">extent</a>() );</div>
<div class="line"><span class="lineno">  213</span>      fft.setScaledSpatialLowerBound( shift );</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>      <span class="keyword">auto</span> freq_pt  = fft.calcScaledFreqCoords( it_max.getPoint() );</div>
<div class="line"><span class="lineno">  216</span>      <span class="keyword">auto</span> freq_val = fft.calcScaledFreqValue( freq_pt, *it_max );</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>      <span class="keywordtype">bool</span> applyConj;</div>
<div class="line"><span class="lineno">  219</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( fft.calcNativeFreqCoords( freq_pt, applyConj ) == it_max.getPoint() );</div>
<div class="line"><span class="lineno">  220</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ! applyConj );</div>
<div class="line"><span class="lineno">  221</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( std::norm( fft.calcNativeFreqValue( freq_pt, freq_val ) - *it_max ) == Approx(0.).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(std::norm(*it_max)) );</div>
<div class="line"><span class="lineno">  222</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( std::norm( fft.getScaledFreqValue( freq_pt ) - freq_val ) == Approx(0.).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(std::norm(freq_val)) );</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>      <span class="keywordflow">if</span> ( freq_pt[ TDomain::dimension-1 ] * freq &lt; 0 )</div>
<div class="line"><span class="lineno">  225</span>        {</div>
<div class="line"><span class="lineno">  226</span>          freq_pt  = -freq_pt;</div>
<div class="line"><span class="lineno">  227</span>          freq_val = std::conj( freq_val );</div>
<div class="line"><span class="lineno">  228</span>        }</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>      <span class="keyword">const</span> <span class="keyword">auto</span> scaled_factor = freq/anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">extent</a>()[ TDomain::dimension-1 ];</div>
<div class="line"><span class="lineno">  231</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ( freq_pt - <a class="code hl_function" href="classDGtal_1_1PointVector.html#a20694701864ca3edbcbe8cf0fe706814">RealPoint::base</a>( TDomain::dimension-1, scaled_factor ) ).norm() == Approx( 0 ).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(freq_pt.norm()) );</div>
<div class="line"><span class="lineno">  232</span>      <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ( std::fmod( std::fmod( std::arg( freq_val ) - phase + 2*pi*scaled_factor*shift[TDomain::dimension-1], 2*pi ) + 3*pi, 2*pi ) - pi ) == Approx( 0 ).<a class="code hl_variable" href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a>(pi) );</div>
<div class="line"><span class="lineno">  233</span>    }</div>
<div class="line"><span class="lineno">  234</span>}</div>
<div class="ttc" id="aclassDGtal_1_1PointVector_html_a20694701864ca3edbcbe8cf0fe706814"><div class="ttname"><a href="classDGtal_1_1PointVector.html#a20694701864ca3edbcbe8cf0fe706814">DGtal::PointVector&lt; 3, double &gt;::base</a></div><div class="ttdeci">static Self base(Dimension k, Component val=1)</div></div>
<div class="ttc" id="aclassDGtal_1_1PointVector_html_a33e90a4cb6e11f968088b6895492e956"><div class="ttname"><a href="classDGtal_1_1PointVector.html#a33e90a4cb6e11f968088b6895492e956">DGtal::PointVector&lt; 3, double &gt;::zero</a></div><div class="ttdeci">static Self zero</div><div class="ttdef"><b>Definition</b> <a href="PointVector_8h_source.html#l01595">PointVector.h:1595</a></div></div>
<div class="ttc" id="aclassDGtal_1_1PointVector_html_aba9def1d899ca259f6fa532a6eb9a8b5"><div class="ttname"><a href="classDGtal_1_1PointVector.html#aba9def1d899ca259f6fa532a6eb9a8b5">DGtal::PointVector&lt; 3, double &gt;::diagonal</a></div><div class="ttdeci">static Self diagonal(Component val=1)</div></div>
<div class="ttc" id="adgtalCalculus-bunny_8cpp_html_a1d28dec57cce925ad92342891bd71e7c"><div class="ttname"><a href="dgtalCalculus-bunny_8cpp.html#a1d28dec57cce925ad92342891bd71e7c">scale</a></div><div class="ttdeci">float scale</div><div class="ttdef"><b>Definition</b> <a href="dgtalCalculus-bunny_8cpp_source.html#l00059">dgtalCalculus-bunny.cpp:59</a></div></div>
<div class="ttc" id="atestRealFFT_8cpp_html_a4106a34e7d57e8a11093bdfdbc82516c"><div class="ttname"><a href="#a4106a34e7d57e8a11093bdfdbc82516c">findMaxNorm</a></div><div class="ttdeci">TIterator findMaxNorm(TIterator it, TIterator const &amp;it_end)</div><div class="ttdef"><b>Definition</b> <a href="testRealFFT_8cpp_source.html#l00105">testRealFFT.cpp:105</a></div></div>
<div class="ttc" id="atestSimpleRandomAccessRangeFromPoint_8cpp_html_ad8a25b2bbbbdb64c30a5442284db5bfb"><div class="ttname"><a href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a></div><div class="ttdeci">REQUIRE(domain.isInside(aPoint))</div></div>
<div class="ttc" id="atestTriangulatedSurface_8cpp_html_abb3595c097987c9d2c4f0cc1902df316"><div class="ttname"><a href="testTriangulatedSurface_8cpp.html#abb3595c097987c9d2c4f0cc1902df316">RealPoint</a></div><div class="ttdeci">PointVector&lt; 3, double &gt; RealPoint</div><div class="ttdef"><b>Definition</b> <a href="testTriangulatedSurface_8cpp_source.html#l00051">testTriangulatedSurface.cpp:51</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classDGtal_1_1PointVector.html#a20694701864ca3edbcbe8cf0fe706814">DGtal::PointVector&lt; 3, double &gt;::base()</a>, <a class="el" href="classDGtal_1_1PointVector.html#aba9def1d899ca259f6fa532a6eb9a8b5">DGtal::PointVector&lt; 3, double &gt;::diagonal()</a>, <a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">DGtal::ImageContainerBySTLVector&lt; TDomain, TValue &gt;::domain()</a>, <a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html#a3fee1f50962fc0bdc2c059e0a41c8b6d">DGtal::ImageContainerBySTLVector&lt; TDomain, TValue &gt;::extent()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00105">findMaxNorm()</a>, <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE()</a>, <a class="el" href="dgtalCalculus-bunny_8cpp_source.html#l00059">scale</a>, and <a class="el" href="PointVector_8h_source.html#l01595">DGtal::PointVector&lt; 3, double &gt;::zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="testRealFFT_8cpp_source.html#l00330">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00305">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00355">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00382">TEST_CASE()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00422">TEST_CASE()</a>.</p>

</div>
</div>
<a id="a122ab038d9e5639ca2433cfc230a8d09" name="a122ab038d9e5639ca2433cfc230a8d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a122ab038d9e5639ca2433cfc230a8d09">&#9670;&#160;</a></span>testForwardBackwardFFT()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TDomain, typename TValue&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void testForwardBackwardFFT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector</a>&lt; TDomain, TValue &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>anImage</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tests of forward FFT followed by a backward FFT. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDomain</td><td><a class="el" href="classDGtal_1_1VoronoiMap.html">Domain</a> type. </td></tr>
    <tr><td class="paramname">TValue</td><td><a class="el" href="structDGtal_1_1IteratorCirculatorTraits.html">Value</a> type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">anImage</td><td>The image to transform. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testRealFFT_8cpp_source.html#l00067">67</a> of file <a class="el" href="testRealFFT_8cpp_source.html">testRealFFT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   68</span>{</div>
<div class="line"><span class="lineno">   69</span>  <span class="keyword">using </span>FFT = RealFFT&lt; TDomain, TValue &gt;;</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  INFO( <span class="stringliteral">&quot;Initializing RealFFT.&quot;</span> );</div>
<div class="line"><span class="lineno">   72</span>  FFT fft( anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">domain</a>() );</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>  INFO( <span class="stringliteral">&quot;Copying data from the image.&quot;</span> );</div>
<div class="line"><span class="lineno">   75</span>  <span class="keyword">auto</span> spatial_image = fft.getSpatialImage();</div>
<div class="line"><span class="lineno">   76</span>  std::copy( anImage.cbegin(), anImage.cend(), spatial_image.begin() );</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>  INFO( <span class="stringliteral">&quot;Forward transformation.&quot;</span> );</div>
<div class="line"><span class="lineno">   79</span>  fft.forwardFFT( FFTW_ESTIMATE );</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  INFO( <span class="stringliteral">&quot;Checking modification of the input image.&quot;</span> );</div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_function" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE</a>( ! std::equal( anImage.cbegin(), anImage.cend(), spatial_image.cbegin() ) );</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  INFO( <span class="stringliteral">&quot;Backward transformation.&quot;</span> );</div>
<div class="line"><span class="lineno">   85</span>  fft.backwardFFT( FFTW_ESTIMATE );</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  INFO( <span class="stringliteral">&quot;Comparing result with original image.&quot;</span> );</div>
<div class="line"><span class="lineno">   88</span>  <span class="keyword">const</span> <span class="keyword">auto</span> eps = 100 * std::numeric_limits&lt;TValue&gt;::epsilon() * std::log( anImage.<a class="code hl_function" href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">domain</a>().<a class="code hl_function" href="classDGtal_1_1HyperRectDomain.html#a00d1bce33bfed669ce732c1ff0628d20">size</a>() );</div>
<div class="line"><span class="lineno">   89</span>  <a class="code hl_function" href="testConvexHull2DReverse_8cpp.html#a9bfb339d7f43fbbcb68ca21b3536bea8">CAPTURE</a>( eps );</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordflow">for</span> ( <span class="keyword">auto</span> it = spatial_image.cbegin(); it != spatial_image.cend(); ++it )</div>
<div class="line"><span class="lineno">   92</span>    {</div>
<div class="line"><span class="lineno">   93</span>      <span class="keywordflow">if</span> ( std::abs( *it - anImage( it.getPoint() ) ) &gt; eps * std::max( *it, TValue(1) ) )</div>
<div class="line"><span class="lineno">   94</span>        FAIL( <span class="stringliteral">&quot;Approximation failed: &quot;</span> &lt;&lt; *it &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; anImage( it.getPoint() ) &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; (*it - anImage( it.getPoint() ) ) );</div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span>}</div>
<div class="ttc" id="aclassDGtal_1_1HyperRectDomain_html_a00d1bce33bfed669ce732c1ff0628d20"><div class="ttname"><a href="classDGtal_1_1HyperRectDomain.html#a00d1bce33bfed669ce732c1ff0628d20">DGtal::HyperRectDomain::size</a></div><div class="ttdeci">Size size() const</div><div class="ttdef"><b>Definition</b> <a href="HyperRectDomain_8h_source.html#l00565">HyperRectDomain.h:565</a></div></div>
<div class="ttc" id="atestConvexHull2DReverse_8cpp_html_a9bfb339d7f43fbbcb68ca21b3536bea8"><div class="ttname"><a href="testConvexHull2DReverse_8cpp.html#a9bfb339d7f43fbbcb68ca21b3536bea8">CAPTURE</a></div><div class="ttdeci">CAPTURE(thicknessHV)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testConvexHull2DReverse_8cpp.html#a9bfb339d7f43fbbcb68ca21b3536bea8">CAPTURE()</a>, <a class="el" href="classDGtal_1_1ImageContainerBySTLVector.html#a5101c25a228c9c4ce8c94a043cbfe63c">DGtal::ImageContainerBySTLVector&lt; TDomain, TValue &gt;::domain()</a>, <a class="el" href="testSimpleRandomAccessRangeFromPoint_8cpp.html#ad8a25b2bbbbdb64c30a5442284db5bfb">REQUIRE()</a>, and <a class="el" href="HyperRectDomain_8h_source.html#l00565">DGtal::HyperRectDomain&lt; TSpace &gt;::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testRealFFT_8cpp_source.html#l00330">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00305">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00355">TEST_CASE()</a>, <a class="el" href="testRealFFT_8cpp_source.html#l00382">TEST_CASE()</a>, and <a class="el" href="testRealFFT_8cpp_source.html#l00422">TEST_CASE()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_59425e443f801f1f2fd8bbe4959a3ccf.html">tests</a></li><li class="navelem"><a href="dir_89a953e969bebe1af0bcb31d1e92bf3f.html">math</a></li><li class="navelem"><a href="testRealFFT_8cpp.html">testRealFFT.cpp</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for DGtal by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
