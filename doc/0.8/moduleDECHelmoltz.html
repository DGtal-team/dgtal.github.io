<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>DGtal: Helmoltz decomposition</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">0.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Helmoltz decomposition </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sectDECHelmoltzProblem">Helmoltz decomposition</a></li>
<li class="level1"><a href="#sectDECHelmoltz2D">2D Helmoltz decomposition</a></li>
<li class="level1"><a href="#sectDECHelmoltz3D">3D Helmoltz decomposition</a></li>
</ul>
</div>
<div class="textblock"><dl class="section user"><dt>Author(s) of this documentation:</dt><dd>Pierre Gueth</dd></dl>
<h1><a class="anchor" id="sectDECHelmoltzProblem"></a>
Helmoltz decomposition</h1>
<p>Helmoltz decomposition states that any 1-form \(\omega\) can be uniquely expressed as the sum of three terms.</p>
<p class="formulaDsp">
\[ \omega = d\alpha + \delta\beta + \gamma \]
</p>
<p>where \(d\) is the exterior derivative from 0-form to 1-form and \(\delta = \star d \star \) is the exterior anti-derivative from 2-form to 1-form. \(\alpha\) is a 0-form scalar potential and \(d\alpha\) is the curl free term.</p>
<p class="formulaDsp">
\[ \nabla \wedge (d \alpha) = ( \star d d \alpha )^\sharp = 0 \]
</p>
<p>\(\beta\) is a 2-form vector potential and \(\delta\beta\) is the divergence free term.</p>
<p class="formulaDsp">
\[ \nabla \cdot (\delta \beta) = \star d \star \delta \beta = \delta \delta \beta = 0 \]
</p>
<p>The remaining part \(\gamma\) is the 1-form harmonic part. \(\gamma\) has null anti-derivative and null derivative since if they were not null, they would be part of \(d\alpha\) and \(\delta\beta\).</p>
<p class="formulaDsp">
\[ \delta \gamma = d \gamma = 0 \]
</p>
<p>By differentiating \(\omega\), one can isolate DEC solvable expressions for \(\alpha\) and \(\beta\).</p>
<p class="formulaDsp">
\[ d \delta \beta = d \omega \]
</p>
 <p class="formulaDsp">
\[ \delta \omega = \delta d \alpha \]
</p>
<p>The harmonic component \(\gamma\) is computed by subtracting \(d\alpha\) and \(\delta\beta\) from \(\omega\). The interest of the Helmoltz decomposition is that \(\gamma\) has a strong connection with the topology of the structure.</p>
<h1><a class="anchor" id="sectDECHelmoltz2D"></a>
2D Helmoltz decomposition</h1>
<p>In this example, we compute primal and dual Helmoltz decomposition of an arbitrary vector field on a 2D double ring shape.</p>
<p>Here is the definition of objects used during the primal decomposition.</p>
<div class="fragment"><div class="line">    Calculus::PrimalVectorField input_vector_field(calculus);</div>
<div class="line">    <span class="keywordflow">for</span> (Calculus::Index ii=0; ii&lt;calculus.kFormLength(0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>); ii++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a> cell_center = <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a>(calculus.getSCell(0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>, ii).myCoordinates)/2.;</div>
<div class="line">        input_vector_field.myCoordinates(ii, 0) = cos(-.5*cell_center[0]+ .3*cell_center[1]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 1) = cos(.4*cell_center[0]+ .8*cell_center[1]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 input_one_form = calculus.flat(input_vector_field);</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm0 input_one_form_anti_derivated = ad1 * input_one_form;</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm2 input_one_form_derivated = d1 * input_one_form;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_calculus.png" alt="solve_2d_primal_decomposition_calculus.png"/>
<div class="caption">
Primal Helmoltz decomposition. Primal input vector field and 1-form.</div></div>
<p> And here are very similar objects used during the dual decomposition.</p>
<div class="fragment"><div class="line">    Calculus::DualVectorField input_vector_field(calculus);</div>
<div class="line">    <span class="keywordflow">for</span> (Calculus::Index ii=0; ii&lt;calculus.kFormLength(0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>); ii++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a> cell_center = <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a>(calculus.getSCell(0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>, ii).myCoordinates)/2.;</div>
<div class="line">        input_vector_field.myCoordinates(ii, 0) = cos(-.5*cell_center[0]+ .3*cell_center[1]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 1) = cos(.4*cell_center[0]+ .8*cell_center[1]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> Calculus::DualForm1 input_one_form = calculus.flat(input_vector_field);</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualForm0 input_one_form_anti_derivated = ad1 * input_one_form;</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualForm2 input_one_form_derivated = d1 * input_one_form;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_calculus.png" alt="solve_2d_dual_decomposition_calculus.png"/>
<div class="caption">
Dual Helmoltz decomposition. Dual input vector field and 1-form.</div></div>
<p> Definition of useful operators for primal decomposition.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative1 d1 = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative0 d0p = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative1 d1p = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge1 h1 = calculus.primalHodge&lt;1&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge2 h2 = calculus.primalHodge&lt;2&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge1 h1p = calculus.dualHodge&lt;1&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge2 h2p = calculus.dualHodge&lt;2&gt;();</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 1, PRIMAL, 0, PRIMAL&gt; ad1 = h2p * d1p * h1;</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 2, PRIMAL, 1, PRIMAL&gt; ad2 = h1p * d0p * h2;</div>
</div><!-- fragment --><p> Definition of useful operators for dual decomposition.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::DualDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative1 d1 = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative0 d0p = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative1 d1p = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge1 h1 = calculus.dualHodge&lt;1&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge2 h2 = calculus.dualHodge&lt;2&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge1 h1p = calculus.primalHodge&lt;1&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge2 h2p = calculus.primalHodge&lt;2&gt;();</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 1, DUAL, 0, DUAL&gt; ad1 = h2p * d1p * h1;</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 2, DUAL, 1, DUAL&gt; ad2 = h1p * d0p * h2;</div>
</div><!-- fragment --><p> Resolution of the curl-free component \(d\alpha\) for primal decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, PRIMAL, 0, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(ad1 * d0);</div>
<div class="line">        solution_curl_free = solver.solve(input_one_form_anti_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_curl_free.png" alt="solve_2d_primal_decomposition_curl_free.png"/>
<div class="caption">
Primal Helmoltz decomposition curl-free component and scalar potential field.</div></div>
<p> Resolution of the curl-free component \(d\alpha\) for dual decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, DUAL, 0, DUAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(ad1 * d0);</div>
<div class="line">        solution_curl_free = solver.solve(input_one_form_anti_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_curl_free.png" alt="solve_2d_dual_decomposition_curl_free.png"/>
<div class="caption">
Dual Helmoltz decomposition curl-free component and scalar potential field.</div></div>
<p> Resolution of the div-free component \(\delta\beta\) for primal decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 2, PRIMAL, 2, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(d1 * ad2);</div>
<div class="line">        solution_div_free = solver.solve(input_one_form_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_div_free.png" alt="solve_2d_primal_decomposition_div_free.png"/>
<div class="caption">
Primal Helmoltz decomposition divergence-free component and vector potential field.</div></div>
<p> Resolution of the div-free component \(\delta\beta\) for dual decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 2, DUAL, 2, DUAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(d1 * ad2);</div>
<div class="line">        solution_div_free = solver.solve(input_one_form_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_div_free.png" alt="solve_2d_dual_decomposition_div_free.png"/>
<div class="caption">
Dual Helmoltz decomposition divergence-free component and vector potential field.</div></div>
<p> Computation of the primal harmonic component \(\omega\).</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 solution_harmonic = input_one_form - d0*solution_curl_free - ad2*solution_div_free;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_harmonic.png" alt="solve_2d_primal_decomposition_harmonic.png"/>
<div class="caption">
Primal Helmoltz decomposition harmonic component.</div></div>
<p> Computation of the dual harmonic component \(\omega\).</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::DualForm1 solution_harmonic = input_one_form - d0*solution_curl_free - ad2*solution_div_free;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_harmonic.png" alt="solve_2d_dual_decomposition_harmonic.png"/>
<div class="caption">
Dual Helmoltz decomposition harmonic component.</div></div>
 <h1><a class="anchor" id="sectDECHelmoltz3D"></a>
3D Helmoltz decomposition</h1>
<p>In this example, we show how to compute the Helmoltz decomposition of a primal vector field defined on a 2D toroidal surface embedded in 3D.</p>
<p>First the calculus structure is filled manually with 0-, 1- and 2-cells to create a torus structure.</p>
<div class="fragment"><div class="line">    <span class="comment">// create discrete exterior calculus from set</span></div>
<div class="line">    <span class="keyword">typedef</span> DiscreteExteriorCalculus&lt;3, EigenLinearAlgebraBackend&gt; Calculus;</div>
<div class="line">    Calculus calculus;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// outer ring</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=2; kk&lt;=18; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=4; ll&lt;=36; ll++)</div>
<div class="line">        {</div>
<div class="line">            Calculus::SCell cell;</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,4,kk));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,36,kk));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(4,ll,kk));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(36,ll,kk));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// inner ring</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=2; kk&lt;=18; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=16; ll&lt;=24; ll++)</div>
<div class="line">        {</div>
<div class="line">            Calculus::SCell cell;</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,16,kk));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,24,kk));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(16,ll,kk));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(24,ll,kk));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// top and bottom</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=4; kk&lt;=36; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=0; ll&lt;=12; ll++)</div>
<div class="line">        {</div>
<div class="line">            Calculus::SCell cell;</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(4+ll,kk,2));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(4+ll,kk,18));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(24+ll,kk,2));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(24+ll,kk,18));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// top and bottom</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=0; kk&lt;=12; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=16; ll&lt;=24; ll++)</div>
<div class="line">        {</div>
<div class="line">            Calculus::SCell cell;</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,4+kk,2));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,4+kk,18));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,24+kk,2));</div>
<div class="line">            calculus.insertSCell(cell); <span class="comment">// may be flipped</span></div>
<div class="line"></div>
<div class="line">            cell = calculus.myKSpace.sCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,24+kk,18));</div>
<div class="line">            calculus.insertSCell(cell);</div>
<div class="line">        }</div>
</div><!-- fragment --><p> The primal input vector field is then filled and the associated input 1-form is computed using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a618c848c6f92e5aa91fc2d769e18099f">DiscreteExteriorCalculus.flat</a>.</p>
<div class="fragment"><div class="line">    Calculus::PrimalVectorField input_vector_field(calculus);</div>
<div class="line">    <span class="keywordflow">for</span> (Calculus::Index ii=0; ii&lt;calculus.kFormLength(0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>); ii++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceDGtal_1_1Z3i.html#a5f087066515ecd33cefd7bd080ef8114">Z3i::RealPoint</a> cell_center = <a class="code" href="namespaceDGtal_1_1Z3i.html#a5f087066515ecd33cefd7bd080ef8114">Z3i::RealPoint</a>(calculus.getSCell(0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>, ii).myCoordinates)/2.;</div>
<div class="line">        input_vector_field.myCoordinates(ii, 0) = -cos(-.3*cell_center[0] + .6*cell_center[1] + .8*cell_center[2]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 1) = sin(.8*cell_center[0] + .3*cell_center[1] - .4*cell_center[2]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 2) = -cos(cell_center[2]*.5);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 input_one_form = calculus.flat(input_vector_field);</div>
</div><!-- fragment --><p> Harmonic vector fields are aligned with natural map direction on the structure.</p>
<div class="image">
<img src="helmoltz_3d_structure.png" alt="helmoltz_3d_structure.png"/>
<div class="caption">
Manually created tore structure and input vector field.</div></div>
<p> Linear operators are then defined. Note the expression of anti-derivative computed from Hodge operators and dual exterior derivative.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative1 d1 = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative1 d1p = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative2 d2p = calculus.derivative&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge1 h1 = calculus.primalHodge&lt;1&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge2 h2 = calculus.primalHodge&lt;2&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge2 h2p = calculus.dualHodge&lt;2&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge3 h3p = calculus.dualHodge&lt;3&gt;();</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 1, PRIMAL, 0, PRIMAL&gt; ad1 = h3p * d2p * h1;</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 2, PRIMAL, 1, PRIMAL&gt; ad2 = h2p * d1p * h2;</div>
</div><!-- fragment --><p> Values of \(\alpha\) are computed from previous expression using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a4692ee1cabf426bf9b5caaac8066e86a">DiscreteExteriorCalculusSolver.solve</a>.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, PRIMAL, 0, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(ad1 * d0);</div>
<div class="line">        solution_curl_free = solver.solve(input_one_form_anti_derivated);</div>
</div><!-- fragment --><p> Values of \(\beta\) are computed from previous expression using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a4692ee1cabf426bf9b5caaac8066e86a">DiscreteExteriorCalculusSolver.solve</a>.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 2, PRIMAL, 2, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(d1 * ad2);</div>
<div class="line">        solution_div_free = solver.solve(input_one_form_derivated);</div>
</div><!-- fragment --><p> Values of \(\gamma\) are computed by subtraction.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 solution_harmonic = input_one_form - d0*solution_curl_free - ad2*solution_div_free;</div>
</div><!-- fragment --><p> \(\gamma\) has a strong connection with the structure topology and can be used to create local maps of the structure.</p>
<div class="image">
<img src="helmoltz_3d_harmonic.png" alt="helmoltz_3d_harmonic.png"/>
<div class="caption">
Harmonic component of the input vector field.</div></div>
<div class="image">
<img src="helmoltz_3d_harmonic_zoom0.png" alt="helmoltz_3d_harmonic_zoom0.png"/>
<div class="caption">
Harmonic component of the input vector field. Zoom on inner hole.</div></div>
<div class="image">
<img src="helmoltz_3d_harmonic_zoom1.png" alt="helmoltz_3d_harmonic_zoom1.png"/>
<div class="caption">
Harmonic component of the input vector field. Zoom on outer shell.</div></div>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 4 2014 12:48:09 for DGtal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
