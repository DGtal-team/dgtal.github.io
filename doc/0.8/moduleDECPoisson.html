<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>DGtal: Poisson problem</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">0.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Poisson problem </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sectDECPoissonProblem">Poisson equation</a></li>
<li class="level1"><a href="#sectDECPoisson1D">1D Poisson resolution</a><ul><li class="level2"><a href="#sectDECPoisson1DNeumann">Neumann boundary condition</a></li>
<li class="level2"><a href="#sectDECPoisson1DDirichlet">Dirichlet boundary condition</a></li>
</ul>
</li>
<li class="level1"><a href="#sectDECPoisson2D">2D Poisson problem</a></li>
</ul>
</div>
<div class="textblock"><dl class="section user"><dt>Author(s) of this documentation:</dt><dd>Pierre Gueth</dd></dl>
<h1><a class="anchor" id="sectDECPoissonProblem"></a>
Poisson equation</h1>
<p>The Poisson equation can be written as:</p>
<p class="formulaDsp">
\[ \Delta \phi = f \]
</p>
<p>where \(\Delta\) is the Laplace operator, \(\phi\) the solution of the problem and \(f\) the input of the problem. The Poisson equation can be viewed as the heat equation when steady state is reached. \(f\) is then the constant spatial heating power applied to the structure and \(\phi\) is the temperature reached in steady state (up to a spatial constant). Here we choose \(f\) to be a Dirac delta function \(\delta\) to simulate a punctual heating on the structure.</p>
<p>Depending on border conditions, \(\Delta\) may have some null eigen values. In order to make it solvable, we use a regularized version of the Laplace operator \(\Delta_\mathrm{reg}\), defined below</p>
<p class="formulaDsp">
\[ \Delta_\mathrm{reg} = \Delta + \lambda I \]
</p>
<p>where \(I\) is the identity operator and \(\lambda\) is the regularization scalar, chosen small with respect to \(\Delta\) eigen values. Linear regularized solution are the same solution as least square problem solution of the non regularized problem. \(I\) is generated using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a6288b3787b070fa568ce72d0d95651d5">DiscreteExteriorCalculus.identity</a>.</p>
<p>One can use the general Laplace operator definition.</p>
<p class="formulaDsp">
\[ \Delta = \star d \star d \]
</p>
<p>However, for convenience <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> provides a method to get the Laplace operator directly.</p>
<h1><a class="anchor" id="sectDECPoisson1D"></a>
1D Poisson resolution</h1>
<p>In this example, we create an 1D linear structure embedded in a 2D space and we solve a non regularized Poisson equation on this structure.</p>
<p>Boundary conditions effect are illustrated for the two classical boundary conditions.</p><ul>
<li>Neumann boundary condition forces the derivative to be null along the border of the structure. Here, this means that heat can't flow out the start and the end of the linear structure.</li>
<li>Dirichlet boundary condition connects borders of the structure to null potential. With our heat analogy, this means that the start and the end of the linear structure are connected to thermostat, which are given the null temperature.</li>
</ul>
<p>Boundary conditions are changed from Neumann to Dirichlet conditions by adding dangling 1-cells at the beginning and at the end of the structure.</p>
<h2><a class="anchor" id="sectDECPoisson1DNeumann"></a>
Neumann boundary condition</h2>
<p>First, an empty calculus structure is created and, using simple for loops, it is filled with some 0-cells and 1-cells to from a linear structure. When filled manually with <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#acfa7a1ece623336f4d1e746d57ed8ee6">DiscreteExteriorCalculus.insertSCell</a>, one can pass the primal over dual size ratio of each cell which defaults to 1. Temperature nodes are associated primal 0-cells. Note that to enforce Neumann boundary conditions, the linear structure has to end with 0-cells. Moreover some 1-cells are inserted as negative cells to match their orientation with the orientation of the linear structure.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceDGtal_1_1Z2i.html#aca523bebdae58eb19385aaefffff8bc5">Domain</a> domain(Point(-1,-1), Point(10,10));</div>
<div class="line"></div>
<div class="line">    <span class="keyword">typedef</span> DiscreteExteriorCalculus&lt;2, EigenLinearAlgebraBackend&gt; Calculus;</div>
<div class="line">    Calculus calculus;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=20; kk&gt;0; kk--)</div>
<div class="line">        calculus.insertSCell(calculus.myKSpace.sCell(Point(0,kk), kk%2 == 1 ? Calculus::KSpace::NEG : Calculus::KSpace::POS));</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=0; kk&lt;10; kk++)</div>
<div class="line">        calculus.insertSCell(calculus.myKSpace.sCell(Point(kk,0)));</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=0; kk&lt;10; kk++)</div>
<div class="line">        calculus.insertSCell(calculus.myKSpace.sCell(Point(10,kk)));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(10,10)));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(9,10), Calculus::KSpace::NEG));</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=10; kk&lt;20; kk++)</div>
<div class="line">        calculus.insertSCell(calculus.myKSpace.sCell(Point(8,kk)));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(8,20)));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(9,20)));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(10,20)));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(11,20)));</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=20; kk&gt;0; kk--)</div>
<div class="line">        calculus.insertSCell(calculus.myKSpace.sCell(Point(12,kk), kk%2 == 1 ? Calculus::KSpace::NEG : Calculus::KSpace::POS));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(12,0)));</div>
</div><!-- fragment --><p> The input heat vector \(f\), which is a primal 0-form in the DEC formulation, is then created and is given values of a Dirac pulse shifted at the right position.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::Index dirac_position = 17;</div>
<div class="line">    Calculus::PrimalForm0 dirac(calculus);</div>
<div class="line">    dirac.myContainer(dirac_position) = -1;</div>
</div><!-- fragment --> <div class="image">
<img src="linear_structure_neumann_dirac.png" alt="linear_structure_neumann_dirac.png"/>
<div class="caption">
Linear structure with Neumann boundary conditions. The input dirac 0-form is displayed, the blue 0-cell is where the non zero point of the Dirac is located.</div></div>
<p> The primal non regularized Laplace operator \(\Delta\) is generated using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a4adb897afe4a732d3d096618e770e448">DiscreteExteriorCalculus.primalLaplace</a>. The primal exterior derivative from 0-form to 1-form will be used to compute the gradient solution.</p>
<div class="fragment"><div class="line">        <span class="keyword">const</span> Calculus::PrimalDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">        <span class="keyword">const</span> Calculus::PrimalIdentity0 laplace = calculus.primalLaplace();</div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;d0=&quot;</span> &lt;&lt; d0 &lt;&lt; endl;</div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;laplace = &quot;</span> &lt;&lt; laplace &lt;&lt; endl;</div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; laplace.myContainer &lt;&lt; endl;</div>
</div><!-- fragment --><p> Now the problem is fully defined and there one thing left to do: solving it. The resolution is done by <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html" title="Aim: This wraps a linear algebra solver around a discrete exterior calculus. ">DiscreteExteriorCalculusSolver</a>. This class takes the actual linear solver used as the second template parameter. Any class that validates the CLinearAlgebraSolver concept can be wrapped by <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html" title="Aim: This wraps a linear algebra solver around a discrete exterior calculus. ">DiscreteExteriorCalculusSolver</a>. If <a class="el" href="namespaceDGtal.html" title="DGtal is the top-level namespace which contains all DGtal functions and types. ">DGtal</a> was compiled with eigen support enabled as described in <a class="el" href="moduleDECIntroduction.html#sectDECLinearSolver">DEC linear solver</a>, some solvers will be available in the EigenLinearAlgebraBackend. Here, we will use the EigenLinearAlgebraBackend::SolverSparseQR solver. Once created the solver is given the operator using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a90f2a9e43a13293e6368b63298363b60">DiscreteExteriorCalculusSolver.compute</a>. The input dirac 0-form is passed to <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a4692ee1cabf426bf9b5caaac8066e86a">DiscreteExteriorCalculusSolver.solve</a>, which return the solution of the problem.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> EigenLinearAlgebraBackend::SolverSparseQR LinearAlgebraSolver;</div>
<div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, PRIMAL, 0, PRIMAL&gt; Solver;</div>
<div class="line"></div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(laplace);</div>
<div class="line">        Calculus::PrimalForm0 solved_solution = solver.solve(dirac);</div>
</div><!-- fragment --><p> Since the dirac input is null everywhere except at a single point, this means that the second derivative of the solution is null everywhere except at the dirac position. An analytic form can be expressed as a continuous piece-wise quadratic function. Numerical values of the solution fit analytic values with at least a relative precision of 1e-5.</p>
<div class="image">
<img src="linear_structure_neumann_solution.png" alt="linear_structure_neumann_solution.png"/>
<div class="caption">
Linear structure with Neumann boundary conditions. Solution 0-form is displayed.</div></div>
<div class="image">
<img src="linear_structure_neumann_solution_gradient.png" alt="linear_structure_neumann_solution_gradient.png"/>
<div class="caption">
Linear structure with Neumann boundary conditions. Gradient 1-form and vector field are displayed.</div></div>
<div class="image">
<img src="linear_structure_neumann_fit.png" alt="linear_structure_neumann_fit.png"/>
<div class="caption">
Numerical values computed using the solver and analytic solution for the Neumann problem.</div></div>
 <h2><a class="anchor" id="sectDECPoisson1DDirichlet"></a>
Dirichlet boundary condition</h2>
<p>Dirichlet boundary condition fixes value of 0-forms to zero along borders of the structure. Two dangling 1-cells are added at each end of the Neumann structure to switch to Dirichlet boundary condition. Since those 1-cells are not connected to a 0-cell on one of their border, this will simulate the presence of zero-valued 0-cell in those places through enforcing Dirichlet boundary conditions.</p>
<div class="fragment"><div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(13,0)));</div>
<div class="line">    calculus.insertSCell(calculus.myKSpace.sCell(Point(1,20), Calculus::KSpace::NEG));</div>
</div><!-- fragment --><p> The input Dirac can be used as in the Neumann case since no 0-cells has been added to the structure.</p>
<div class="image">
<img src="linear_structure_dirichlet_dirac.png" alt="linear_structure_dirichlet_dirac.png"/>
<div class="caption">
Linear structure with Dirichlet boundary conditions. The input dirac 0-form is displayed, the blue 0-cell is where the non zero point is located. Two dangling edges were added at each ends of the structure.</div></div>
<p> Laplace operator need to be rebuild, even if the code doesn't change.</p>
<div class="fragment"><div class="line">        <span class="keyword">const</span> Calculus::PrimalDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">        <span class="keyword">const</span> Calculus::PrimalIdentity0 laplace = calculus.primalLaplace();</div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;d0=&quot;</span> &lt;&lt; d0 &lt;&lt; endl;</div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;laplace = &quot;</span> &lt;&lt; laplace &lt;&lt; endl;</div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; laplace.myContainer &lt;&lt; endl;</div>
</div><!-- fragment --><p> Solving the problem is achieved by using the same code as for the Neumann case. This time the analytic solution is piece-wise linear and take a constant null value at the border of the structure, as expect from the Dirichlet boundary condition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> EigenLinearAlgebraBackend::SolverSparseQR LinearAlgebraSolver;</div>
<div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, PRIMAL, 0, PRIMAL&gt; Solver;</div>
<div class="line"></div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(laplace);</div>
<div class="line">        Calculus::PrimalForm0 solved_solution = solver.solve(dirac);</div>
</div><!-- fragment --><p> Numerical values of the solution fit analytic values with at least a relative precision of 1e-5.</p>
<div class="image">
<img src="linear_structure_dirichlet_solution.png" alt="linear_structure_dirichlet_solution.png"/>
<div class="caption">
Linear structure with Dirichlet boundary conditions. Solution 0-form is displayed.</div></div>
<div class="image">
<img src="linear_structure_dirichlet_solution_gradient.png" alt="linear_structure_dirichlet_solution_gradient.png"/>
<div class="caption">
Linear structure with Dirichlet boundary conditions. Gradient 1-form and vector field are displayed.</div></div>
<div class="image">
<img src="linear_structure_dirichlet_fit.png" alt="linear_structure_dirichlet_fit.png"/>
<div class="caption">
Numerical and analytic solution for the Dirichlet problem.</div></div>
 <h1><a class="anchor" id="sectDECPoisson2D"></a>
2D Poisson problem</h1>
<p>In this example, we create a 2D ring structure and we solve a regularized Poisson equation on this structure. First the structure is created from a digital set.</p>
<div class="fragment"><div class="line">    <span class="keyword">typedef</span> DiscreteExteriorCalculus&lt;2, EigenLinearAlgebraBackend&gt; Calculus;</div>
<div class="line">    Calculus calculus(generateRingSet(domain));</div>
</div><!-- fragment --><p> Then we compute the dual regularized Laplace operator with \(\lambda = 0.01 \).</p>
<div class="fragment"><div class="line">    Calculus::DualIdentity0 laplace = calculus.dualLaplace() + 0.01 * calculus.identity&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;laplace = &quot;</span> &lt;&lt; laplace &lt;&lt; endl;</div>
</div><!-- fragment --><p> Input k-form \(y\) is a Dirac delta positioned on the dual 0-cell at coordinates \((2,5)\). DiscreteExteriorCalculus.getIndex return the index of the dual 0-form container associated with the dirac position cell.</p>
<div class="fragment"><div class="line">    Calculus::DualForm0 dirac(calculus);</div>
<div class="line">    dirac.myContainer(calculus.getSCellIndex(calculus.myKSpace.sSpel(<a class="code" href="namespaceDGtal_1_1Z2i.html#ac0a04516c81db6f4a583eddda0f64875">Z2i::Point</a>(2,5)))) = 1;</div>
</div><!-- fragment --><p> The following illustration represents the dual of the input. Hence, since we have specified a dirac on "dual 0-cell", its primal representation attaches information to (primal) 2-cells.</p>
<div class="image">
<img src="solve_laplace_calculus.png" alt="solve_laplace_calculus.png"/>
<div class="caption">
2D DEC structure with input dual 0-form.</div></div>
<p> We try to solve the problem using EigenLinearAlgebraBackend::SolverSimplicialLLT, but <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a4e0a65896dfd84aba12559b657edd580">DiscreteExteriorCalculusSolver.isValid</a> reports an error. Underlying linear algebra solver DiscreteExteriorCalculusSolver.solver.info reports a <em>numerical_error</em>.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> EigenLinearAlgebraBackend::SolverSimplicialLLT LinearAlgebraSolver;</div>
<div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, DUAL, 0, DUAL&gt; Solver;</div>
<div class="line"></div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(laplace);</div>
<div class="line">        Calculus::DualForm0 solution = solver.solve(dirac);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; solver.isValid() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; solver.myLinearAlgebraSolver.info() &lt;&lt; endl;</div>
</div><!-- fragment --><div class="image">
<img src="solve_laplace_simplicial_llt.png" alt="solve_laplace_simplicial_llt.png"/>
<div class="caption">
Poisson problem solution computed with simplicial LLT solver. Solver reports a numerical error.</div></div>
<p> Since the first solver failed, let's use another one: EigenLinearAlgebraBackend::SolverSimplicialLDLT for example. This time <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a4e0a65896dfd84aba12559b657edd580">DiscreteExteriorCalculusSolver.isValid</a> is true after computing problem solution and the solution dual 0-form contains the solution of the problem.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> EigenLinearAlgebraBackend::SolverSimplicialLDLT LinearAlgebraSolver;</div>
<div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, DUAL, 0, DUAL&gt; Solver;</div>
<div class="line"></div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(laplace);</div>
<div class="line">        Calculus::DualForm0 solution = solver.solve(dirac);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; solver.isValid() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; solver.myLinearAlgebraSolver.info() &lt;&lt; endl;</div>
</div><!-- fragment --><div class="image">
<img src="solve_laplace_simplicial_ldlt.png" alt="solve_laplace_simplicial_ldlt.png"/>
<div class="caption">
Poisson problem solution computed with simplicial LDLT solver. Solver solution is valid.</div></div>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 4 2014 12:48:09 for DGtal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
