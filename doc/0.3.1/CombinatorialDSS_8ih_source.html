<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DGtal: CombinatorialDSS.ih Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DGtal&#160;<span id="projectnumber">0.4.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_94d1b62e3f67e6bd08aba921207cd0de.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_d3e7c512d61c996f81265efa876ad753.html">DGtal</a>      </li>
      <li class="navelem"><a class="el" href="dir_0122d39cc51f130e143fee42e20221f6.html">geometry</a>      </li>
      <li class="navelem"><a class="el" href="dir_d50f1e18f82b82a6ce7a71373843004a.html">2d</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>CombinatorialDSS.ih</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00033"></a>00033 
<a name="l00035"></a>00035 <span class="comment">// IMPLEMENTATION of inline methods.</span>
<a name="l00037"></a>00037 <span class="comment"></span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 
<a name="l00041"></a>00041 <span class="comment">// ----------------------- Standard services ------------------------------</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00044"></a>00044 <span class="keyword">inline</span>
<a name="l00045"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a409735f4c9218dcc5e54a85866d7c72f">00045</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a409735f4c9218dcc5e54a85866d7c72f">DGtal::CombinatorialDSS&lt;TInteger&gt;::~CombinatorialDSS</a>()
<a name="l00046"></a>00046 {}
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00051"></a>00051 <span class="keyword">inline</span>
<a name="l00052"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a067bd43747d9cc62679e190fff6ec24b">00052</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a2448f2c8aff102678c11697d43388f5e">DGtal::CombinatorialDSS&lt;TInteger&gt;::CombinatorialDSS</a>(<span class="keyword">const</span> <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a>&amp; it)
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054   init(it);
<a name="l00055"></a>00055 }
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00058"></a>00058 <span class="keyword">inline</span>
<a name="l00059"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#acfb512eae8c1f353540e146d0387af7f">00059</a> <span class="keywordtype">void</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#acfb512eae8c1f353540e146d0387af7f">DGtal::CombinatorialDSS&lt;TInteger&gt;::init</a>(<span class="keyword">const</span> <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a>&amp; it)
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061   myFC = it.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#a55fda88e18ea7d82d0d8b3f11d63ed13">getChain</a>();
<a name="l00062"></a>00062   myNbRepeat = 1;
<a name="l00063"></a>00063   myFirstLetter = myLastLetter = myPatternBegin  = myPatternEnd =
<a name="l00064"></a>00064     myNextBefore = myNextAfter = it.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#afb37fdda225086c779e51ed44ab267f5">getPosition</a>(); 
<a name="l00065"></a>00065   myFirstPoint = *it;
<a name="l00066"></a>00066   myLastPoint = myFirstPoint + FreemanChainCode::displacement( getCode( myFirstLetter) );
<a name="l00067"></a>00067   myLeftPatternLength = 0;
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00073"></a>00073 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00074"></a>00074 <span class="keyword">inline</span>
<a name="l00075"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#abf372043ab3d59ce1d08bd89221fe88b">00075</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a2448f2c8aff102678c11697d43388f5e">DGtal::CombinatorialDSS&lt;TInteger&gt;::CombinatorialDSS</a> ( <span class="keyword">const</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">Self</a> &amp; other ) :
<a name="l00076"></a>00076   myFC                ( other.myFC ), 
<a name="l00077"></a>00077   myFirstPoint        ( other.myFirstPoint ),
<a name="l00078"></a>00078   myLastPoint         ( other.myLastPoint ),
<a name="l00079"></a>00079   myFirstLetter       ( other.myFirstLetter),
<a name="l00080"></a>00080   myLastLetter        ( other.myLastLetter),
<a name="l00081"></a>00081   myNbRepeat          ( other.myNbRepeat ), 
<a name="l00082"></a>00082   myPatternBegin      ( other.myPatternBegin ), 
<a name="l00083"></a>00083   myPatternEnd        ( other.myPatternEnd), 
<a name="l00084"></a>00084   myLeftPatternLength ( other.myLeftPatternLength ), 
<a name="l00085"></a>00085   myNextBefore        ( other.myNextBefore ), 
<a name="l00086"></a>00086   myNextAfter         ( other.myNextAfter )
<a name="l00087"></a>00087 {}
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 
<a name="l00094"></a>00094 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00095"></a>00095 <span class="keyword">inline</span>
<a name="l00096"></a>00096 <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;</a> &amp; 
<a name="l00097"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a0ff63b4af2fb6bad458dd452061c179b">00097</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::operator= </a>( <span class="keyword">const</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">Self</a> &amp; other )
<a name="l00098"></a>00098 {
<a name="l00099"></a>00099   myFC                = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a6e314ff3f14ac0460d6ba8afb2436211">myFC</a>;
<a name="l00100"></a>00100   myFirstPoint        = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a51fa8ad0a98b80baa25f1f8376d4b74a">myFirstPoint</a>;
<a name="l00101"></a>00101   myLastPoint         = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a3bf0d662e8001f8dabfd6816f0e9cc95">myLastPoint</a>;
<a name="l00102"></a>00102   myFirstLetter       = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ae6bd870e11cb5931a25899bff7260569">myFirstLetter</a>;
<a name="l00103"></a>00103   myLastLetter        = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#acf9041ba0fb0dad19948844434f5ec1b">myLastLetter</a>;
<a name="l00104"></a>00104   myNbRepeat          = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#af4787ed1138b2cb8e6f52379768e84fa">myNbRepeat</a>;
<a name="l00105"></a>00105   myPatternBegin      = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a4267bac8a77b8ca09c478e2f1da445ed">myPatternBegin</a> ;
<a name="l00106"></a>00106   myPatternEnd        = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#aa328bd3165521a728c1fc1547bf3c412">myPatternEnd</a>;
<a name="l00107"></a>00107   myLeftPatternLength = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ab2da15684b8c615b5e798b58fa9d8b95">myLeftPatternLength</a>;
<a name="l00108"></a>00108   myNextBefore        = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#acfd33ba44fa8b2c07f86258e37eacaf1">myNextBefore</a>;
<a name="l00109"></a>00109   myNextAfter         = other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a6513236aa643f0ed4555435975d3aa4d">myNextAfter</a>;
<a name="l00110"></a>00110   <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00116"></a>00116 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00117"></a>00117 <span class="keyword">inline</span>
<a name="l00118"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a53a0ef302541bb59f9281df392a2a03f">00118</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::operator==</a>( <span class="keyword">const</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">Self</a> &amp; other )<span class="keyword"> const</span>
<a name="l00119"></a>00119 <span class="keyword"></span>{
<a name="l00120"></a>00120   <span class="keywordflow">return</span> ( ( myFC == other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a6e314ff3f14ac0460d6ba8afb2436211">myFC</a> ) &amp;&amp; (
<a name="l00121"></a>00121          ( myFirstLetter == other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ae6bd870e11cb5931a25899bff7260569">myFirstLetter</a> ) 
<a name="l00122"></a>00122       &amp;&amp; ( myLastLetter  == other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#acf9041ba0fb0dad19948844434f5ec1b">myLastLetter</a>  ) )
<a name="l00123"></a>00123       || (
<a name="l00124"></a>00124          ( myFirstLetter == other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#acf9041ba0fb0dad19948844434f5ec1b">myLastLetter</a>  ) 
<a name="l00125"></a>00125       &amp;&amp; ( myLastLetter  == other.<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ae6bd870e11cb5931a25899bff7260569">myFirstLetter</a> ) ) );
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 
<a name="l00135"></a>00135 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00136"></a>00136 <span class="keyword">inline</span>
<a name="l00137"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1a1d167fb242f7ef0628e59ce1ccb4d9">00137</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::operator!=</a>( <span class="keyword">const</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">Self</a> &amp; other )<span class="keyword"> const</span>
<a name="l00138"></a>00138 <span class="keyword"></span>{
<a name="l00139"></a>00139   <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == other);
<a name="l00140"></a>00140 }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 
<a name="l00146"></a>00146 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00147"></a>00147 <span class="keyword">inline</span>
<a name="l00148"></a>00148 <span class="keywordtype">bool</span> 
<a name="l00149"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#abf7f87d6b0db8f374a6d1552b091b757">00149</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::operator==</a>( <span class="keyword">const</span> <a class="code" href="classDGtal_1_1ArithmeticalDSS.html" title="Aim: Dynamic recognition of a digital straight segment (DSS) defined as the sequence of simply connec...">ArithmeticalDSS</a> &amp; other)<span class="keyword"> const</span>
<a name="l00150"></a>00150 <span class="keyword"></span>{
<a name="l00151"></a>00151   <span class="comment">//cout &lt;&lt; &quot;getFirstPoint() = &quot; &lt;&lt; getFirstPoint() &lt;&lt; endl;</span>
<a name="l00152"></a>00152   <span class="comment">//cout &lt;&lt; &quot;getLastPoint()  = &quot; &lt;&lt; getLastPoint() &lt;&lt; endl;</span>
<a name="l00153"></a>00153   <span class="comment">//cout &lt;&lt; &quot;other.getFirstPoint() = &quot; &lt;&lt; other.getFirstPoint() &lt;&lt; endl;</span>
<a name="l00154"></a>00154   <span class="comment">//cout &lt;&lt; &quot;other.getLastPoint() = &quot; &lt;&lt;  other.getLastPoint() &lt;&lt; endl;</span>
<a name="l00155"></a>00155   <span class="keywordflow">return</span>  ( ( ( getFirstPoint() == other.<a class="code" href="classDGtal_1_1ArithmeticalDSS.html#ab7f0c3e808441489e37160054a361955">getFirstPoint</a>() ) &amp;&amp; 
<a name="l00156"></a>00156         ( getLastPoint() == other.<a class="code" href="classDGtal_1_1ArithmeticalDSS.html#a08f263e64f256dcbb11dd1e3aa65f596">getLastPoint</a>() ) ) 
<a name="l00157"></a>00157       || ( ( getFirstPoint() == other.<a class="code" href="classDGtal_1_1ArithmeticalDSS.html#a08f263e64f256dcbb11dd1e3aa65f596">getLastPoint</a>() ) &amp;&amp; 
<a name="l00158"></a>00158         ( getLastPoint() == other.<a class="code" href="classDGtal_1_1ArithmeticalDSS.html#ab7f0c3e808441489e37160054a361955">getFirstPoint</a>() ) ) 
<a name="l00159"></a>00159       );
<a name="l00160"></a>00160 }
<a name="l00161"></a>00161 
<a name="l00167"></a>00167 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00168"></a>00168 <span class="keyword">inline</span>
<a name="l00169"></a>00169 <span class="keywordtype">bool</span> 
<a name="l00170"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#acbe5f9fcf060fdefc5fb653ccb44f5f6">00170</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::operator!=</a>( <span class="keyword">const</span> <a class="code" href="classDGtal_1_1ArithmeticalDSS.html" title="Aim: Dynamic recognition of a digital straight segment (DSS) defined as the sequence of simply connec...">ArithmeticalDSS</a> &amp; other)<span class="keyword"> const</span>
<a name="l00171"></a>00171 <span class="keyword"></span>{
<a name="l00172"></a>00172   <span class="keywordflow">return</span> !( *<span class="keyword">this</span> == other );
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 
<a name="l00182"></a>00182 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00183"></a>00183 <span class="keyword">inline</span>
<a name="l00184"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#acd6a955636918909704172b8cdfc33bc">00184</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::extend</a>(<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a> it)
<a name="l00185"></a>00185 {
<a name="l00186"></a>00186   <span class="comment">// Normal cases</span>
<a name="l00187"></a>00187   <span class="keywordflow">if</span> ( (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a>) it.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#afb37fdda225086c779e51ed44ab267f5">getPosition</a>() == myLastLetter + 1) 
<a name="l00188"></a>00188     <span class="keywordflow">return</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#acd6a955636918909704172b8cdfc33bc">extend</a>();
<a name="l00189"></a>00189   <span class="keywordflow">if</span> ( (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a>) it.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#afb37fdda225086c779e51ed44ab267f5">getPosition</a>() == myFirstLetter - 1) 
<a name="l00190"></a>00190     <span class="keywordflow">return</span> extendOppositeEnd();
<a name="l00191"></a>00191   <span class="keywordflow">if</span> ( (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a>) it.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#afb37fdda225086c779e51ed44ab267f5">getPosition</a>() == (myLastLetter+1) % (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a>) myFC-&gt;size() ) 
<a name="l00192"></a>00192     <span class="keywordflow">return</span> extend();
<a name="l00193"></a>00193   <span class="keywordflow">if</span> ( (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a>) it.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#afb37fdda225086c779e51ed44ab267f5">getPosition</a>() == (myFirstLetter-1) % (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a>) myFC-&gt;size() ) 
<a name="l00194"></a>00194     <span class="keywordflow">return</span> extendOppositeEnd();
<a name="l00195"></a>00195   ASSERT(<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;[CombinatorialDSS::extend(ConstIterator it)] iterator &#39;it&#39; is not valid&quot;</span>);
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 
<a name="l00202"></a>00202 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00203"></a>00203 <span class="keyword">inline</span>
<a name="l00204"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a243b203dc0b041edb0684865005dd6e5">00204</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::extend</a>()
<a name="l00205"></a>00205 {
<a name="l00206"></a>00206   <span class="keywordflow">if</span> (myLastPoint == *(myFC-&gt;end()))
<a name="l00207"></a>00207     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00208"></a>00208   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad2c4ec6496036af1074bd76797bb7971">Code</a> letterRead = getCode( myLastLetter + 1 );
<a name="l00209"></a>00209   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad2c4ec6496036af1074bd76797bb7971">Code</a> letterExpected = getCode( myNextAfter );
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   <span class="comment">//cout &lt;&lt; &quot;[DGtal::CombinatorialDSS&lt;TInteger&gt;::extend()]\n&quot;;</span>
<a name="l00212"></a>00212   <span class="comment">//cout &lt;&lt; &quot;letterRead = getCode(&quot; &lt;&lt; myLastLetter+1 &lt;&lt; &quot;) = &quot; &lt;&lt; letterRead &lt;&lt; endl;</span>
<a name="l00213"></a>00213   <span class="comment">//cout &lt;&lt; &quot;letterExpected = getCode(&quot; &lt;&lt; myNextAfter &lt;&lt; &quot;) = &quot; &lt;&lt; letterExpected &lt;&lt; endl;</span>
<a name="l00214"></a>00214   <span class="comment">// Test if the new letter forms a longer prefix of the main pattern</span>
<a name="l00215"></a>00215   <span class="comment">// If the new letter is not what was expected, either the main pattern</span>
<a name="l00216"></a>00216   <span class="comment">// has to grow or either the DSS may not be extended.</span>
<a name="l00217"></a>00217   <span class="keywordflow">if</span> ( letterRead == letterExpected ) {
<a name="l00218"></a>00218     <span class="comment">// Test if it is a complete repetition of the main pattern</span>
<a name="l00219"></a>00219     <span class="keywordflow">if</span> ( myNextAfter == myPatternEnd ) {
<a name="l00220"></a>00220       ++myNbRepeat;
<a name="l00221"></a>00221       myNextAfter = myPatternBegin;
<a name="l00222"></a>00222     } <span class="keywordflow">else</span> {
<a name="l00223"></a>00223       ++myNextAfter;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isTrivial() ) {
<a name="l00227"></a>00227     myLeftPatternLength = 1;
<a name="l00228"></a>00228     myNbRepeat = 1;
<a name="l00229"></a>00229     myPatternEnd = myLastLetter + 1;
<a name="l00230"></a>00230     myNextBefore = myPatternEnd;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( nextIsLL( myNextAfter ) &amp;&amp; ( letterRead == getBigLetter() ) ) {
<a name="l00233"></a>00233     <span class="comment">// The previous main pattern is now the left subpattern</span>
<a name="l00234"></a>00234     myLeftPatternLength    = mainPatternLength();
<a name="l00235"></a>00235     myNbRepeat             = 1;
<a name="l00236"></a>00236     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldSuffixLength = suffixLength();
<a name="l00237"></a>00237     myPatternEnd           = myLastLetter + 1;
<a name="l00238"></a>00238     myNextBefore           = myPatternEnd - myOldSuffixLength;
<a name="l00239"></a>00239     myNextAfter            = myPatternBegin;
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isUL( myNextAfter ) &amp;&amp; ( letterRead == getSmallLetter() ) ) {
<a name="l00242"></a>00242     <span class="comment">//In this case thw whole main pattern is modified! Not only complexified.</span>
<a name="l00243"></a>00243     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldLeftPatternLength = myLeftPatternLength;
<a name="l00244"></a>00244     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldSuffixLength = suffixLength();
<a name="l00245"></a>00245     myNbRepeat = 1;
<a name="l00246"></a>00246     myLeftPatternLength = mainPatternLength();
<a name="l00247"></a>00247     myPatternEnd = myLastLetter + 1;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <span class="comment">// test if the suffix is long enough to contain the new first upper</span>
<a name="l00250"></a>00250     <span class="comment">// leaning point (beginning of the main pattern) </span>
<a name="l00251"></a>00251     <span class="keywordflow">if</span> ( myOldSuffixLength &lt; myOldLeftPatternLength ) {
<a name="l00252"></a>00252       myPatternBegin = myPatternBegin + myLeftPatternLength 
<a name="l00253"></a>00253         - myOldLeftPatternLength;
<a name="l00254"></a>00254       myNextBefore = myPatternEnd - myLeftPatternLength +
<a name="l00255"></a>00255         myOldLeftPatternLength - myOldSuffixLength;
<a name="l00256"></a>00256     } <span class="keywordflow">else</span> {
<a name="l00257"></a>00257       <span class="comment">//TODO : test this!</span>
<a name="l00258"></a>00258       myPatternBegin = myPatternBegin - myOldLeftPatternLength;
<a name="l00259"></a>00259       myNextBefore = myPatternEnd - (myOldSuffixLength - myOldLeftPatternLength);
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261     myNextAfter = myPatternBegin;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   } <span class="keywordflow">else</span> {
<a name="l00264"></a>00264     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00265"></a>00265   }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267   ++myLastLetter;
<a name="l00268"></a>00268   myLastPoint += FreemanChainCode::displacement( getCode( myLastLetter ) );
<a name="l00269"></a>00269   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00270"></a>00270 }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 
<a name="l00276"></a>00276 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00277"></a>00277 <span class="keyword">inline</span>
<a name="l00278"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#ac4e0184764a4ee9bcdcbffda0e00ac9f">00278</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::extendOppositeEnd</a>()
<a name="l00279"></a>00279 {
<a name="l00280"></a>00280   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad2c4ec6496036af1074bd76797bb7971">Code</a> letterRead = getCode( myFirstLetter - 1);
<a name="l00281"></a>00281   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad2c4ec6496036af1074bd76797bb7971">Code</a> letterExpected = getCode( myNextBefore );
<a name="l00282"></a>00282 
<a name="l00283"></a>00283   <span class="comment">//cout &lt;&lt; &quot;[DGtal::CombinatorialDSS&lt;TInteger&gt;::extendOppositeEnd()]\n&quot;;</span>
<a name="l00284"></a>00284   <span class="comment">//cout &lt;&lt; &quot;letterRead = getCode(&quot; &lt;&lt; myFirstLetter-1 &lt;&lt; &quot;) = &quot; &lt;&lt; letterRead &lt;&lt; endl;</span>
<a name="l00285"></a>00285   <span class="comment">//cout &lt;&lt; &quot;letterExpected = getCode(&quot; &lt;&lt; myNextBefore &lt;&lt; &quot;) = &quot; &lt;&lt; letterExpected &lt;&lt; endl;</span>
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   <span class="comment">// Test if the new letter forms a longer suffix of the main pattern</span>
<a name="l00288"></a>00288   <span class="comment">// If the new letter is not what was expected, either the main pattern</span>
<a name="l00289"></a>00289   <span class="comment">// has to grow or either the DSS may not be extended.</span>
<a name="l00290"></a>00290   <span class="keywordflow">if</span> ( letterRead == letterExpected ) {
<a name="l00291"></a>00291     <span class="comment">// Test if it forms a complete repetition of the main pattern</span>
<a name="l00292"></a>00292     <span class="keywordflow">if</span> ( myNextBefore == myPatternBegin ) {
<a name="l00293"></a>00293       <span class="comment">//cout &lt;&lt; &quot;Case 1&quot; &lt;&lt; endl;</span>
<a name="l00294"></a>00294       ++myNbRepeat;
<a name="l00295"></a>00295       <span class="comment">// Move main pattern one iteration backward, nb &#39;myNextBefore&#39; is</span>
<a name="l00296"></a>00296       <span class="comment">// already one iteration before.</span>
<a name="l00297"></a>00297       <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> mpl = mainPatternLength();
<a name="l00298"></a>00298       myPatternBegin -= mpl;
<a name="l00299"></a>00299       myPatternEnd   -= mpl;
<a name="l00300"></a>00300       myNextAfter    -= mpl;
<a name="l00301"></a>00301       myNextBefore    = myPatternEnd;
<a name="l00302"></a>00302     } <span class="keywordflow">else</span> {
<a name="l00303"></a>00303       --myNextBefore;
<a name="l00304"></a>00304       <span class="comment">//cout &lt;&lt; &quot;Case 2&quot; &lt;&lt; endl;</span>
<a name="l00305"></a>00305     }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 
<a name="l00308"></a>00308   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isTrivial() ) {
<a name="l00309"></a>00309     <span class="comment">//cout &lt;&lt; &quot;Case 3&quot; &lt;&lt; endl;</span>
<a name="l00310"></a>00310     myLeftPatternLength = myNbRepeat;
<a name="l00311"></a>00311     myPatternEnd += myNbRepeat-1;
<a name="l00312"></a>00312     myNbRepeat = 1;
<a name="l00313"></a>00313     myPatternBegin = myFirstLetter - 1;
<a name="l00314"></a>00314     myNextBefore = myPatternEnd;
<a name="l00315"></a>00315     myNextAfter  = myPatternBegin;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( previousIsLL( myNextBefore ) &amp;&amp; ( letterRead == getSmallLetter() ) ) {
<a name="l00318"></a>00318     <span class="comment">//cout &lt;&lt; &quot;Case 4&quot; &lt;&lt; endl;</span>
<a name="l00319"></a>00319     <span class="comment">// The previous main pattern is now the left subpattern</span>
<a name="l00320"></a>00320     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldMainPatternLength = mainPatternLength();
<a name="l00321"></a>00321     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldLeftPatternLength = myLeftPatternLength;
<a name="l00322"></a>00322     <span class="comment">//Size myOldRightPatternLength = myOldMainPatternLength - myOldLeftPatternLength;</span>
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     myPatternBegin = myFirstLetter - 1;
<a name="l00325"></a>00325     myPatternEnd += (myNbRepeat-1) * myOldMainPatternLength;
<a name="l00326"></a>00326     myLeftPatternLength = mainPatternLength() - myOldMainPatternLength;
<a name="l00327"></a>00327     myNbRepeat = 1;
<a name="l00328"></a>00328     myNextBefore = myPatternEnd;
<a name="l00329"></a>00329     myNextAfter -= myOldLeftPatternLength;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isUL( myNextBefore ) &amp;&amp; ( letterRead == getBigLetter() ) ) {
<a name="l00332"></a>00332     <span class="comment">//In this case the whole main pattern is modified! Not only complexified.</span>
<a name="l00333"></a>00333     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldMainPatternLength  = mainPatternLength();
<a name="l00334"></a>00334     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldRightPatternLength = myOldMainPatternLength - myLeftPatternLength;
<a name="l00335"></a>00335     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldPrefixLength       = prefixLength();
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     myPatternBegin = myFirstLetter - 1;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     <span class="comment">// test if the prefix is long enough to contain the new Last Upper</span>
<a name="l00340"></a>00340     <span class="comment">// Leaning point</span>
<a name="l00341"></a>00341     <span class="keywordflow">if</span> ( myOldPrefixLength &lt; myOldRightPatternLength ) {
<a name="l00342"></a>00342       <span class="comment">//cout &lt;&lt; &quot;Case 5&quot; &lt;&lt; endl;</span>
<a name="l00343"></a>00343       myNextAfter = myNextAfter - myOldMainPatternLength + myLeftPatternLength;
<a name="l00344"></a>00344       myPatternEnd = myPatternEnd 
<a name="l00345"></a>00345         + (myNbRepeat - 1)*myOldMainPatternLength 
<a name="l00346"></a>00346         - myLeftPatternLength;
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     } <span class="keywordflow">else</span> {
<a name="l00349"></a>00349       <span class="comment">//cout &lt;&lt; &quot;Case 6&quot; &lt;&lt; endl;</span>
<a name="l00350"></a>00350       myNextAfter = myNextAfter - myOldMainPatternLength - myOldRightPatternLength;
<a name="l00351"></a>00351       myPatternEnd = myPatternEnd 
<a name="l00352"></a>00352         + myNbRepeat*myOldMainPatternLength 
<a name="l00353"></a>00353         - myLeftPatternLength;
<a name="l00354"></a>00354     }
<a name="l00355"></a>00355     myNbRepeat = 1;
<a name="l00356"></a>00356     myNextBefore = myPatternEnd;
<a name="l00357"></a>00357     myLeftPatternLength = mainPatternLength() - myOldMainPatternLength;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359   } <span class="keywordflow">else</span> {
<a name="l00360"></a>00360     <span class="comment">//cout &lt;&lt; &quot;Case 7&quot; &lt;&lt; endl;</span>
<a name="l00361"></a>00361     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00362"></a>00362   }
<a name="l00363"></a>00363   --myFirstLetter;
<a name="l00364"></a>00364   myFirstPoint -= FreemanChainCode::displacement( getCode( myFirstLetter ) );
<a name="l00365"></a>00365   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 
<a name="l00373"></a>00373 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00374"></a>00374 <span class="keyword">inline</span>
<a name="l00375"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#aaf5b27115653ed2537654bc383b000b1">00375</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::retract</a>()
<a name="l00376"></a>00376 {
<a name="l00377"></a>00377   <span class="comment">//cout &lt;&lt; &quot;[DGtal::CombinatorialDSS&lt;TInteger&gt;::retract(&quot; &lt;&lt; myFirstLetter &lt;&lt; &quot;)]&quot; &lt;&lt; endl;</span>
<a name="l00378"></a>00378 
<a name="l00379"></a>00379   <span class="keywordflow">if</span> ( myNextBefore != myPatternEnd ) {
<a name="l00380"></a>00380     <span class="comment">//Normal case</span>
<a name="l00381"></a>00381     <span class="comment">//cout &lt;&lt; &quot;Case 1&quot; &lt;&lt; endl;</span>
<a name="l00382"></a>00382     ++myNextBefore;
<a name="l00383"></a>00383 
<a name="l00384"></a>00384   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isTrivial() ) {
<a name="l00385"></a>00385     <span class="comment">// In this case, it can be shorten only if there is more than one</span>
<a name="l00386"></a>00386     <span class="comment">// repetition.</span>
<a name="l00387"></a>00387     <span class="comment">//cout &lt;&lt; &quot;Case 2&quot; &lt;&lt; endl;</span>
<a name="l00388"></a>00388     <span class="keywordflow">if</span> ( myNbRepeat == 1 ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00389"></a>00389     myPatternBegin = myPatternEnd = myNextBefore = ++myNextAfter;
<a name="l00390"></a>00390     --myNbRepeat;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( myNbRepeat &gt;= 2 ) { 
<a name="l00393"></a>00393     <span class="comment">// Got more than one repetition, it suffices to consider the next</span>
<a name="l00394"></a>00394     <span class="comment">// repetition of the main pattern with one less repetition.</span>
<a name="l00395"></a>00395     <span class="comment">//cout &lt;&lt; &quot;Case 3&quot; &lt;&lt; endl;</span>
<a name="l00396"></a>00396     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldMainPatternLength = mainPatternLength();
<a name="l00397"></a>00397     myPatternBegin += myOldMainPatternLength;
<a name="l00398"></a>00398     myPatternEnd   += myOldMainPatternLength;
<a name="l00399"></a>00399     myNextAfter    += myOldMainPatternLength;
<a name="l00400"></a>00400     myNextBefore = myPatternBegin;
<a name="l00401"></a>00401     --myNbRepeat;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403   } <span class="keywordflow">else</span> {
<a name="l00404"></a>00404     <span class="comment">//Only one repetition, the slope is modified.</span>
<a name="l00405"></a>00405     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldMainPatternLength = mainPatternLength();
<a name="l00406"></a>00406     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldLeftPatternLength = myLeftPatternLength;
<a name="l00407"></a>00407     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldRightPatternLength = myOldMainPatternLength - myOldLeftPatternLength;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409     <span class="keywordflow">if</span> ( prefixLength() &gt;= myOldRightPatternLength ) {
<a name="l00410"></a>00410       <span class="comment">// A second Lower Leaning Point has been read in the prefix at</span>
<a name="l00411"></a>00411       <span class="comment">// the end of the main pattern. The slope is simply reversed.</span>
<a name="l00412"></a>00412       <span class="comment">//cout &lt;&lt; &quot;Case 4&quot; &lt;&lt; endl;</span>
<a name="l00413"></a>00413       myLeftPatternLength = myOldRightPatternLength;
<a name="l00414"></a>00414       myPatternBegin     += myOldRightPatternLength;
<a name="l00415"></a>00415       myPatternEnd       += myOldRightPatternLength;
<a name="l00416"></a>00416       myNextBefore = myPatternEnd - myOldRightPatternLength + 1;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( myOldLeftPatternLength &lt; myOldRightPatternLength ) {
<a name="l00419"></a>00419       <span class="comment">// Remove one repetition of the left Berstel pattern.</span>
<a name="l00420"></a>00420       <span class="comment">//cout &lt;&lt; &quot;Case 5&quot; &lt;&lt; endl;</span>
<a name="l00421"></a>00421       myPatternBegin += myOldLeftPatternLength;
<a name="l00422"></a>00422       myNextBefore -= ( myOldLeftPatternLength - 1 );
<a name="l00423"></a>00423       myNextAfter += myOldLeftPatternLength;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( myOldLeftPatternLength &gt; myOldRightPatternLength ) {
<a name="l00426"></a>00426       <span class="comment">// The complexity of the slope is modified.</span>
<a name="l00427"></a>00427       <span class="comment">//cout &lt;&lt; &quot;Case 6&quot; &lt;&lt; endl;</span>
<a name="l00428"></a>00428       <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myNbBerstelRight = (myOldRightPatternLength &gt; 1) ?
<a name="l00429"></a>00429         myOldMainPatternLength / myOldRightPatternLength :
<a name="l00430"></a>00430         myOldMainPatternLength - 1;
<a name="l00431"></a>00431       <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myBerstelLeftLength = myOldMainPatternLength - 
<a name="l00432"></a>00432         ( myNbBerstelRight * myOldRightPatternLength ); 
<a name="l00433"></a>00433       <span class="comment">// Right subpattern becomes the main pattern</span>
<a name="l00434"></a>00434       myNbRepeat = myNbBerstelRight;
<a name="l00435"></a>00435       myPatternBegin += myBerstelLeftLength;
<a name="l00436"></a>00436       myPatternEnd = myPatternBegin + myOldRightPatternLength - 1;
<a name="l00437"></a>00437       myNextBefore = myPatternEnd - myBerstelLeftLength + 1;
<a name="l00438"></a>00438       myNextAfter += myBerstelLeftLength;
<a name="l00439"></a>00439       myLeftPatternLength = (myPatternBegin == myPatternEnd) ? 
<a name="l00440"></a>00440         0 : myBerstelLeftLength;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     } <span class="keywordflow">else</span> {
<a name="l00443"></a>00443       <span class="comment">// Special case of slope 1/1 with no prefix read, only a trivial</span>
<a name="l00444"></a>00444       <span class="comment">// DSS remains.</span>
<a name="l00445"></a>00445       <span class="comment">//cout &lt;&lt; &quot;Case 7&quot; &lt;&lt; endl;</span>
<a name="l00446"></a>00446       myNextBefore = myNextAfter = myPatternBegin = myPatternEnd;
<a name="l00447"></a>00447       myLeftPatternLength = 0;
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449   }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   myFirstPoint += FreemanChainCode::displacement( getCode( myFirstLetter ) );
<a name="l00452"></a>00452   ++myFirstLetter;
<a name="l00453"></a>00453   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00454"></a>00454 }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 
<a name="l00460"></a>00460 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00461"></a>00461 <span class="keyword">inline</span>
<a name="l00462"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a8f7652200ef294079128cde4110933a2">00462</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::retractOppositeEnd</a>()
<a name="l00463"></a>00463 {
<a name="l00464"></a>00464   <span class="comment">//cout &lt;&lt; &quot;[DGtal::CombinatorialDSS&lt;TInteger&gt;::retractOppositeEnd(&quot; &lt;&lt; myLastPoint &lt;&lt; &quot;)]&quot; &lt;&lt; endl;</span>
<a name="l00465"></a>00465 
<a name="l00466"></a>00466   <span class="keywordflow">if</span> ( myNextAfter != myPatternBegin ) {
<a name="l00467"></a>00467     <span class="comment">// Normal case</span>
<a name="l00468"></a>00468     <span class="comment">//cout &lt;&lt; &quot;Case 1&quot; &lt;&lt; endl;</span>
<a name="l00469"></a>00469     --myNextAfter;
<a name="l00470"></a>00470 
<a name="l00471"></a>00471   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isTrivial() ) {
<a name="l00472"></a>00472     <span class="comment">// In this case, it can be shorten only if there is more than one</span>
<a name="l00473"></a>00473     <span class="comment">// repetition.</span>
<a name="l00474"></a>00474     <span class="comment">//cout &lt;&lt; &quot;Case 2&quot; &lt;&lt; endl;</span>
<a name="l00475"></a>00475     <span class="keywordflow">if</span> ( myNbRepeat == 1 ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00476"></a>00476     --myNbRepeat;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( myNbRepeat &gt;= 2 ) {
<a name="l00479"></a>00479     <span class="comment">// Got more than one repetition, it suffices to consider the next</span>
<a name="l00480"></a>00480     <span class="comment">// repetition of the main pattern with one less repetition.</span>
<a name="l00481"></a>00481     <span class="comment">//cout &lt;&lt; &quot;Case 3&quot; &lt;&lt; endl;</span>
<a name="l00482"></a>00482     --myNbRepeat;
<a name="l00483"></a>00483     myNextAfter = myPatternEnd;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485   } <span class="keywordflow">else</span> {
<a name="l00486"></a>00486     <span class="comment">//Only one repetition, the slope is modified.</span>
<a name="l00487"></a>00487     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldMainPatternLength = mainPatternLength();
<a name="l00488"></a>00488     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldLeftPatternLength = myLeftPatternLength;
<a name="l00489"></a>00489     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldRightPatternLength = myOldMainPatternLength -
<a name="l00490"></a>00490       myOldLeftPatternLength;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     <span class="keywordflow">if</span> ( suffixLength() &gt;= myOldLeftPatternLength ) {
<a name="l00493"></a>00493       <span class="comment">// A second Lower Leaning Point has been read in the suffix at</span>
<a name="l00494"></a>00494       <span class="comment">// the front of the main pattern. The slope is simply reversed.</span>
<a name="l00495"></a>00495       <span class="comment">//cout &lt;&lt; &quot;Case 4&quot; &lt;&lt; endl;</span>
<a name="l00496"></a>00496       myLeftPatternLength = myOldRightPatternLength;
<a name="l00497"></a>00497       myPatternBegin -= myOldLeftPatternLength;
<a name="l00498"></a>00498       myPatternEnd   -= myOldLeftPatternLength;
<a name="l00499"></a>00499       myNextAfter = myPatternBegin + myOldLeftPatternLength - 1;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( myOldLeftPatternLength &gt; myOldRightPatternLength ) {
<a name="l00502"></a>00502       <span class="comment">// Remove one repetition of the right Berstel pattern.</span>
<a name="l00503"></a>00503       <span class="comment">//cout &lt;&lt; &quot;Case 5&quot; &lt;&lt; endl;</span>
<a name="l00504"></a>00504       myPatternEnd -= myOldRightPatternLength;
<a name="l00505"></a>00505       myNextAfter += ( myOldRightPatternLength - 1 );
<a name="l00506"></a>00506       myNextBefore -= myOldRightPatternLength; 
<a name="l00507"></a>00507       myLeftPatternLength -= myOldRightPatternLength;
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( myOldLeftPatternLength &lt; myOldRightPatternLength ) {
<a name="l00510"></a>00510       <span class="comment">// The complexity of the slope is modified.</span>
<a name="l00511"></a>00511       <span class="comment">//cout &lt;&lt; &quot;Case 6&quot; &lt;&lt; endl;</span>
<a name="l00512"></a>00512       <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myNbBerstelLeft = (myOldLeftPatternLength &gt; 1) ?
<a name="l00513"></a>00513            myOldMainPatternLength / myOldLeftPatternLength :
<a name="l00514"></a>00514         myOldMainPatternLength - 1;
<a name="l00515"></a>00515       <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myBerstelRightLength = myOldMainPatternLength - 
<a name="l00516"></a>00516         ( myNbBerstelLeft * myOldLeftPatternLength ); 
<a name="l00517"></a>00517       <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myOldSuffixLength = suffixLength();
<a name="l00518"></a>00518 
<a name="l00519"></a>00519       <span class="comment">// Left subpattern becomes the main pattern.</span>
<a name="l00520"></a>00520       myNbRepeat = myNbBerstelLeft;
<a name="l00521"></a>00521       myLeftPatternLength = myOldLeftPatternLength - myBerstelRightLength;
<a name="l00522"></a>00522       myPatternEnd = myPatternBegin + myOldLeftPatternLength - 1;
<a name="l00523"></a>00523       myNextBefore = myPatternEnd - myOldSuffixLength;
<a name="l00524"></a>00524       myNextAfter = myPatternBegin + myBerstelRightLength - 1;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     } <span class="keywordflow">else</span> {
<a name="l00527"></a>00527       <span class="comment">// Special case of slope 1/1 with no prefix read, only a trivial</span>
<a name="l00528"></a>00528       <span class="comment">// DSS remains.</span>
<a name="l00529"></a>00529       <span class="comment">//cout &lt;&lt; &quot;Case 7&quot; &lt;&lt; endl;</span>
<a name="l00530"></a>00530       myNextBefore = myNextAfter = myPatternEnd = myPatternBegin;
<a name="l00531"></a>00531       myLeftPatternLength = 0;
<a name="l00532"></a>00532     }
<a name="l00533"></a>00533   }
<a name="l00534"></a>00534   myLastPoint -= FreemanChainCode::displacement( getCode( myLastLetter ) );
<a name="l00535"></a>00535   --myLastLetter;
<a name="l00536"></a>00536   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 
<a name="l00543"></a>00543 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00544"></a>00544 <span class="keyword">inline</span>
<a name="l00545"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a9d295736e739692b226815a346d81858">00545</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::isValid</a>()<span class="keyword"> const</span>
<a name="l00546"></a>00546 <span class="keyword"></span>{
<a name="l00547"></a>00547   <span class="keywordflow">return</span> (
<a name="l00548"></a>00548       ( myFirstLetter  &lt;= myPatternBegin ) &amp;&amp;
<a name="l00549"></a>00549       ( myPatternBegin &lt;= myPatternEnd ) &amp;&amp;
<a name="l00550"></a>00550       ( myPatternEnd   &lt;= myLastLetter ) &amp;&amp; 
<a name="l00551"></a>00551       ( myNextBefore   &gt;= myPatternBegin ) &amp;&amp;
<a name="l00552"></a>00552       ( myNextBefore   &lt;= myPatternEnd ) &amp;&amp;
<a name="l00553"></a>00553       ( myNextAfter   &gt;= myPatternBegin ) &amp;&amp;
<a name="l00554"></a>00554       ( myNextAfter   &lt;= myPatternEnd ) &amp;&amp;
<a name="l00555"></a>00555       ( (myLeftPatternLength == 0 ) || 
<a name="l00556"></a>00556         (myLeftPatternLength &lt; mainPatternLength() ) ) );
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00560"></a>00560 <span class="comment">// Interface - public :</span>
<a name="l00561"></a>00561 
<a name="l00567"></a>00567 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00568"></a>00568 <span class="keyword">inline</span>
<a name="l00569"></a>00569 <span class="keywordtype">void</span>
<a name="l00570"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#abcd7697d77e28ad408bfeae73a316350">00570</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;T&gt;::selfDisplay</a> ( std::ostream &amp; out )<span class="keyword"> const</span>
<a name="l00571"></a>00571 <span class="keyword"></span>{
<a name="l00572"></a>00572   std::string s;
<a name="l00573"></a>00573   s += myFC-&gt;chain[myFirstLetter-1]; 
<a name="l00574"></a>00574   s += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00575"></a>00575   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=myFirstLetter; i&lt;= myLastLetter; i++) 
<a name="l00576"></a>00576     s += myFC-&gt;chain[i];
<a name="l00577"></a>00577   s += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00578"></a>00578   s += myFC-&gt;chain[myLastLetter+1];
<a name="l00579"></a>00579   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">Integer</a> a,b,mu,omega;
<a name="l00580"></a>00580   getArithmeticalDescription(a,b,mu,omega);
<a name="l00581"></a>00581   out &lt;&lt; <span class="stringliteral">&quot;[CombinatorialDSS]\n&quot;</span>;
<a name="l00582"></a>00582   out &lt;&lt; <span class="stringliteral">&quot;myFC                = &quot;</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00583"></a>00583   out &lt;&lt; <span class="stringliteral">&quot;myFirstPoint        = &quot;</span> &lt;&lt; myFirstPoint &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00584"></a>00584   out &lt;&lt; <span class="stringliteral">&quot;myLastPoint         = &quot;</span> &lt;&lt; myLastPoint &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00585"></a>00585   out &lt;&lt; <span class="stringliteral">&quot;myFirstLetter       = &quot;</span> &lt;&lt; myFirstLetter &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00586"></a>00586   out &lt;&lt; <span class="stringliteral">&quot;myLastLetter        = &quot;</span> &lt;&lt; myLastLetter &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00587"></a>00587   out &lt;&lt; <span class="stringliteral">&quot;myNbRepeat          = &quot;</span> &lt;&lt; myNbRepeat &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00588"></a>00588   out &lt;&lt; <span class="stringliteral">&quot;myPatternBegin      = &quot;</span> &lt;&lt; myPatternBegin  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00589"></a>00589   out &lt;&lt; <span class="stringliteral">&quot;myPatternEnd        = &quot;</span> &lt;&lt; myPatternEnd &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00590"></a>00590   out &lt;&lt; <span class="stringliteral">&quot;myLeftPatternLength = &quot;</span> &lt;&lt; myLeftPatternLength &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00591"></a>00591   out &lt;&lt; <span class="stringliteral">&quot;myNextBefore        = &quot;</span> &lt;&lt; myNextBefore &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00592"></a>00592   out &lt;&lt; <span class="stringliteral">&quot;myNextAfter         = &quot;</span> &lt;&lt; myNextAfter &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00593"></a>00593   out &lt;&lt; <span class="stringliteral">&quot;(a,b,mu,omega)      = (&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; mu &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;
<a name="l00594"></a>00594     omega &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>; 
<a name="l00595"></a>00595   out &lt;&lt; <span class="stringliteral">&quot;[End CombinatorialDSS]&quot;</span> &lt;&lt; endl;
<a name="l00596"></a>00596 }
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 
<a name="l00603"></a>00603 <span class="comment">// Implementation of inline functions                                        //</span>
<a name="l00604"></a>00604 
<a name="l00605"></a>00605 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00606"></a>00606 <span class="keyword">inline</span>
<a name="l00607"></a>00607 std::ostream&amp;
<a name="l00608"></a><a class="code" href="namespaceDGtal.html#ab1e154c5c6b8bf237661f55811b280ce">00608</a> <a class="code" href="namespaceDGtal.html#ac4d5198d8a044649b47cf6ccecf43549">DGtal::operator&lt;&lt; </a>( std::ostream &amp; out, 
<a name="l00609"></a>00609       <span class="keyword">const</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">CombinatorialDSS&lt;T&gt;</a> &amp; <span class="keywordtype">object</span> )
<a name="l00610"></a>00610 {
<a name="l00611"></a>00611   <span class="keywordtype">object</span>.selfDisplay( out );
<a name="l00612"></a>00612   <span class="keywordflow">return</span> out;
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 
<a name="l00619"></a>00619 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00620"></a>00620 <span class="keyword">inline</span>
<a name="l00621"></a>00621 <span class="comment">//DGtal::CombinatorialDSS&lt;TInteger&gt;::Code </span>
<a name="l00622"></a>00622 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad2c4ec6496036af1074bd76797bb7971">DGtal::CombinatorialDSS&lt;TInteger&gt;::Code</a>
<a name="l00623"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#aa47def57cbf7538ffa4cd11a2af0002a">00623</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getSmallLetter</a>()<span class="keyword"> const</span>
<a name="l00624"></a>00624 <span class="keyword"></span>{
<a name="l00625"></a>00625   <span class="keywordflow">return</span> getCode( myPatternBegin );
<a name="l00626"></a>00626 }
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 
<a name="l00632"></a>00632 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00633"></a>00633 <span class="keyword">inline</span>
<a name="l00634"></a>00634 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad2c4ec6496036af1074bd76797bb7971">DGtal::CombinatorialDSS&lt;TInteger&gt;::Code</a>
<a name="l00635"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a3fce44d5b19283c46c75e4e158a61bf8">00635</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getBigLetter</a>()<span class="keyword"> const</span>
<a name="l00636"></a>00636 <span class="keyword"></span>{
<a name="l00637"></a>00637   <span class="keywordflow">return</span> getCode( myPatternEnd );
<a name="l00638"></a>00638 }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 <span class="comment">/*</span>
<a name="l00642"></a>00642 <span class="comment"> * @param a position in the FreemanChain</span>
<a name="l00643"></a>00643 <span class="comment"> * @returns the letter at the given position</span>
<a name="l00644"></a>00644 <span class="comment"> */</span>
<a name="l00645"></a>00645 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00646"></a>00646 <span class="keyword">inline</span>
<a name="l00647"></a>00647 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad2c4ec6496036af1074bd76797bb7971">DGtal::CombinatorialDSS&lt;TInteger&gt;::Code</a>
<a name="l00648"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a90f63be2eae0b3ef3f3bde5891f589a2">00648</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getCode</a>(<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a> pos)<span class="keyword"> const</span>
<a name="l00649"></a>00649 <span class="keyword"></span>{
<a name="l00650"></a>00650   <span class="keywordtype">int</span> fcSize = (int) myFC-&gt;size();
<a name="l00651"></a>00651   <span class="keywordflow">if</span> ( pos &lt; 0 ) 
<a name="l00652"></a>00652     pos += ( -(pos / fcSize) + 1) * fcSize;
<a name="l00653"></a>00653   <span class="keywordflow">if</span> ( pos &gt;= fcSize ) 
<a name="l00654"></a>00654     pos -= ( pos / fcSize) * fcSize;
<a name="l00655"></a>00655   <span class="keywordflow">return</span> myFC-&gt;code(pos);
<a name="l00656"></a>00656 }
<a name="l00657"></a>00657 
<a name="l00658"></a>00658 
<a name="l00663"></a>00663 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00664"></a>00664 <span class="keyword">inline</span>
<a name="l00665"></a>00665 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">DGtal::CombinatorialDSS&lt;TInteger&gt;::Size</a>
<a name="l00666"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a803a4b1d409b8d4c2a9078f4a9237a86">00666</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::mainPatternLength</a>()<span class="keyword"> const</span>
<a name="l00667"></a>00667 <span class="keyword"></span>{
<a name="l00668"></a>00668   <span class="keywordflow">return</span> myPatternEnd - myPatternBegin + 1;
<a name="l00669"></a>00669 }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671 
<a name="l00675"></a>00675 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00676"></a>00676 <span class="keyword">inline</span>
<a name="l00677"></a>00677 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">DGtal::CombinatorialDSS&lt;TInteger&gt;::Size</a>
<a name="l00678"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#abe84f4f6f80f26d7a24a1ad6d02eb146">00678</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::suffixLength</a>()<span class="keyword"> const</span>
<a name="l00679"></a>00679 <span class="keyword"></span>{
<a name="l00680"></a>00680   <span class="keywordflow">return</span> ( myPatternEnd - myNextBefore );
<a name="l00681"></a>00681 }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683 
<a name="l00687"></a>00687 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00688"></a>00688 <span class="keyword">inline</span>
<a name="l00689"></a>00689 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">DGtal::CombinatorialDSS&lt;TInteger&gt;::Size</a>
<a name="l00690"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a421b467e87e8dce6f930eb50ab4c851c">00690</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::prefixLength</a>()<span class="keyword"> const</span>
<a name="l00691"></a>00691 <span class="keyword"></span>{
<a name="l00692"></a>00692   <span class="keywordflow">return</span> ( myNextAfter - myPatternBegin );
<a name="l00693"></a>00693 }
<a name="l00694"></a>00694 
<a name="l00700"></a>00700 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00701"></a>00701 <span class="keyword">inline</span>
<a name="l00702"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a35d46492189198fbc823892d7151b137">00702</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::isUL</a> ( <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a> pos )<span class="keyword"> const</span>
<a name="l00703"></a>00703 <span class="keyword"></span>{
<a name="l00704"></a>00704   <span class="comment">//cout &lt;&lt; &quot;isUL(&quot; &lt;&lt; pos &lt;&lt; &quot;) = &quot; &lt;&lt; ( ( pos == myPatternBegin ) || ( pos == myPatternEnd ) ) &lt;&lt; endl;</span>
<a name="l00705"></a>00705   <span class="keywordflow">return</span> ( ( pos == myPatternBegin ) || ( pos == myPatternEnd ) );
<a name="l00706"></a>00706 }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 
<a name="l00709"></a>00709 
<a name="l00715"></a>00715 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00716"></a>00716 <span class="keyword">inline</span>
<a name="l00717"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a80ff59e79e413fedefbb63f339d1bda2">00717</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::nextIsLL</a> ( <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a> pos )<span class="keyword"> const</span>
<a name="l00718"></a>00718 <span class="keyword"></span>{
<a name="l00719"></a>00719   <span class="comment">//cout &lt;&lt; &quot;nextIsLL(&quot; &lt;&lt; pos &lt;&lt; &quot;) = &quot; &lt;&lt; ( (pos - myPatternBegin) == mainPatternLength() - myLeftPatternLength - 1)   &lt;&lt; endl;</span>
<a name="l00720"></a>00720   <span class="keywordflow">return</span> ( (pos - myPatternBegin) == mainPatternLength() - myLeftPatternLength - 1) ;
<a name="l00721"></a>00721 }
<a name="l00722"></a>00722 
<a name="l00728"></a>00728 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00729"></a>00729 <span class="keyword">inline</span>
<a name="l00730"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a28f8a259e8e442cfbebaa5190875594a">00730</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::previousIsLL</a> ( <a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a> pos )<span class="keyword"> const</span>
<a name="l00731"></a>00731 <span class="keyword"></span>{
<a name="l00732"></a>00732   <span class="comment">//cout &lt;&lt; &quot;previousIsLL(&quot; &lt;&lt; pos &lt;&lt; &quot;) = &quot; &lt;&lt; ( (pos - myPatternBegin) == mainPatternLength() - myLeftPatternLength )   &lt;&lt; endl;</span>
<a name="l00733"></a>00733   <span class="keywordflow">return</span> ( (pos - myPatternBegin) == mainPatternLength() - myLeftPatternLength ) ;
<a name="l00734"></a>00734 }
<a name="l00735"></a>00735 
<a name="l00736"></a>00736 
<a name="l00740"></a>00740 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00741"></a>00741 <span class="keyword">inline</span>
<a name="l00742"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#adde158b6f4d5e64ba72914383e786b1c">00742</a> <span class="keywordtype">bool</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::isTrivial</a>()<span class="keyword"> const</span>
<a name="l00743"></a>00743 <span class="keyword"></span>{
<a name="l00744"></a>00744   <span class="comment">// If there is no left subpattern, then the DSS is trivial.</span>
<a name="l00745"></a>00745   <span class="keywordflow">return</span> ( myLeftPatternLength == 0 );
<a name="l00746"></a>00746 }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748 
<a name="l00749"></a>00749 
<a name="l00753"></a>00753 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00754"></a>00754 <span class="keyword">inline</span>
<a name="l00755"></a>00755 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::ConstIterator</a> 
<a name="l00756"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#ac24efeb274d089a8bfbf1e9130d09da4">00756</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::begin</a>()<span class="keyword"> const</span>
<a name="l00757"></a>00757 <span class="keyword"></span>{
<a name="l00758"></a>00758   <span class="keywordflow">return</span> <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a> ( *myFC, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) myFirstLetter, myFirstPoint );
<a name="l00759"></a>00759 }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 
<a name="l00765"></a>00765 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00766"></a>00766 <span class="keyword">inline</span>
<a name="l00767"></a>00767 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::ConstIterator</a> 
<a name="l00768"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#af3fb832bc4c0d981a3f5e6c8c54e0f4a">00768</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::end</a>()<span class="keyword"> const</span>
<a name="l00769"></a>00769 <span class="keyword"></span>{
<a name="l00770"></a>00770   <span class="keywordflow">return</span> <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a> ( *myFC, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) myLastLetter+1, myLastPoint );
<a name="l00771"></a>00771 }
<a name="l00772"></a>00772 
<a name="l00773"></a>00773 
<a name="l00777"></a>00777 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00778"></a>00778 <span class="keyword">inline</span>
<a name="l00779"></a>00779 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">DGtal::CombinatorialDSS&lt;TInteger&gt;::Integer</a>
<a name="l00780"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a9e66f1be76b26aff2afe1c654f4ae140">00780</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getA</a>()<span class="keyword"> const</span>
<a name="l00781"></a>00781 <span class="keyword"></span>{ }
<a name="l00782"></a>00782 
<a name="l00786"></a>00786 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00787"></a>00787 <span class="keyword">inline</span>
<a name="l00788"></a>00788 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">DGtal::CombinatorialDSS&lt;TInteger&gt;::Integer</a>
<a name="l00789"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a7a9e391dd1d60c66be6cab0667879ed3">00789</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getB</a>()<span class="keyword"> const</span>
<a name="l00790"></a>00790 <span class="keyword"></span>{ }
<a name="l00791"></a>00791   
<a name="l00792"></a>00792 
<a name="l00793"></a>00793 
<a name="l00797"></a>00797 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00798"></a>00798 <span class="keyword">inline</span>
<a name="l00799"></a>00799 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">DGtal::CombinatorialDSS&lt;TInteger&gt;::Integer</a>
<a name="l00800"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#aa1fbee63861c565ec4152053e331ead7">00800</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getMu</a>()<span class="keyword"> const</span>
<a name="l00801"></a>00801 <span class="keyword"></span>{}
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 
<a name="l00807"></a>00807 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00808"></a>00808 <span class="keyword">inline</span>
<a name="l00809"></a>00809 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">DGtal::CombinatorialDSS&lt;TInteger&gt;::Integer</a>
<a name="l00810"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a337068166c36ba2565d30e19e508b6db">00810</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getOmega</a>()<span class="keyword"> const</span>
<a name="l00811"></a>00811 <span class="keyword"></span>{}
<a name="l00812"></a>00812 
<a name="l00813"></a>00813 
<a name="l00817"></a>00817 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00818"></a>00818 <span class="keyword">inline</span>
<a name="l00819"></a>00819 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1PointVector.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::Point</a> 
<a name="l00820"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a3ce7301972d6569000d9e189632f0dc7">00820</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getUf</a>()<span class="keyword"> const</span>
<a name="l00821"></a>00821 <span class="keyword"></span>{
<a name="l00822"></a>00822 }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824 
<a name="l00831"></a>00831 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00832"></a>00832 <span class="keyword">inline</span>
<a name="l00833"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#ab1f9691c5b27dc22263e76d52e68252c">00833</a> <span class="keywordtype">void</span> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getArithmeticalDescription</a>(
<a name="l00834"></a>00834     <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">Integer</a> &amp;a, <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">Integer</a> &amp;b, <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">Integer</a> &amp;mu, <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">Integer</a> &amp;omega )<span class="keyword"> const</span>
<a name="l00835"></a>00835 <span class="keyword"></span>{
<a name="l00836"></a>00836   <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a> itBegin = begin();
<a name="l00837"></a>00837   <span class="keywordflow">while</span> ( (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a>) itBegin.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#afb37fdda225086c779e51ed44ab267f5">getPosition</a>() != myPatternBegin ) itBegin++;
<a name="l00838"></a>00838   <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a> itEnd = end();
<a name="l00839"></a>00839   <span class="keywordflow">while</span> ( (<a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad96b49f9c20e7c12c7989799a9b930f9">Index</a>) itEnd.<a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html#afb37fdda225086c779e51ed44ab267f5">getPosition</a>() != myPatternEnd+1 ) itEnd--;
<a name="l00840"></a>00840 
<a name="l00841"></a>00841   <a class="code" href="classDGtal_1_1FreemanChain_1_1ConstIterator.html">ConstIterator</a> it;
<a name="l00842"></a>00842   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a1868c42f6dd5bf745066076715e8cf88">Size</a> myRightPatternLenght = mainPatternLength() - myLeftPatternLength;
<a name="l00843"></a>00843   <span class="comment">//if ( myLeftPatternLength &gt; myRightPatternLenght ) {</span>
<a name="l00844"></a>00844     it = itBegin;
<a name="l00845"></a>00845     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;myRightPatternLenght; i++)
<a name="l00846"></a>00846       it++;
<a name="l00847"></a>00847   <span class="comment">//} else {</span>
<a name="l00848"></a>00848   <span class="comment">//  it = itEnd;</span>
<a name="l00849"></a>00849   <span class="comment">//  for (int i=0; i&lt;myLeftPatternLength; i++)</span>
<a name="l00850"></a>00850   <span class="comment">//    it--;</span>
<a name="l00851"></a>00851   <span class="comment">//}</span>
<a name="l00852"></a>00852   <a class="code" href="classDGtal_1_1PointVector.html">Point</a> pb = *itBegin;
<a name="l00853"></a>00853   <a class="code" href="classDGtal_1_1PointVector.html">Point</a> pe = *itEnd;
<a name="l00854"></a>00854   <a class="code" href="classDGtal_1_1PointVector.html">Point</a> po = *it;
<a name="l00855"></a>00855 
<a name="l00856"></a>00856   <a class="code" href="classDGtal_1_1PointVector.html">Vector</a> v = pe - pb;
<a name="l00857"></a>00857   a = v.<a class="code" href="classDGtal_1_1PointVector.html#ae5db687fb6d7615892e70a5cd4dfab66">at</a>(1);
<a name="l00858"></a>00858   b = v.<a class="code" href="classDGtal_1_1PointVector.html#ae5db687fb6d7615892e70a5cd4dfab66">at</a>(0);
<a name="l00859"></a>00859   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">Integer</a> r1 = a*pb.at(0) - b*pb.at(1);
<a name="l00860"></a>00860   <a class="code" href="classDGtal_1_1CombinatorialDSS.html#a58df1cd1497d1f641b229e12647b5e9d">Integer</a> r2 = a*po.<a class="code" href="classDGtal_1_1PointVector.html#ae5db687fb6d7615892e70a5cd4dfab66">at</a>(0) - b*po.<a class="code" href="classDGtal_1_1PointVector.html#ae5db687fb6d7615892e70a5cd4dfab66">at</a>(1);
<a name="l00861"></a>00861   mu = <a class="code" href="namespaceDGtal.html#a5bf1970623d249f257d90c2f0005e4cd">min</a> (r1, r2);
<a name="l00862"></a>00862   omega = ((a&gt;0) ? a : -a) + ((b&gt;0) ? b : -b );
<a name="l00863"></a>00863 }
<a name="l00864"></a>00864 
<a name="l00865"></a>00865 
<a name="l00869"></a>00869 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00870"></a>00870 <span class="keyword">inline</span>
<a name="l00871"></a>00871 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1PointVector.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::Point</a> 
<a name="l00872"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a7149d357a235fb023dddcb0ac0b8dde7">00872</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getUl</a>()<span class="keyword"> const</span>
<a name="l00873"></a>00873 <span class="keyword"></span>{}
<a name="l00874"></a>00874 
<a name="l00875"></a>00875 
<a name="l00879"></a>00879 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00880"></a>00880 <span class="keyword">inline</span>
<a name="l00881"></a>00881 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1PointVector.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::Point</a> 
<a name="l00882"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a427bab8d9396a0c20c6428f1cd05b15a">00882</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getLf</a>()<span class="keyword"> const</span>
<a name="l00883"></a>00883 <span class="keyword"></span>{}
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 
<a name="l00889"></a>00889 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00890"></a>00890 <span class="keyword">inline</span>
<a name="l00891"></a>00891 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1PointVector.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::Point</a> 
<a name="l00892"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#ad6dada1fbf2518616e503ab7992ab77b">00892</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getLl</a>()<span class="keyword"> const</span>
<a name="l00893"></a>00893 <span class="keyword"></span>{}
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 
<a name="l00896"></a>00896 
<a name="l00897"></a>00897 <span class="comment">//                                                                           //</span>
<a name="l00899"></a>00899 <span class="comment"></span>
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 <span class="comment">// ----------------------- Accessors --------------------------------------</span>
<a name="l00902"></a>00902 
<a name="l00903"></a>00903 
<a name="l00908"></a>00908 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00909"></a>00909 <span class="keyword">inline</span>
<a name="l00910"></a>00910 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1PointVector.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::Point</a> 
<a name="l00911"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a8c6a9a055bc32ea995b07e708ea0d0eb">00911</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getFirstPoint</a>()<span class="keyword"> const</span>
<a name="l00912"></a>00912 <span class="keyword"></span>{
<a name="l00913"></a>00913   <span class="keywordflow">return</span> myFirstPoint;
<a name="l00914"></a>00914 }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916 
<a name="l00921"></a>00921 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TInteger&gt;
<a name="l00922"></a>00922 <span class="keyword">inline</span>
<a name="l00923"></a>00923 <span class="keyword">typename</span> <a class="code" href="classDGtal_1_1PointVector.html">DGtal::CombinatorialDSS&lt;TInteger&gt;::Point</a> 
<a name="l00924"></a><a class="code" href="classDGtal_1_1CombinatorialDSS.html#a2fee33aa86c0e123a7eb2a5a7c5a428a">00924</a> <a class="code" href="classDGtal_1_1CombinatorialDSS.html" title="Aim:">DGtal::CombinatorialDSS&lt;TInteger&gt;::getLastPoint</a>()<span class="keyword"> const</span>
<a name="l00925"></a>00925 <span class="keyword"></span>{
<a name="l00926"></a>00926   <span class="keywordflow">return</span> myLastPoint;
<a name="l00927"></a>00927 }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929 
<a name="l00930"></a>00930 
<a name="l00947"></a>00947 <span class="comment">//template &lt;typename TInteger&gt;</span>
<a name="l00948"></a>00948 <span class="comment">//bool </span>
<a name="l00949"></a>00949 <span class="comment">//CombinatorialDSS&lt;TInteger&gt;::longestChristoffelPrefix(</span>
<a name="l00950"></a>00950 <span class="comment">//    Iterator it,</span>
<a name="l00951"></a>00951 <span class="comment">//    const OrderedAlphabet &amp; aAlph)</span>
<a name="l00952"></a>00952 <span class="comment">//{</span>
<a name="l00953"></a>00953 <span class="comment">//  OrderedAlphabet::Size nb;</span>
<a name="l00954"></a>00954 <span class="comment">//  OrderedAlphabet::Size len;</span>
<a name="l00955"></a>00955 <span class="comment">//  OrderedAlphabet::Index e = it.getChain()-&gt;end().getPosition();</span>
<a name="l00956"></a>00956 <span class="comment">//  unsigned int a,b;</span>
<a name="l00957"></a>00957 <span class="comment">//  unsigned int lf1, lf2;</span>
<a name="l00958"></a>00958 <span class="comment">//  bool cvx = aAlph.duvalPPtoDSS(len, nb, a, b, lf1, lf2, </span>
<a name="l00959"></a>00959 <span class="comment">//      it.getChain()-&gt;chain, it.getPosition(), e);</span>
<a name="l00960"></a>00960 <span class="comment">//</span>
<a name="l00961"></a>00961 <span class="comment">//  len *= nb;</span>
<a name="l00962"></a>00962 <span class="comment">//  Vector direction1 = FreemanChainCode::displacement(aAlph.letter(1) - &#39;0&#39;);</span>
<a name="l00963"></a>00963 <span class="comment">//  Vector direction2 = FreemanChainCode::displacement(aAlph.letter(2) - &#39;0&#39;);</span>
<a name="l00964"></a>00964 <span class="comment">//  Vector basicMove = ( direction1 * (Integer) a ) + (direction2 * (Integer) b );</span>
<a name="l00965"></a>00965 <span class="comment">//  bool trivial = (a == 0 || b == 0);</span>
<a name="l00966"></a>00966 <span class="comment">//</span>
<a name="l00967"></a>00967 <span class="comment">//  this-&gt;myA        = basicMove[1];</span>
<a name="l00968"></a>00968 <span class="comment">//  this-&gt;myB        = basicMove[0];</span>
<a name="l00969"></a>00969 <span class="comment">//  this-&gt;myNbUpPat  = (Integer) nb;</span>
<a name="l00970"></a>00970 <span class="comment">//  this-&gt;myNbLowPat = (trivial) ? this-&gt;myNbUpPat : this-&gt;myNbUpPat - 1;</span>
<a name="l00971"></a>00971 <span class="comment">//  this-&gt;myUf       = it.get();</span>
<a name="l00972"></a>00972 <span class="comment">//  this-&gt;myUl       = this-&gt;myUf + basicMove*nb;</span>
<a name="l00973"></a>00973 <span class="comment">//  this-&gt;myLf       = (trivial) ? </span>
<a name="l00974"></a>00974 <span class="comment">//    this-&gt;myUf : </span>
<a name="l00975"></a>00975 <span class="comment">//    this-&gt;myUf + ( direction1*(Integer)lf1 ) + (direction2*(Integer)lf2 );</span>
<a name="l00976"></a>00976 <span class="comment">//  this-&gt;myLl       = (trivial) ? this-&gt;myLf + basicMove*nb :</span>
<a name="l00977"></a>00977 <span class="comment">//                                 this-&gt;myLf + basicMove*(nb-1);</span>
<a name="l00978"></a>00978 <span class="comment">//  this-&gt;myMu       = this-&gt;myA*this-&gt;myUf[0] - this-&gt;myB*this-&gt;myUf[1];</span>
<a name="l00979"></a>00979 <span class="comment">//  this-&gt;myOmega    = DSS::template Tools&lt;Integer,4&gt;::norm(this-&gt;myA,this-&gt;myB);</span>
<a name="l00980"></a>00980 <span class="comment">//  this-&gt;myF        = it;</span>
<a name="l00981"></a>00981 <span class="comment">//  this-&gt;myL        = Iterator(*it.getChain(), it.getPosition() + len, this-&gt;myUl);</span>
<a name="l00982"></a>00982 <span class="comment">//  this-&gt;mySteps.clear();</span>
<a name="l00983"></a>00983 <span class="comment">//  if (a != 0) </span>
<a name="l00984"></a>00984 <span class="comment">//    this-&gt;mySteps.push_back(direction1);</span>
<a name="l00985"></a>00985 <span class="comment">//  if (b != 0) </span>
<a name="l00986"></a>00986 <span class="comment">//    this-&gt;mySteps.push_back(direction2);</span>
<a name="l00987"></a>00987 <span class="comment">//  return cvx;</span>
<a name="l00988"></a>00988 <span class="comment">//}</span>
<a name="l00989"></a>00989 
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Sep 27 2011 10:27:00 for DGtal by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
