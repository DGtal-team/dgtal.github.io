<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DGtal: Helmoltz decomposition</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-blue.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Helmoltz decomposition </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sectDECHelmoltzProblem">Helmoltz decomposition</a></li>
<li class="level1"><a href="#sectDECHelmoltz2D">2D Helmoltz decomposition</a></li>
<li class="level1"><a href="#sectDECHelmoltz3D">3D Helmoltz decomposition</a></li>
</ul>
</div>
<div class="textblock"><dl class="section user"><dt>Author(s) of this documentation: </dt><dd>Pierre Gueth</dd></dl>
<h1><a class="anchor" id="sectDECHelmoltzProblem"></a>
Helmoltz decomposition</h1>
<p>Helmoltz decomposition states that any 1-form \(\omega\) can be uniquely expressed as the sum of three terms.</p>
<p class="formulaDsp">
\[ \omega = d\alpha + \delta\beta + \gamma \]
</p>
<p>where \(d\) is the exterior derivative from 0-form to 1-form and \(\delta = \star d \star \) is the exterior antiderivative from 2-form to 1-form. \(\alpha\) is a 0-form scalar potential and \(d\alpha\) is the curl free term.</p>
<p class="formulaDsp">
\[ \nabla \wedge (d \alpha) = ( \star d d \alpha )^\sharp = 0 \]
</p>
<p>\(\beta\) is a 2-form vector potential and \(\delta\beta\) is the divergence free term.</p>
<p class="formulaDsp">
\[ \nabla \cdot (\delta \beta) = \star d \star \delta \beta = \delta \delta \beta = 0 \]
</p>
<p>The remaining part \(\gamma\) is the 1-form harmonic part. \(\gamma\) has null antiderivative and null derivative since if they were not null, they would be part of \(d\alpha\) and \(\delta\beta\).</p>
<p class="formulaDsp">
\[ \delta \gamma = d \gamma = 0 \]
</p>
<p>By differentiating \(\omega\), one can isolate DEC solvable expressions for \(\alpha\) and \(\beta\).</p>
<p class="formulaDsp">
\[ d \delta \beta = d \omega \]
</p>
 <p class="formulaDsp">
\[ \delta \omega = \delta d \alpha \]
</p>
<p>The harmonic component \(\gamma\) is computed by subtracting \(d\alpha\) and \(\delta\beta\) from \(\omega\). The interest of the Helmoltz decomposition is that \(\gamma\) has a strong connection with the topology of the structure.</p>
<h1><a class="anchor" id="sectDECHelmoltz2D"></a>
2D Helmoltz decomposition</h1>
<p>In this example, we compute primal and dual Helmoltz decomposition of an arbitrary vector field on a 2D double ring shape. Snippets are taken from <a class="el" href="exampleDiscreteExteriorCalculusSolve_8cpp_source.html">exampleDiscreteExteriorCalculusSolve.cpp</a>.</p>
<p>Here is the definition of objects used during the primal decomposition.</p>
<div class="fragment"><div class="line">    Calculus::PrimalVectorField input_vector_field(calculus);</div>
<div class="line">    <span class="keywordflow">for</span> (Calculus::Index ii=0; ii&lt;input_vector_field.length(); ii++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a> cell_center = <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a>(input_vector_field.getSCell(ii).preCell().coordinates)/2.;</div>
<div class="line">        input_vector_field.myCoordinates(ii, 0) = cos(-.5*cell_center[0]+ .3*cell_center[1]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 1) = cos(.4*cell_center[0]+ .8*cell_center[1]);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; input_vector_field &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 input_one_form = calculus.flat(input_vector_field);</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm0 input_one_form_anti_derivated = ad1 * input_one_form;</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm2 input_one_form_derivated = d1 * input_one_form;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_calculus.png" alt=""/>
<div class="caption">
Primal Helmoltz decomposition. Primal input vector field and 1-form.</div></div>
<p>And here are very similar objects used during the dual decomposition.</p>
<div class="fragment"><div class="line">    Calculus::DualVectorField input_vector_field(calculus);</div>
<div class="line">    <span class="keywordflow">for</span> (Calculus::Index ii=0; ii&lt;input_vector_field.length(); ii++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a> cell_center = <a class="code" href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">Z2i::RealPoint</a>(input_vector_field.getSCell(ii).preCell().coordinates)/2.;</div>
<div class="line">        input_vector_field.myCoordinates(ii, 0) = cos(-.5*cell_center[0]+ .3*cell_center[1]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 1) = cos(.4*cell_center[0]+ .8*cell_center[1]);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; input_vector_field &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> Calculus::DualForm1 input_one_form = calculus.flat(input_vector_field);</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualForm0 input_one_form_anti_derivated = ad1 * input_one_form;</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualForm2 input_one_form_derivated = d1 * input_one_form;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_calculus.png" alt=""/>
<div class="caption">
Dual Helmoltz decomposition. Dual input vector field and 1-form.</div></div>
<p>Definition of useful operators for primal decomposition.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative1 d1 = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative0 d0p = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative1 d1p = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge1 h1 = calculus.hodge&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge2 h2 = calculus.hodge&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge1 h1p = calculus.hodge&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge2 h2p = calculus.hodge&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 1, PRIMAL, 0, PRIMAL&gt; ad1 = h2p * d1p * h1;</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 2, PRIMAL, 1, PRIMAL&gt; ad2 = h1p * d0p * h2;</div>
</div><!-- fragment --><p> Definition of useful operators for dual decomposition.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::DualDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative1 d1 = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative0 d0p = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative1 d1p = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge1 h1 = calculus.hodge&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge2 h2 = calculus.hodge&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge1 h1p = calculus.hodge&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge2 h2p = calculus.hodge&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 1, DUAL, 0, DUAL&gt; ad1 = h2p * d1p * h1;</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 2, DUAL, 1, DUAL&gt; ad2 = h1p * d0p * h2;</div>
</div><!-- fragment --><p> Resolution of the curl-free component \(d\alpha\) for primal decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, PRIMAL, 0, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(ad1 * d0);</div>
<div class="line">        solution_curl_free = solver.solve(input_one_form_anti_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_curl_free.png" alt=""/>
<div class="caption">
Primal Helmoltz decomposition curl-free component and scalar potential field.</div></div>
<p>Resolution of the curl-free component \(d\alpha\) for dual decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, DUAL, 0, DUAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(ad1 * d0);</div>
<div class="line">        solution_curl_free = solver.solve(input_one_form_anti_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_curl_free.png" alt=""/>
<div class="caption">
Dual Helmoltz decomposition curl-free component and scalar potential field.</div></div>
<p>Resolution of the div-free component \(\delta\beta\) for primal decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 2, PRIMAL, 2, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(d1 * ad2);</div>
<div class="line">        solution_div_free = solver.solve(input_one_form_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_div_free.png" alt=""/>
<div class="caption">
Primal Helmoltz decomposition divergence-free component and vector potential field.</div></div>
<p>Resolution of the div-free component \(\delta\beta\) for dual decomposition.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 2, DUAL, 2, DUAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(d1 * ad2);</div>
<div class="line">        solution_div_free = solver.solve(input_one_form_derivated);</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_div_free.png" alt=""/>
<div class="caption">
Dual Helmoltz decomposition divergence-free component and vector potential field.</div></div>
<p>Computation of the primal harmonic component \(\omega\).</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 solution_harmonic = input_one_form - d0*solution_curl_free - ad2*solution_div_free;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_primal_decomposition_harmonic.png" alt=""/>
<div class="caption">
Primal Helmoltz decomposition harmonic component.</div></div>
<p>Computation of the dual harmonic component \(\omega\).</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::DualForm1 solution_harmonic = input_one_form - d0*solution_curl_free - ad2*solution_div_free;</div>
</div><!-- fragment --><div class="image">
<img src="solve_2d_dual_decomposition_harmonic.png" alt=""/>
<div class="caption">
Dual Helmoltz decomposition harmonic component.</div></div>
<h1><a class="anchor" id="sectDECHelmoltz3D"></a>
3D Helmoltz decomposition</h1>
<p>In this example, we show how to compute the Helmoltz decomposition of a primal vector field defined on a 2D toroidal surface embedded in 3D. Snippets are taken from <a class="el" href="exampleDiscreteExteriorCalculusSolve_8cpp_source.html">exampleDiscreteExteriorCalculusSolve.cpp</a>.</p>
<p>First the calculus structure is filled manually with 0-, 1- and 2-cells to create a torus structure.</p>
<div class="fragment"><div class="line">    <span class="comment">// create discrete exterior calculus from set</span></div>
<div class="line">    <span class="keyword">typedef</span> DiscreteExteriorCalculus&lt;3, 3, EigenLinearAlgebraBackend&gt; Calculus;</div>
<div class="line">    Calculus calculus;</div>
<div class="line">    calculus.initKSpace&lt;<a class="code" href="namespaceDGtal_1_1Z3i.html#a39a69f8da09f1094df563ca067927c61">Z3i::Domain</a>&gt;(<a class="code" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// outer ring</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=2; kk&lt;=18; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=4; ll&lt;=36; ll++)</div>
<div class="line">        {</div>
<div class="line">            { <span class="comment">// bottom</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,4,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// top</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,36,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// left</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(4,ll,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = ( *calculus.myKSpace.uDirs(cell) == 2 ? Calculus::KSpace::NEG : Calculus::KSpace::POS );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// right</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(36,ll,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = ( *calculus.myKSpace.uDirs(cell) == 2 ? Calculus::KSpace::POS : Calculus::KSpace::NEG );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// inner ring</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=2; kk&lt;=18; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=16; ll&lt;=24; ll++)</div>
<div class="line">        {</div>
<div class="line">            { <span class="comment">// bottom</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,16,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = ( *calculus.myKSpace.uDirs(cell) == 0 ? Calculus::KSpace::NEG : Calculus::KSpace::POS );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// top</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,24,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = ( *calculus.myKSpace.uDirs(cell) == 0 ? Calculus::KSpace::POS : Calculus::KSpace::NEG );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// left</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(16,ll,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// right</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(24,ll,kk));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// back and front</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=4; kk&lt;=36; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=0; ll&lt;=12; ll++)</div>
<div class="line">        {</div>
<div class="line">            { <span class="comment">// back</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(4+ll,kk,2));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// front</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(4+ll,kk,18));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// back</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(24+ll,kk,2));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// front</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(24+ll,kk,18));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// back and front</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=0; kk&lt;=12; kk++)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=16; ll&lt;=24; ll++)</div>
<div class="line">        {</div>
<div class="line">            { <span class="comment">// back</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,4+kk,2));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// front</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,4+kk,18));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// back</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,24+kk,2));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            { <span class="comment">// front</span></div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Calculus::Cell</a> cell = calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">Z3i::Point</a>(ll,24+kk,18));</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> <a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a> = calculus.myKSpace.uDim(cell);</div>
<div class="line">                Calculus::KSpace::Sign sign = Calculus::KSpace::POS;</div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code" href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        sign = Calculus::KSpace::NEG;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        sign = Calculus::KSpace::POS;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                calculus.insertSCell( calculus.myKSpace.signs(cell, sign) );</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    calculus.updateIndexes();</div>
</div><!-- fragment --><p> The primal input vector field is then filled and the associated input 1-form is computed using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a36498d8bde9fe0a71a53ecb42caaa615">DiscreteExteriorCalculus.flat</a>.</p>
<div class="fragment"><div class="line">    Calculus::PrimalVectorField input_vector_field(calculus);</div>
<div class="line">    <span class="keywordflow">for</span> (Calculus::Index ii=0; ii&lt;input_vector_field.length(); ii++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceDGtal_1_1Z3i.html#a5f087066515ecd33cefd7bd080ef8114">Z3i::RealPoint</a> cell_center = <a class="code" href="namespaceDGtal_1_1Z3i.html#a5f087066515ecd33cefd7bd080ef8114">Z3i::RealPoint</a>(input_vector_field.getSCell(ii).preCell().coordinates)/2.;</div>
<div class="line">        input_vector_field.myCoordinates(ii, 0) = -cos(-.3*cell_center[0] + .6*cell_center[1] + .8*cell_center[2]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 1) = sin(.8*cell_center[0] + .3*cell_center[1] - .4*cell_center[2]);</div>
<div class="line">        input_vector_field.myCoordinates(ii, 2) = -cos(cell_center[2]*.5);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; input_vector_field &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 input_one_form = calculus.flat(input_vector_field);</div>
</div><!-- fragment --><p> Harmonic vector fields are aligned with natural map direction on the structure.</p>
<div class="image">
<img src="helmoltz_3d_structure.png" alt=""/>
<div class="caption">
Manually created tore structure and input vector field.</div></div>
<p>Linear operators are then defined. Note the expression of antiderivative computed from Hodge operators and dual exterior derivative.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative0 d0 = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalDerivative1 d1 = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative1 d1p = calculus.derivative&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualDerivative2 d2p = calculus.derivative&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge1 h1 = calculus.hodge&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::PrimalHodge2 h2 = calculus.hodge&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge2 h2p = calculus.hodge&lt;2, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> Calculus::DualHodge3 h3p = calculus.hodge&lt;3, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DUAL</a>&gt;();</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 1, PRIMAL, 0, PRIMAL&gt; ad1 = h3p * d2p * h1;</div>
<div class="line">    <span class="keyword">const</span> LinearOperator&lt;Calculus, 2, PRIMAL, 1, PRIMAL&gt; ad2 = h2p * d1p * h2;</div>
</div><!-- fragment --><p> Values of \(\alpha\) are computed from previous expression using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a7673281a29a04ef2978bad9b373c2382">DiscreteExteriorCalculusSolver.solve</a>.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 0, PRIMAL, 0, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(ad1 * d0);</div>
<div class="line">        solution_curl_free = solver.solve(input_one_form_anti_derivated);</div>
</div><!-- fragment --><p> Values of \(\beta\) are computed from previous expression using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a7673281a29a04ef2978bad9b373c2382">DiscreteExteriorCalculusSolver.solve</a>.</p>
<div class="fragment"><div class="line">        <span class="keyword">typedef</span> DiscreteExteriorCalculusSolver&lt;Calculus, LinearAlgebraSolver, 2, PRIMAL, 2, PRIMAL&gt; Solver;</div>
<div class="line">        Solver solver;</div>
<div class="line">        solver.compute(d1 * ad2);</div>
<div class="line">        solution_div_free = solver.solve(input_one_form_derivated);</div>
</div><!-- fragment --><p> Values of \(\gamma\) are computed by subtraction.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> Calculus::PrimalForm1 solution_harmonic = input_one_form - d0*solution_curl_free - ad2*solution_div_free;</div>
</div><!-- fragment --><p> \(\gamma\) has a strong connection with the structure topology and can be used to create local maps of the structure.</p>
<div class="image">
<img src="helmoltz_3d_harmonic.png" alt=""/>
<div class="caption">
Harmonic component of the input vector field.</div></div>
 <div class="image">
<img src="helmoltz_3d_harmonic_zoom0.png" alt=""/>
<div class="caption">
Harmonic component of the input vector field. Zoom on inner hole.</div></div>
 <div class="image">
<img src="helmoltz_3d_harmonic_zoom1.png" alt=""/>
<div class="caption">
Harmonic component of the input vector field. Zoom on outer shell.</div></div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="anamespaceDGtal_html_a8fc7012708b0416880a5c8b12dfdf9dd"><div class="ttname"><a href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">DGtal::trace</a></div><div class="ttdeci">Trace trace</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00150">Common.h:150</a></div></div>
<div class="ttc" id="anamespaceDGtal_html_a8fbe8c8d47ca5c36ced14284ac62613d"><div class="ttname"><a href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a></div><div class="ttdeci">DGtal::uint32_t Dimension</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00133">Common.h:133</a></div></div>
<div class="ttc" id="anamespaceDGtal_1_1Z3i_html_a8d69892de6b10119a8070bd5d0871bf5"><div class="ttname"><a href="namespaceDGtal_1_1Z3i.html#a8d69892de6b10119a8070bd5d0871bf5">DGtal::Z3i::Point</a></div><div class="ttdeci">Space::Point Point</div><div class="ttdef"><b>Definition:</b> <a href="StdDefs_8h_source.html#l00168">StdDefs.h:168</a></div></div>
<div class="ttc" id="aviewDualSurface_8cpp_html_a1a254aa17418553bc21790001a69262a"><div class="ttname"><a href="viewDualSurface_8cpp.html#a1a254aa17418553bc21790001a69262a">dim</a></div><div class="ttdeci">unsigned int dim(const Vector &amp;z)</div><div class="ttdef"><b>Definition:</b> <a href="viewDualSurface_8cpp_source.html#l00174">viewDualSurface.cpp:174</a></div></div>
<div class="ttc" id="anamespaceDGtal_1_1Z2i_html_a858b8746eb7dc0280c8e12b37e56d9e3"><div class="ttname"><a href="namespaceDGtal_1_1Z2i.html#a858b8746eb7dc0280c8e12b37e56d9e3">DGtal::Z2i::RealPoint</a></div><div class="ttdeci">Space::RealPoint RealPoint</div><div class="ttdef"><b>Definition:</b> <a href="StdDefs_8h_source.html#l00097">StdDefs.h:97</a></div></div>
<div class="ttc" id="anamespaceDGtal_html_ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7"><div class="ttname"><a href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">DGtal::PRIMAL</a></div><div class="ttdeci">@ PRIMAL</div><div class="ttdef"><b>Definition:</b> <a href="Duality_8h_source.html#l00061">Duality.h:61</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Trace_html_ad054990834d2763627166540087a2980"><div class="ttname"><a href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">DGtal::Trace::info</a></div><div class="ttdeci">std::ostream &amp; info()</div></div>
<div class="ttc" id="anamespaceDGtal_1_1Z3i_html_a5f087066515ecd33cefd7bd080ef8114"><div class="ttname"><a href="namespaceDGtal_1_1Z3i.html#a5f087066515ecd33cefd7bd080ef8114">DGtal::Z3i::RealPoint</a></div><div class="ttdeci">Space::RealPoint RealPoint</div><div class="ttdef"><b>Definition:</b> <a href="StdDefs_8h_source.html#l00170">StdDefs.h:170</a></div></div>
<div class="ttc" id="anamespaceDGtal_1_1Z3i_html_a39a69f8da09f1094df563ca067927c61"><div class="ttname"><a href="namespaceDGtal_1_1Z3i.html#a39a69f8da09f1094df563ca067927c61">DGtal::Z3i::Domain</a></div><div class="ttdeci">HyperRectDomain&lt; Space &gt; Domain</div><div class="ttdef"><b>Definition:</b> <a href="StdDefs_8h_source.html#l00172">StdDefs.h:172</a></div></div>
<div class="ttc" id="atestProjection_8cpp_html_a1f1a69f8d8b037b72c2160ed12b3ef51"><div class="ttname"><a href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a></div><div class="ttdeci">Domain domain</div><div class="ttdef"><b>Definition:</b> <a href="testProjection_8cpp_source.html#l00088">testProjection.cpp:88</a></div></div>
<div class="ttc" id="anamespaceDGtal_html_ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41"><div class="ttname"><a href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745dac649578cee4b5463ded5048fdaa47a41">DGtal::DUAL</a></div><div class="ttdeci">@ DUAL</div><div class="ttdef"><b>Definition:</b> <a href="Duality_8h_source.html#l00063">Duality.h:62</a></div></div>
<div class="ttc" id="atestCubicalComplex_8cpp_html_a9b10591d95c90247f1c7b3bd52853782"><div class="ttname"><a href="testCubicalComplex_8cpp.html#a9b10591d95c90247f1c7b3bd52853782">Cell</a></div><div class="ttdeci">KSpace::Cell Cell</div><div class="ttdef"><b>Definition:</b> <a href="testCubicalComplex_8cpp_source.html#l00056">testCubicalComplex.cpp:56</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 6 2020 14:16:56 for DGtal by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
