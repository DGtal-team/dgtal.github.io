<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DGtal: Applications of full digital convexity</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-blue.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DGtal<span id="projectnumber">&#160;1.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Applications of full digital convexity </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#dgtal_dconvexityapp_sec1">Local convexity analysis</a></li>
<li class="level1"><a href="#dgtal_dconvexityapp_sec2">Tangency and shortest paths</a><ul><li class="level2"><a href="#dgtal_dconvexityapp_sec21">Definition of tangency and shortest paths</a></li>
<li class="level2"><a href="#dgtal_dconvexityapp_sec22">Implementation with TangencyComputer class</a></li>
<li class="level2"><a href="#dgtal_dconvexityapp_sec23">Shortest paths to a source</a></li>
<li class="level2"><a href="#dgtal_dconvexityapp_sec24">Shortest path between a source and a target</a></li>
<li class="level2"><a href="#dgtal_dconvexityapp_sec25">Approximated shortest paths to speed-up computation</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><dl class="section user"><dt>Author(s) of this documentation: </dt><dd>Jacques-Olivier Lachaud</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3</dd></dl>
<p>Part of the <a class="el" href="packageGeometry.html">Geometry package</a>.</p>
<p >This part of the manual describes some applications of a new definition of digital convexity, called full convexity <a class="el" href="citelist.html#CITEREF_lachaud_dgmm_2021">[75]</a> <a class="el" href="citelist.html#CITEREF_lachaud_jmiv_2022">[76]</a> .</p>
<p >See <a class="el" href="moduleDigitalConvexity.html">Digital convexity and full digital convexity</a> for further details on full convexity.</p>
<p >See <a class="el" href="moduleEnvelope.html">Fully convex envelope, relative fully convex envelope and digital polyhedra</a> to see how to build fully convex hulls and digital polyhedra.</p>
<p >The following programs are related to this documentation: <a class="el" href="fullConvexityAnalysis3D_8cpp.html">geometry/volumes/fullConvexityAnalysis3D.cpp</a> , <a class="el" href="fullConvexityThinning3D_8cpp.html">geometry/volumes/fullConvexityThinning3D.cpp</a> , <a class="el" href="fullConvexityLUT2D_8cpp.html">geometry/volumes/fullConvexityLUT2D.cpp</a> , <a class="el" href="fullConvexityCollapsiblePoints2D_8cpp.html">geometry/volumes/fullConvexityCollapsiblePoints2D.cpp</a> , <a class="el" href="fullConvexityShortestPaths3D_8cpp.html">geometry/volumes/fullConvexityShortestPaths3D.cpp</a> , <a class="el" href="fullConvexitySphereGeodesics_8cpp.html">geometry/volumes/fullConvexitySphereGeodesics.cpp</a> .</p>
<h1><a class="anchor" id="dgtal_dconvexityapp_sec1"></a>
Local convexity analysis</h1>
<p >Full convexity is stable by intersection with an half-space with axis-aligned normal vector and integer intercept. Hence if \( X \) is fully convex, and \( N_k(x) \) is a \( (2k+1)^d \) neighborhood around point <em>x</em>, then \( X \cap N_k(x) \) is also fully convex.</p>
<p >This shows that a fully convex set is locally fully convex everywhere. Reciprocally local analysis with full convexity gives information on the local geometry:</p><ul>
<li>\( X \) is <em>k-<em>convex</em> at</em> <em>x</em>, whenever \( X \cap N_k(x) \) is fully convex;</li>
<li>\( X \) is <em>k-<em>concave</em> at</em> <em>x</em>, whenever \( (\mathbb{Z}^d \setminus X) \cap N_k(x) \) is fully convex;</li>
<li>\( X \) is <em>k-<em>planar</em> at</em> <em>x</em>, whenever it is both <em>k-<em>convex</em> and</em> <em>k-<em>concave</em> at</em> <em>x</em>;</li>
<li>otherwise \( X \) is <em>k-<em>atypical</em> at</em> <em>x</em>.</li>
</ul>
<p >Due to the stability properties of full convexity, one may observe that \( k+1 \)-convexity at <em>x</em> implies \( k \)-convexity at <em>x</em>, the same holds for concavity and planarity. Taking the contraposition indicates that \( k \)-atypicality implies \( k+1
\)-atypicality.</p>
<p >Class <a class="el" href="classDGtal_1_1NeighborhoodConvexityAnalyzer.html" title="Aim: A class that models a  neighborhood and that provides services to analyse the convexity properti...">NeighborhoodConvexityAnalyzer</a> offers many services to check these properties in an efficient way. It stores look-up tables to perform these services efficiently in 2D for 3x3 neighborhood, and also uses memoization to speed-up computations (useful in dimension greater than 2 and/or when the neighborhood is larger).</p>
<p >The following snippet shows how you can use it. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;DGtal/geometry/volumes/NeighborhoodConvexityAnalyzer.h&quot;</span></div>
<div class="line">...</div>
<div class="line">using <span class="keyword">namespace </span>Z3i;</div>
<div class="line"><span class="keyword">auto</span> params = <a class="code hl_function" href="classDGtal_1_1Shortcuts.html#ac893d3bc87b6dee19a48044627c42df9">SH3::defaultParameters</a>();</div>
<div class="line"><span class="keyword">auto</span> bimage = <a class="code hl_function" href="classDGtal_1_1Shortcuts.html#af8ce3bb03c1ddbb306b77207afc091d0">SH3::makeBinaryImage</a>( <span class="stringliteral">&quot;Al.100.vol&quot;</span>, params );</div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a>      = <a class="code hl_function" href="classDGtal_1_1Shortcuts.html#a25d0be45d2b76a79be6cc83c8e2442b2">SH3::getKSpace</a>( bimage );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set up a memoizer of up to 50000 configurations.</span></div>
<div class="line">NeighborhoodConvexityAnalyzer&lt; KSpace, 1 &gt; <a class="code hl_typedef" href="fullConvexityThinning3D_8cpp.html#ae3da7f498b2ab1db86d633cb277cb6bd">NCA</a>( <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a>, 50000 );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute all immediate interior points (inner boundary).</span></div>
<div class="line"><span class="keyword">auto</span> surface = <a class="code hl_function" href="classDGtal_1_1Shortcuts.html#a93309902099a369efffe30a7e849673e">SH3::makeDigitalSurface</a>( bimage, <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a>, params );</div>
<div class="line">std::vector&lt; Point &gt; points;</div>
<div class="line"><span class="keywordflow">for</span> ( <span class="keyword">auto</span> s : (*surface) )</div>
<div class="line">  {</div>
<div class="line">    <a class="code hl_typedef" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> k = <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a>.sOrthDir( s );</div>
<div class="line">    <span class="keyword">auto</span> voxel  = <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a>.sIncident( s, k, <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a>.sDirect( s, k ) );</div>
<div class="line">    <a class="code hl_typedef" href="testClone2_8cpp.html#a15e9592ccc512dc691b46185e6814758">Point</a> p     = <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a>.sCoords( voxel );</div>
<div class="line">    points.push_back( p );</div>
<div class="line">  }</div>
<div class="line"><span class="comment">// Analyse inner boundary points</span></div>
<div class="line"><span class="keywordflow">for</span> ( <span class="keyword">auto</span> x : points )</div>
<div class="line">  {</div>
<div class="line">    nca.setCenter( x, *bimage );                         <span class="comment">// center neighborhood on point x</span></div>
<div class="line">    <span class="keywordtype">bool</span>  cvx = nca.isFullyConvex( <span class="keyword">true</span> );               <span class="comment">// check 1-convexity</span></div>
<div class="line">    <span class="keywordtype">bool</span> ccvx = nca.isComplementaryFullyConvex( <span class="keyword">false</span> ); <span class="comment">// check 1-concavity</span></div>
<div class="line">    ...</div>
<div class="line">  }</div>
<div class="ttc" id="aclassDGtal_1_1Shortcuts_html_a25d0be45d2b76a79be6cc83c8e2442b2"><div class="ttname"><a href="classDGtal_1_1Shortcuts.html#a25d0be45d2b76a79be6cc83c8e2442b2">DGtal::Shortcuts::getKSpace</a></div><div class="ttdeci">static KSpace getKSpace(const Point &amp;low, const Point &amp;up, Parameters params=parametersKSpace())</div><div class="ttdef"><b>Definition:</b> <a href="Shortcuts_8h_source.html#l00332">Shortcuts.h:332</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Shortcuts_html_a93309902099a369efffe30a7e849673e"><div class="ttname"><a href="classDGtal_1_1Shortcuts.html#a93309902099a369efffe30a7e849673e">DGtal::Shortcuts::makeDigitalSurface</a></div><div class="ttdeci">static CountedPtr&lt; DigitalSurface &gt; makeDigitalSurface(CountedPtr&lt; TPointPredicate &gt; bimage, const KSpace &amp;K, const Parameters &amp;params=parametersDigitalSurface())</div><div class="ttdef"><b>Definition:</b> <a href="Shortcuts_8h_source.html#l01208">Shortcuts.h:1209</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Shortcuts_html_ac893d3bc87b6dee19a48044627c42df9"><div class="ttname"><a href="classDGtal_1_1Shortcuts.html#ac893d3bc87b6dee19a48044627c42df9">DGtal::Shortcuts::defaultParameters</a></div><div class="ttdeci">static Parameters defaultParameters()</div><div class="ttdef"><b>Definition:</b> <a href="Shortcuts_8h_source.html#l00203">Shortcuts.h:203</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Shortcuts_html_af8ce3bb03c1ddbb306b77207afc091d0"><div class="ttname"><a href="classDGtal_1_1Shortcuts.html#af8ce3bb03c1ddbb306b77207afc091d0">DGtal::Shortcuts::makeBinaryImage</a></div><div class="ttdeci">static CountedPtr&lt; BinaryImage &gt; makeBinaryImage(Domain shapeDomain)</div><div class="ttdef"><b>Definition:</b> <a href="Shortcuts_8h_source.html#l00561">Shortcuts.h:561</a></div></div>
<div class="ttc" id="afullConvexityThinning3D_8cpp_html_ae3da7f498b2ab1db86d633cb277cb6bd"><div class="ttname"><a href="fullConvexityThinning3D_8cpp.html#ae3da7f498b2ab1db86d633cb277cb6bd">NCA</a></div><div class="ttdeci">NeighborhoodConvexityAnalyzer&lt; KSpace, 1 &gt; NCA</div><div class="ttdef"><b>Definition:</b> <a href="fullConvexityThinning3D_8cpp_source.html#l00060">fullConvexityThinning3D.cpp:60</a></div></div>
<div class="ttc" id="anamespaceDGtal_html_a8fbe8c8d47ca5c36ced14284ac62613d"><div class="ttname"><a href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">DGtal::Dimension</a></div><div class="ttdeci">DGtal::uint32_t Dimension</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00137">Common.h:137</a></div></div>
<div class="ttc" id="atestClone2_8cpp_html_a15e9592ccc512dc691b46185e6814758"><div class="ttname"><a href="testClone2_8cpp.html#a15e9592ccc512dc691b46185e6814758">Point</a></div><div class="ttdeci">MyPointD Point</div><div class="ttdef"><b>Definition:</b> <a href="testClone2_8cpp_source.html#l00383">testClone2.cpp:383</a></div></div>
<div class="ttc" id="atestCubicalComplex_8cpp_html_a2b87ed989d2519d025bd5d4fbcbac062"><div class="ttname"><a href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a></div><div class="ttdeci">KSpace K</div><div class="ttdef"><b>Definition:</b> <a href="testCubicalComplex_8cpp_source.html#l00062">testCubicalComplex.cpp:62</a></div></div>
</div><!-- fragment --><p >You may have a look at geometricAnalysis3D.cpp to have a more complete example.</p>
<table class="doxtable">
<tr>
<td><div class="image">
<img src="cps-analysis-1.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity analysis at scale 1</div></div>
 </td><td><div class="image">
<img src="cps-analysis-2.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity analysis at scale 2</div></div>
 </td><td><div class="image">
<img src="cps-analysis-3.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity analysis at scale 3</div></div>
 </td><td><div class="image">
<img src="cps-analysis-4.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity analysis at scale 4</div></div>
  </td></tr>
</table>
<table class="doxtable">
<tr>
<td><div class="image">
<img src="cps-analysis-1-5.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity multiscale analysis (scales 1-5)</div></div>
 </td><td><div class="image">
<img src="cps-smooth-analysis-1-5.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity smooth multiscale analysis (scales 1-5)</div></div>
  </td></tr>
</table>
<table class="doxtable">
<tr>
<td><div class="image">
<img src="ssphere-257-smooth-analysis-1-5.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity smooth multiscale analysis (scales 1-5)</div></div>
 </td><td><div class="image">
<img src="rc250-smooth-analysis-1-5.jpg" alt="" width="90%"/>
<div class="caption">
Full convexity smooth multiscale analysis (scales 1-5)</div></div>
  </td></tr>
</table>
<h1><a class="anchor" id="dgtal_dconvexityapp_sec2"></a>
Tangency and shortest paths</h1>
<h2><a class="anchor" id="dgtal_dconvexityapp_sec21"></a>
Definition of tangency and shortest paths</h2>
<p >Tangency or subconvexity is a derived concept from full convexity. Let \( X \subset \mathbb{Z}^d \) some arbitrary digital set. Then the digital set \(
A \subset \mathbb{Z}^d \) is said to be <b>digitally</b> <em>k-</em> <b>subconvex</b> to \( X \) whenever \( C^d_k \lbrack \mathrm{Conv}(A)
\rbrack \subset C^d_k \lbrack X \rbrack \). And \( A \) is said to be <b>fully</b> (digitally) <b>subconvex</b> to \( X \) whenever it is digitally <em>k-</em> subconvex to \( X \) for \( 0 \le k \le d \).</p>
<p >We also say that \( A \) is <b>tangent</b> to \( X \). The elements of \( A \) are said to be <b>cotangent</b> (in \( X \)). Note that necessarily \( A \subset X \).</p>
<p >A <em>path</em> \( \gamma \) from <em>a</em> to <em>b</em> in \( X \) is then a sequence a points \( \gamma=(x_i)_{i=0,\ldots,n} \), such that \(
x_0 = a \), \( x_n = b \), and for all \( i \in \{ 0, \ldots, n-1
\} \), it holds that \( \{ x_i, x_{i+1} \} \) is tangent to \( X \).</p>
<p >We can embed in the Euclidean space the path \( \gamma \) simply by joining its consecutive points by Euclidean straight line segments. Its <em>length</em> is then just the Euclidean length of its embedding.</p>
<p >The cotangency relations define a graph on \( X \), which can be weighted by the length of the Euclidean segments joining cotangent points. Shortest paths on this graph are of course <em>path</em> in the above mentioned sense.</p>
<h2><a class="anchor" id="dgtal_dconvexityapp_sec22"></a>
Implementation with TangencyComputer class</h2>
<p >The class <a class="el" href="classDGtal_1_1TangencyComputer.html" title="Aim: A class that computes tangency to a given digital set. It provides services to compute all the c...">TangencyComputer</a> offers some services to check tangency and to compute shortest paths:</p><ul>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#af6ad18619d6afa3c9658e9a838b0fb72" title="Constructor. The object is invalid.">TangencyComputer::TangencyComputer</a> requires a cellular grid space big enough to include the future digital object</li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#af97169a4f1405e52b6a9a05bae52df61">TangencyComputer::init</a> defines the points of the digital object</li>
<li>several accessors are provided to get the space, the points (which are indexed in the same order as initialization), their indices and the cell cover</li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#a7970da2ba7fface1ebb9f79f1c88197a">TangencyComputer::arePointsCotangent</a> checks if two points are cotangent</li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#a7871c19d08946af2da89def64ab47c32">TangencyComputer::getCotangentPoints</a> returns all the indices of the cotangent points to a given point</li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#ab42bc3ff3abb9ef7b40f7e2612cc715a">TangencyComputer::shortestPath</a> builds the shortest path between a source and a destination</li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#aba363aee4e7bde8101f5bbcfa9a36a37">TangencyComputer::shortestPaths</a> builds all shortest paths to a given source, or builds shortest paths between sources and a set of possible destinations</li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#aafcf00946113a4d6101ae0b5cc6a783b">TangencyComputer::makeShortestPaths</a> returns a ShortestPaths object, which allows you to compute shortest paths efficiently</li>
</ul>
<p >To use it, you should include the following headers</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;DGtal/geometry/volumes/TangencyComputer.h&quot;</span></div>
</div><!-- fragment --><h2><a class="anchor" id="dgtal_dconvexityapp_sec23"></a>
Shortest paths to a source</h2>
<p >We use here a <a class="el" href="structDGtal_1_1TangencyComputer_1_1ShortestPaths.html">TangencyComputer::ShortestPaths</a> object to compute and store all shortest paths to a given target point.</p>
<div class="fragment"><div class="line">  TangencyComputer&lt; KSpace &gt; TC( <a class="code hl_variable" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a> );</div>
<div class="line">  TC.init( points.cbegin(), points.cend() );</div>
<div class="line">  <span class="keyword">auto</span> SP = TC.makeShortestPaths( opt );</div>
<div class="line">  SP.init( start0 ); <span class="comment">//&lt; set source</span></div>
<div class="line">  <span class="keywordtype">double</span> last_distance = 0.0;</div>
<div class="line">  <span class="keywordflow">while</span> ( ! SP.finished() )</div>
<div class="line">    {</div>
<div class="line">      last_distance = std::get&lt;2&gt;( SP.current() );</div>
<div class="line">      SP.expand();</div>
<div class="line">    }</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Max distance is &quot;</span> &lt;&lt; last_distance &lt;&lt; std::endl;</div>
</div><!-- fragment --><p >The object stores for each point:</p><ul>
<li>its ancestor in the breadth first traversal (following the sequence of ancestors gives you the shortest path to the target(s))</li>
<li>its distance to the (closest) target.</li>
</ul>
<p >Example <a class="el" href="fullConvexityShortestPaths3D_8cpp.html">fullConvexityShortestPaths3D.cpp</a> illustrates that kind of computations, giving the distance of each object point to the specified target.</p>
<table class="doxtable">
<tr>
<td><div class="image">
<img src="cps-geodesics-1.jpg" alt="" width="500"/>
<div class="caption">
Geodesic distances and geodesics on cube+sphere shape</div></div>
 </td><td><div class="image">
<img src="cps-geodesics-2.jpg" alt="" width="500"/>
<div class="caption">
Geodesic distances on cube+sphere shape</div></div>
  </td></tr>
</table>
<p >You may obtain nicer views by exporting your result to an OBJ format and then render it.</p>
<table class="doxtable">
<tr>
<td><div class="image">
<img src="dragon256-geodesics-1.jpg" alt="" width="500"/>
<div class="caption">
Geodesic distances on dragon digital surface</div></div>
 </td><td><div class="image">
<img src="butterfly-geodesics-1.jpg" alt="" width="500"/>
<div class="caption">
Geodesic distances on butterfly digital surface</div></div>
  </td></tr>
</table>
<h2><a class="anchor" id="dgtal_dconvexityapp_sec24"></a>
Shortest path between a source and a target</h2>
<p >If you wish to compute only one path, generally it is faster to use breadth first traversal from both the source and the target and stop at first collision. This is already implemented in <a class="el" href="classDGtal_1_1TangencyComputer.html#ab42bc3ff3abb9ef7b40f7e2612cc715a">TangencyComputer::shortestPath</a>, using two <a class="el" href="structDGtal_1_1TangencyComputer_1_1ShortestPaths.html">TangencyComputer::ShortestPaths</a> objects. The snippet below shows you how it is computed internally:</p>
<div class="fragment"><div class="line">  <span class="keyword">auto</span> SP0 = TC.makeShortestPaths( opt );</div>
<div class="line">  <span class="keyword">auto</span> SP1 = TC.makeShortestPaths( opt );</div>
<div class="line">  SP0.init( start0 );     <span class="comment">//&lt; source point</span></div>
<div class="line">  SP1.init( start1 );     <span class="comment">//&lt; target point</span></div>
<div class="line">  std::vector&lt; Index &gt; Q; <span class="comment">//&lt; the output shortest path</span></div>
<div class="line">  <span class="keywordflow">while</span> ( ! SP0.finished() &amp;&amp; ! SP1.finished() )</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">auto</span> n0 = SP0.current();</div>
<div class="line">      <span class="keyword">auto</span> n1 = SP1.current();</div>
<div class="line">      <span class="keyword">auto</span> p0 = std::get&lt;0&gt;( n0 );</div>
<div class="line">      <span class="keyword">auto</span> p1 = std::get&lt;0&gt;( n1 );</div>
<div class="line">      SP0.expand();</div>
<div class="line">      SP1.expand();</div>
<div class="line">      <span class="keywordflow">if</span> ( SP0.isVisited( p1 ) )</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">auto</span> c0 = SP0.pathToSource( p1 );</div>
<div class="line">          <span class="keyword">auto</span> c1 = SP1.pathToSource( p1 );</div>
<div class="line">          std::copy(c0.rbegin(), c0.rend(), std::back_inserter(Q));</div>
<div class="line">          Q.pop_back();</div>
<div class="line">          std::copy(c1.begin(), c1.end(), std::back_inserter(Q)); </div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  <span class="comment">// Q is empty if there is no path.</span></div>
</div><!-- fragment --><div class="image">
<img src="cps-shortest-path.jpg" alt="" width="500"/>
<div class="caption">
Shortest path between two points</div></div>
<h2><a class="anchor" id="dgtal_dconvexityapp_sec25"></a>
Approximated shortest paths to speed-up computation</h2>
<p >Classes <a class="el" href="classDGtal_1_1TangencyComputer.html" title="Aim: A class that computes tangency to a given digital set. It provides services to compute all the c...">TangencyComputer</a> and <a class="el" href="structDGtal_1_1TangencyComputer_1_1ShortestPaths.html">TangencyComputer::ShortestPaths</a> offer a way to considerably speed up shortest paths computation if one tolerates a little bit of approximation. Several methods accept a distance parameter <em>K</em>. If <em>K</em> is greater than \( \sqrt{d} \), then shortest paths are exact (meaning all extracted paths are the shortest possible in the sense of the above mentioned algorithm), but if you give a lower value (from \( \sqrt{d}
\) to 0 included), you obtain path that may be only shortest path approximations. The table below shows you the trade-off between the speed-up and the approximation error. As one can see, speed-up of \(
50-500 \times \) are obtained, while approximations error are very low or sometimes null.</p>
<p >The following methods accept this parameter:</p><ul>
<li><a class="el" href="structDGtal_1_1TangencyComputer_1_1ShortestPaths.html#aaf6a674e2530d5646191e6a2d2fe6268" title="Default constructor. The object is not valid.">TangencyComputer::ShortestPaths::ShortestPaths</a></li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#aafcf00946113a4d6101ae0b5cc6a783b">TangencyComputer::makeShortestPaths</a></li>
<li><a class="el" href="classDGtal_1_1TangencyComputer.html#aba363aee4e7bde8101f5bbcfa9a36a37">TangencyComputer::shortestPaths</a></li>
</ul>
<p >Running the example <a class="el" href="fullConvexitySphereGeodesics_8cpp.html">geometry/volumes/fullConvexitySphereGeodesics.cpp</a> shows the speed-up for different choices of <em>K</em> parameter, as well as the induced approximate distance. In the table below, not surprisingly, the maximum observed distance may be greater in case of approximation. We also indicate if the furthest point to the source point is correct or no.</p>
<p ><b>Table</b> <b>below:</b> Computation times of shortest paths to a given source and maximal error onto a 3D sphere digitized with gridstep \( h \). The chosen \( K \) indicates the chosen distance parameter. Choosing \( K=\|p-q\| \) or \( K=\sqrt{3} \) guarantees the correctness of the output. However, decreasing \( K \) to \( 0 \) speeds up the algorithm, while the maximal relative error in the distance estimation stays very low. Each cell of the last four columns displays the computation time (in seconds), and between parenthesis: OK if the furthest point is the exact antipodal point to the source point on the sphere, and the relative error of the measured shortest path in percentage.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">gridstep <em>h</em>   </th><th class="markdownTableHeadNone">\( \#(X) \)   </th><th class="markdownTableHeadNone">Max distance   </th><th class="markdownTableHeadNone">\( K=\sqrt{3} \)   </th><th class="markdownTableHeadNone">\( K=\sqrt{3}/4 \)   </th><th class="markdownTableHeadNone">\( K=\sqrt{3}/16 \)   </th><th class="markdownTableHeadNone">\( K = 0 \)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.25   </td><td class="markdownTableBodyNone">296   </td><td class="markdownTableBodyNone">2.88739   </td><td class="markdownTableBodyNone">0.187 (OK)   </td><td class="markdownTableBodyNone">0.068 (OK,0.000%)   </td><td class="markdownTableBodyNone">0.024 (OK,0.000%)   </td><td class="markdownTableBodyNone">0.013 (OK,0.000%)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.125   </td><td class="markdownTableBodyNone">1184   </td><td class="markdownTableBodyNone">2.97166   </td><td class="markdownTableBodyNone">1.480 (OK)   </td><td class="markdownTableBodyNone">0.470 (OK,0.000%)   </td><td class="markdownTableBodyNone">0.177 (OK,0.000%)   </td><td class="markdownTableBodyNone">0.082 (OK,0.226%)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.0625   </td><td class="markdownTableBodyNone">4784   </td><td class="markdownTableBodyNone">3.02389   </td><td class="markdownTableBodyNone">11.744 (OK)   </td><td class="markdownTableBodyNone">4.106 (OK,0.000%)   </td><td class="markdownTableBodyNone">1.037 (OK,0.000%)   </td><td class="markdownTableBodyNone">0.340 (OK,0.538%)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0.03125   </td><td class="markdownTableBodyNone">19256   </td><td class="markdownTableBodyNone">3.08405   </td><td class="markdownTableBodyNone">97.161 (OK)   </td><td class="markdownTableBodyNone">39.993 (OK,0.000%)   </td><td class="markdownTableBodyNone">9.122 (OK,0.005%)   </td><td class="markdownTableBodyNone">2.006 (OK,0.233%)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0.015625   </td><td class="markdownTableBodyNone">77120   </td><td class="markdownTableBodyNone">3.10879   </td><td class="markdownTableBodyNone">1828.890 (OK)   </td><td class="markdownTableBodyNone">385.114 (OK,0.000%)   </td><td class="markdownTableBodyNone">78.363 (OK,0.038%)   </td><td class="markdownTableBodyNone">9.446 (OK,0.289%)   </td></tr>
</table>
<table class="doxtable">
<tr>
<td><div class="image">
<img src="sphere1-h0_0625-geodesics.jpg" alt="" width="90%"/>
<div class="caption">
Exact geodesic distances on unit sphere digitized at h=0.0625 (max d=3.02389)</div></div>
 </td><td><div class="image">
<img src="sphere1-h0_01-geodesics.jpg" alt="" width="90%"/>
<div class="caption">
Approximate geodesic distances on unit sphere digitized at h=0.01 (max d=3.1269)</div></div>
  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Nov 27 2022 15:16:00 for DGtal by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
