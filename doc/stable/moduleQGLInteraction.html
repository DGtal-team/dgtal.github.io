<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DGtal: Limited interaction when using selection with QGLViewer Viewer3D stream mechanism</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-blue.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Limited interaction when using selection with QGLViewer <a class="el" href="classDGtal_1_1Viewer3D.html">Viewer3D</a> stream mechanism </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This part of the manual describes how to select objects in 3D scenes when using a <a class="el" href="classDGtal_1_1Viewer3D.html">Viewer3D</a> object. The principle is to handle one or several reactions or callback functions to the viewer. They are then called when the user selects an object in a 3d scene displayed in the viewer. Selection with QGLViewer is usually done with a shift + left click on the object of interest. The "name" of the clicked object is then given as parameter to the reaction/callback function, so that further processing taking into account the selected object is made possible. By default the selected elements are highlighted (in dark or light color depending of the original color element).</p>
<p>Actually the elements which can be selected interactively are the following:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Element type  </th><th class="markdownTableHeadCenter">list type  </th><th class="markdownTableHeadCenter">can be selected   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Surfel (Quad3D)  </td><td class="markdownTableBodyCenter">std::map  </td><td class="markdownTableBodyCenter">YES   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Voxel (Cube3D)  </td><td class="markdownTableBodyCenter">std::map  </td><td class="markdownTableBodyCenter">YES   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Line (LineD3D)  </td><td class="markdownTableBodyCenter">std::vector  </td><td class="markdownTableBodyCenter">NO   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Point (BallD3D)  </td><td class="markdownTableBodyCenter">std::vector  </td><td class="markdownTableBodyCenter">NO   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Triangles (TriangleD3D)  </td><td class="markdownTableBodyCenter">std::vector  </td><td class="markdownTableBodyCenter">NO   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Polygon (PolygonD3D)  </td><td class="markdownTableBodyCenter">std::vector  </td><td class="markdownTableBodyCenter">NO   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Jacques-Olivier Lachaud </dd>
<dd>
Bertrand Kerautret</dd></dl>
<p>Related examples: <a class="el" href="viewer3D-10-interaction_8cpp_source.html">viewer3D-10-interaction.cpp</a></p>
<dl class="section note"><dt>Note</dt><dd>This functionality is not really useful for developing a full interactive 3D application. It is for now limited to surfel and voxel selection, with simple visual feedback. However, this functionality is rather easy to use, hence may be found useful when prototyping.</dd></dl>
<h1><a class="anchor" id="QGLInteraction_sec1"></a>
Giving names to graphical objects</h1>
<p>An OpenGL name is an integer that can be affected to a graphical object or list. Here, if you put in a viewer stream a <a class="el" href="structDGtal_1_1SetName3D.html">SetName3D</a> object, then objects outputed afterwards are given this name. Assuming that you have a vector of surfels (cells of dimension 2), and you want to assign a different name to each surfel, you may proceed as follows when displaying them.</p>
<div class="fragment"><div class="line">Viewer3D&lt;&gt; viewer( <a class="code" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a> ); <span class="comment">// K is some KhalimskySpaceND</span></div><div class="line">std::vector&lt;SCell&gt; v;   <span class="comment">// fill it with surfels</span></div><div class="line">...</div><div class="line">int name = 0;</div><div class="line"><span class="keywordflow">for</span> ( std::vector&lt;SCell&gt;::const_iterator it = v.begin(), itE = v.end(); it != itE; ++it )</div><div class="line">  viewer &lt;&lt; SetName3D( name++ ) &lt;&lt; *it;</div></div><!-- fragment --><p>Now, all surfels have a different name. Note that if you wish some objects to be unselectable, you may precise a negative (-1) name.</p>
<h1><a class="anchor" id="QGLInteraction_sec2"></a>
Assigning reactions or callback functions</h1>
<p>A reaction or callback function for a selection in a QGLViewer window has the following signature:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> reaction( <span class="keywordtype">void</span>* viewer, <a class="code" href="namespaceDGtal.html#ac1e9ac6a329319ae13c51c0c9e92486a">int32_t</a> name, <span class="keywordtype">void</span>* data );</div></div><!-- fragment --><p>You may assign one reaction for a given interval of names. You may thus group together some graphical objects by assigning different reactions to different groups. This is again done using the stream mechanism with an object <a class="el" href="structDGtal_1_1SetSelectCallback3D.html">SetSelectCallback3D</a>. You may also precise a pointer to some object with a lifetime at least as long as the calls to the reaction. This is a way of giving information to the reaction or callback function.</p>
<div class="fragment"><div class="line">viewer &lt;&lt; SetSelectCallback3D( reaction,  &amp;data, 0, v.size() - 1 );</div></div><!-- fragment --><p>Here, we have set the same reaction for all surfels (names between 0 and v.size()-1).</p>
<h1><a class="anchor" id="QGLInteraction_sec3"></a>
Writing a reaction or callback function</h1>
<p>As said above, a reaction or callback function to a QGLViewer selection event must have the following prototype:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> reaction( <span class="keywordtype">void</span>* viewer, <a class="code" href="namespaceDGtal.html#ac1e9ac6a329319ae13c51c0c9e92486a">int32_t</a> name, <span class="keywordtype">void</span>* data );</div></div><!-- fragment --><p>It receives as input a pointer <em>viewer</em> to the viewer object on which the selection was performed, the OpenGL <em>name</em> of the selected graphical object, and a pointer <em>data</em> to the data that was provided at creation of the reaction or callback function. Generally, in the object pointed by <em>data</em>, one stores a way to convert the name into some logical 3d object, like a surfel. If we go on with our example, we could proceed as follows:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> myReaction( <span class="keywordtype">void</span>* viewer, <a class="code" href="namespaceDGtal.html#ac1e9ac6a329319ae13c51c0c9e92486a">int32_t</a> name, <span class="keywordtype">void</span>* data )</div><div class="line">{</div><div class="line">  std::vector&lt;SCell&gt;* ptrV = (std::vector&lt;SCell&gt;*) data;</div><div class="line">  cout &lt;&lt; <span class="stringliteral">&quot;Surfel &quot;</span> &lt;&lt; (*ptrV)[ name ] &lt;&lt; <span class="stringliteral">&quot; selected.&quot;</span> &lt;&lt; endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line">...</div><div class="line">QApplication app( argc, argv );</div><div class="line">Viewer3D&lt;&gt; viewer( <a class="code" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a> ); <span class="comment">// K is some KhalimskySpaceND</span></div><div class="line">std::vector&lt;SCell&gt; v;   <span class="comment">// fill it with surfels</span></div><div class="line">...</div><div class="line">int name = 0;</div><div class="line"><span class="keywordflow">for</span> ( std::vector&lt;SCell&gt;::const_iterator it = v.begin(), itE = v.end(); it != itE; ++it )</div><div class="line">  viewer &lt;&lt; SetName3D( name++ ) &lt;&lt; *it;</div><div class="line">viewer &lt;&lt; SetSelectCallback3D( myReaction,  &amp;v, 0, v.size() - 1 );</div><div class="line">viewer &lt;&lt; Viewer3D&lt;&gt;::updateDisplay;</div><div class="line"><span class="keywordflow">return</span> app.exec();</div></div><!-- fragment --><p>You may have a look at <a class="el" href="viewer3D-10-interaction_8cpp_source.html">viewer3D-10-interaction.cpp</a> for another example. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Mar 27 2019 12:04:13 for DGtal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
